import{_ as z,a as F,b as j,c as W}from"./search-icon.822e7617.js";import{_ as M,d as N,u as H,a as I,r as T,c as J,b as _,o as r,e as w,w as d,f as a,g as C,h as E,F as D,i as s,j as V,n as R,k as P,t as K,l as Q,p as X,m as Y,q as Z,E as L,s as ee,R as te}from"./index.eb618201.js";import{u as B}from"./account.177b5655.js";import{u as ae}from"./breakpoints.b9be5c6e.js";import{s as oe,a as G,o as se}from"./firebaseConfig.d7a6b5a9.js";import{s as l}from"./util.c00e9ac8.js";import{u as ne}from"./plaque.33fd4c23.js";import{u as le}from"./token-meta.8d81db76.js";import{u as re}from"./gallery.34e634d7.js";import{a as ce}from"./add-plaque.1e1622fe.js";import"./types.d2ec9214.js";import"./plaque.28daac16.js";import"./token-meta.7f5c0ba8.js";import"./gallery.d53d87c7.js";const O=y=>(X("data-v-5c106a87"),y=y(),Y(),y),ie=O(()=>P("div",{style:{"flex-grow":"1"}},null,-1)),ue=O(()=>P("div",{style:{"flex-grow":"1"}},null,-1)),_e={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},de=N({__name:"Header",setup(y){const c=H(),h=I(),n=B(),i=T(!1),{md_and_up:k,screen_type:x}=ae(),p=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&c.push({name:e.paneName})},q=J(()=>{const e=n.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),A=()=>{i.value=!0,oe(G).then(()=>{}).catch(e=>{l(e)}).finally(()=>{i.value=!1})},S=e=>new URL({"../assets/base.css":z,"../assets/logo.png":F,"../assets/logo.svg":j,"../assets/search-icon.svg":W}[`../assets/${e}`],self.location).href;return(e,t)=>{const m=_("el-image"),u=_("el-button"),g=_("el-tab-pane"),v=_("el-tabs"),b=_("el-header");return r(),w(b,{class:"header",style:Q(a(x)=="xs"?"padding: 0px 8px;":"")},{default:d(()=>[a(k)?(r(),w(m,{key:0,src:S("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):C("",!0),a(c).currentRoute.value.name=="qr-scan"?(r(),E(D,{key:1},[ie,s(u,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=f=>a(c).push("plaque-list"))},{default:d(()=>[V(" Cancel ")]),_:1})],64)):(r(),E(D,{key:2},[s(v,{modelValue:a(h).name,"onUpdate:modelValue":t[1]||(t[1]=f=>a(h).name=f),onTabClick:p,class:R(a(k)?"":"small-tabs")},{default:d(()=>[s(g,{label:"Plaques",name:"plaque-list"}),s(g,{label:"Artwork",name:"artwork-tile-grid"}),s(g,{label:"Galleries",name:"gallery-list"}),s(g,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),ue,a(k)?(r(),E("div",_e,[P("div",null,K(a(q)),1),a(n).is_user_admin?(r(),w(u,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:d(()=>[V("Admin")]),_:1})):C("",!0)])):C("",!0),s(u,{onClick:A,style:{"margin-left":"1em"},loading:i.value},{default:d(()=>[V("Logout")]),_:1},8,["loading"])],64))]),_:1},8,["style"])}}});var pe=M(de,[["__scopeId","data-v-5c106a87"]]);const me=N({__name:"HomeView",setup(y){const c=B(),h=ne(),n=le(),i=re(),k=H(),x=T(!1),p=T(),q=I();let A;Z(async()=>{p.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),A=se(G,async e=>{if(console.log("onAuthStateChanged",e),e){p.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{await S(e.uid)}finally{p.value.close()}}e||(c.setAccount(null),p.value.close(),k.push({name:"login",query:{redir:window.location.href}}))})}),ee(()=>{console.log("unsubscribe onAuthStateChanged on unmount"),A()});async function S(e){console.log("LOAD APP DATA"),await c.loadAccount(e),await i.loadGalleryList(e).catch(o=>l(`Error loading galleries - ${o}`));const t=h.loadPlaques(e).catch(o=>l(`Error loading plaques - ${o}`)),m=h.loadGalleryPlaques(i.gallery_list).catch(o=>l(`Error loading gallery plaques - ${o}`)),u=n.loadArchiveTokenMetas(e).catch(o=>l(`Error loading archive token metas - ${o}`)),g=n.loadGalleryTokenMetas(i.gallery_list).catch(o=>l(`Error loading token metas - ${o}`)),v=[t,m,u,m,g],b=c.get_account.entity.wallet_address;if(b){const o=n.loadOpenseaMintedTokenMetas(b).catch($=>l(`Error loading opensea minted tokens - ${$}`)),U=n.loadOpenseaWalletTokenMetas(b).catch($=>l(`Error loading opensea wallet tokens - ${$}`));v.push(o),v.push(U)}await Promise.all(v),await n.loadOpenseaConvertedTokens();const f=q.query.plaque_id;f&&typeof f=="string"&&await ce(e,f),x.value=!0}return(e,t)=>{const m=_("el-main"),u=_("el-container");return r(),w(u,{style:{height:"100%",position:"fixed",top:"0px",left:"0px",right:"0px",bottom:"0px"}},{default:d(()=>[s(pe),s(m,{style:{"background-color":"#DAD9D7"},class:R(a(q).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:d(()=>[x.value?(r(),w(a(te),{key:0})):C("",!0)]),_:1},8,["class"])]),_:1})}}});var Ee=M(me,[["__scopeId","data-v-5d3c4370"]]);export{Ee as default};
