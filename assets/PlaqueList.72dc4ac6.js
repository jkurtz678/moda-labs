import{_ as z,d as L,r as g,c as T,v as le,b as u,o as p,e as q,i as e,w as o,k as l,t as b,j as r,f,x as ne,y as J,z as F,u as Q,g as V,A as R,B as se,C as ie,h as I,D as de,G as _e,F as D,H as K,I as U,q as E}from"./index.36adc59a.js";import{u as B,c as re}from"./plaque.c9ac5c7e.js";import{c as ue}from"./token-meta.ba91ce12.js";import{u as W}from"./plaque.d308c5af.js";import{u as X}from"./account.67ba5898.js";import{s as Y}from"./util.667b6d5f.js";import{T as G}from"./types.ab61d3d9.js";import{u as Z}from"./breakpoints.e428c969.js";import{u as ee}from"./token-meta.2d91fef4.js";import{_ as ce}from"./TokenSelectList.84f0002e.js";import{_ as pe}from"./PlaqueTokenItem.d7b3dc2d.js";import{n as H}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.298aee35.js";import"./thumbnail-image.540c8d3c.js";const me=i=>(J("data-v-cc2989e6"),i=i(),F(),i),fe={class:"dialog-container"},ve={class:"dialog-footer"},ye=me(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),ge=L({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(i,{emit:d}){const $=i,s=g([]),c=g(!1),{screen_type:k}=Z(),w=W(),S=ee(),N=X(),v=T({get(){return $.show_add_token_dialog},set(n){d("update:show_add_token_dialog",n)}});le(v,n=>{n&&(s.value=JSON.parse(JSON.stringify(y.value.entity.token_meta_id_list)))});const y=T(()=>w.plaque_map[$.plaque_id]),m=T(()=>S.sorted_all_token_metas),A=async()=>{c.value=!0;try{for(let[n,t]of s.value.entries()){const a=S.all_token_metas[t];if(!a)throw"Failed to find store token for token: "+t;if(a.entity.platform!=G.Opensea)continue;const P=JSON.parse(JSON.stringify(a));P.entity.user_id=N.get_account.id,P.entity.platform=G.OpenseaArchive;const x=await ue(P.entity);s.value[n]=x.id}await B($.plaque_id,{token_meta_id_list:s.value}),w.plaque_map[$.plaque_id].entity.token_meta_id_list=s.value}catch(n){Y(`Error updating plaque tokens - ${n}`)}c.value=!1,v.value=!1},h=()=>{s.value=[]};return(n,t)=>{const a=u("el-button"),P=u("el-dialog");return p(),q("div",fe,[e(P,{center:"",modelValue:f(v),"onUpdate:modelValue":t[1]||(t[1]=x=>ne(v)?v.value=x:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:f(k)=="xs",top:"2vh"},{footer:o(()=>[l("div",ve,[l("div",null,b(`Artwork in playlist: ${s.value.length}`),1),ye,e(a,{onClick:h},{default:o(()=>[r("Clear")]),_:1}),e(a,{type:"info",onClick:A,loading:c.value},{default:o(()=>[r("Save")]),_:1},8,["loading"])])]),default:o(()=>[e(ce,{selected_token_meta_id_list:s.value,"onUpdate:selected_token_meta_id_list":t[0]||(t[0]=x=>s.value=x),token_meta_list:f(m)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var ke=z(ge,[["__scopeId","data-v-cc2989e6"]]);const C=i=>(J("data-v-1c15685a"),i=i(),F(),i),we={style:{display:"flex","align-items":"center",padding:"1em"}},qe={key:0},he=C(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),xe={class:"card-simple"},Ce=C(()=>l("hr",null,null,-1)),$e=C(()=>l("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Ae=C(()=>l("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Pe={style:{padding:"0.3em 1em"}},Se={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},be={key:0,class:"card-detail"},Te={style:{padding:"0 1em"}},Ne={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ie=C(()=>l("hr",null,null,-1)),Ve=C(()=>l("div",{style:{padding:"1em"}},"No artwork added",-1)),Ee=C(()=>l("hr",null,null,-1)),Be={style:{display:"flex",padding:"1em"}},De=C(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),Oe={key:0,style:{padding:"1em"}},je={style:{display:"flex","justify-content":"space-between"}},ze={style:{padding:"1em 0em"}},Le={style:{display:"flex","justify-content":"end"}},Je=L({__name:"PlaqueCard",props:{plaque:null},setup(i){const d=i,$=Q(),s=g("simple"),c=g(!1),k=g(!1),w=g(!1),S=async()=>{w.value=!0,await B(d.plaque.id,{name:d.plaque.entity.name}).catch(n=>{Y(`Error updating plaque tokens - ${n}`)}),k.value=!1,w.value=!1},N=ee(),v=T(()=>y.value.length==0?null:y.value[0]),y=T(()=>{const n=N.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(a=>n[a])});g("0"),g(!0);const m=()=>{U.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{B(d.plaque.id,{token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Tokens cleared"})}).catch(n=>{E({message:`Error clearing tokens from plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},A=()=>{U.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{B(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Plaque forgotten"})}).catch(n=>{E({message:`Error forgetting plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},h=()=>{const n=$.resolve({name:"preview-plaque",params:{plaque_id:d.plaque.id}});window.open(n.href)};return(n,t)=>{const a=u("el-button"),P=u("el-tag"),x=u("el-col"),te=u("el-row"),oe=u("ArrowRight"),O=u("el-icon"),j=u("el-collapse-transition"),M=u("Close"),ae=u("el-card");return p(),V(ae,null,{default:o(()=>[l("div",we,[k.value?R((p(),q("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=_=>d.plaque.entity.name=_),class:"edit-name-input"},null,512)),[[se,d.plaque.entity.name]]):(p(),q("h1",qe,b(d.plaque.entity.name),1)),k.value?I("",!0):(p(),V(a,{key:2,icon:f(ie),onClick:t[1]||(t[1]=_=>k.value=!0),class:"editIcon",circle:""},null,8,["icon"])),k.value?(p(),V(a,{key:3,icon:f(de),loading:w.value,onClick:S,class:"editIcon",circle:"",type:w.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),he,e(P,{class:"ml-2",type:"success"},{default:o(()=>[r("online")]),_:1})]),e(j,null,{default:o(()=>[R(l("section",xe,[Ce,e(te,{style:{padding:"1em"}},{default:o(()=>[e(x,{span:12},{default:o(()=>{var _;return[$e,l("span",null,b(((_=f(v))==null?void 0:_.entity.name)||"N/A"),1)]}),_:1}),e(x,{span:12},{default:o(()=>{var _;return[Ae,r(" "+b(((_=f(v))==null?void 0:_.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),l("div",Pe,b(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),l("div",Se,[e(a,{type:"info",onClick:t[2]||(t[2]=_=>c.value=!0)},{default:o(()=>[r("Add Artwork")]),_:1}),e(a,{onClick:t[3]||(t[3]=_=>s.value="detail")},{default:o(()=>[r(" Details"),e(O,{class:"el-icon--right"},{default:o(()=>[e(oe)]),_:1})]),_:1})])],512),[[_e,s.value=="simple"]])]),_:1}),e(j,null,{default:o(()=>[s.value=="detail"?(p(),q("section",be,[l("p",Te,b(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),l("div",Ne,[e(a,{onClick:t[4]||(t[4]=_=>s.value="settings")},{default:o(()=>[r("Settings")]),_:1}),e(a,{onClick:m},{default:o(()=>[r("Clear Artwork")]),_:1})]),Ie,f(y).length==0?(p(),q(D,{key:0},[Ve,Ee],64)):I("",!0),(p(!0),q(D,null,K(f(y),_=>(p(),V(pe,{token_meta:_},null,8,["token_meta"]))),256)),l("div",Be,[e(a,{type:"info",onClick:t[5]||(t[5]=_=>c.value=!0)},{default:o(()=>[r("Add Artwork")]),_:1}),De,e(a,{onClick:t[6]||(t[6]=_=>s.value="simple")},{default:o(()=>[r("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(j,null,{default:o(()=>[s.value=="settings"?(p(),q("section",Oe,[l("div",je,[e(a,null,{default:o(()=>[r("Preview Art")]),_:1}),e(a,{onClick:h},{default:o(()=>[r("Preview Plaque")]),_:1})]),l("div",ze,[e(a,{type:"danger",plain:"",onClick:A},{default:o(()=>[r("Forget Display")]),_:1})]),l("div",Le,[e(a,{onClick:t[7]||(t[7]=_=>s.value="detail")},{default:o(()=>[r("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(ke,{plaque_id:d.plaque.id,show_add_token_dialog:c.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=_=>c.value=_)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Fe=z(Je,[["__scopeId","data-v-1c15685a"]]);const Me=i=>(J("data-v-684951ec"),i=i(),F(),i),Re={class:"add-button-container"},Ue={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ge=Me(()=>l("div",{style:{"font-size":"17px"}},"Add plaque",-1)),He={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},Qe=L({__name:"PlaqueList",setup(i){const d=g(!1),{width:$,screen_type:s}=Z(),c=g(!1),k=Q(),w=X(),S=W(),N=async()=>{d.value=!0,await re({name:"Test Plaque",user_id:w.get_account.id,token_meta_id_list:[],created_at:H.now(),updated_at:H.now()}).catch(y=>E({message:`Error creating test plaque- ${y}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,c.value=!1},v=T(()=>JSON.parse(JSON.stringify(S.all_plaque_list)).sort((m,A)=>{const h=m.entity.name.toLowerCase(),n=A.entity.name.toLowerCase();return h<n?-1:h>n?1:0}));return(y,m)=>{const A=u("Plus"),h=u("el-icon"),n=u("el-button"),t=u("el-dialog");return p(),q(D,null,[(p(!0),q(D,null,K(f(v),a=>(p(),V(Fe,{plaque:a,key:a.id},null,8,["plaque"]))),128)),l("div",Re,[l("div",Ue,[l("div",{class:"add-button",onClick:m[0]||(m[0]=a=>c.value=!0)},[e(h,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[e(A)]),_:1}),Ge])])]),e(t,{modelValue:c.value,"onUpdate:modelValue":m[2]||(m[2]=a=>c.value=a),title:"Add plaque",width:f(s)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[l("div",He,[e(n,{onClick:m[1]||(m[1]=a=>{f(k).push("qr-scan"),c.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[r("Scan Plaque QR Code")]),_:1}),e(n,{icon:"plus",onClick:N,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[r("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var _t=z(Qe,[["__scopeId","data-v-684951ec"]]);export{_t as default};
