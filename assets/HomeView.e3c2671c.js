import{_ as z,a as F,b as U,c as j}from"./search-icon.822e7617.js";import{_ as P,d as D,u as H,a as I,r as V,c as W,b as d,o as i,e as w,w as p,f as o,g as C,h as A,F as M,i as l,j as S,n as L,k as T,t as J,l as K,p as Q,m as X,q as Y,E as N,R as Z}from"./index.8d826f86.js";import{u as R}from"./account.c0853d49.js";import{u as ee}from"./breakpoints.37a698de.js";import{s as ae,a as B,o as te}from"./firebaseConfig.d7a6b5a9.js";import{s as n}from"./util.6534b689.js";import{u as oe}from"./plaque.2acf059c.js";import{u as se}from"./token-meta.da0a8dbd.js";import{u as ne}from"./plaque.d8f28723.js";import{u as le}from"./gallery.38450257.js";import"./types.d2ec9214.js";import"./token-meta.7f5c0ba8.js";import"./gallery.d53d87c7.js";const G=y=>(Q("data-v-320dce18"),y=y(),X(),y),re=G(()=>T("div",{style:{"flex-grow":"1"}},null,-1)),ce=G(()=>T("div",{style:{"flex-grow":"1"}},null,-1)),ie={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},ue=D({__name:"Header",setup(y){const u=H(),m=I(),r=R(),_=V(!1),{md_and_up:h,screen_type:b}=ee(),g=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&u.push({name:e.paneName})},q=W(()=>{const e=r.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),E=()=>{_.value=!0,ae(B).then(()=>{}).catch(e=>{n(e)}).finally(()=>{_.value=!1})},s=e=>new URL({"../assets/base.css":z,"../assets/logo.png":F,"../assets/logo.svg":U,"../assets/search-icon.svg":j}[`../assets/${e}`],self.location).href;return(e,t)=>{const k=d("el-image"),v=d("el-button"),c=d("el-tab-pane"),x=d("el-tabs"),f=d("el-header");return i(),w(f,{class:"header",style:K(o(b)=="xs"?"padding: 0px 8px;":"")},{default:p(()=>[o(h)?(i(),w(k,{key:0,src:s("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):C("",!0),o(u).currentRoute.value.name=="qr-scan"?(i(),A(M,{key:1},[re,l(v,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=a=>o(u).push("plaque-list"))},{default:p(()=>[S(" Cancel ")]),_:1})],64)):(i(),A(M,{key:2},[l(x,{modelValue:o(m).name,"onUpdate:modelValue":t[1]||(t[1]=a=>o(m).name=a),onTabClick:g,class:L(o(h)?"":"small-tabs")},{default:p(()=>[l(c,{label:"Plaques",name:"plaque-list"}),l(c,{label:"Artwork",name:"artwork-tile-grid"}),l(c,{label:"Galleries",name:"gallery-list"}),l(c,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),ce,o(h)?(i(),A("div",ie,[T("div",null,J(o(q)),1),o(r).is_user_admin?(i(),w(v,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:p(()=>[S("Admin")]),_:1})):C("",!0)])):C("",!0),l(v,{onClick:E,style:{"margin-left":"1em"},loading:_.value},{default:p(()=>[S("Logout")]),_:1},8,["loading"])],64))]),_:1},8,["style"])}}});var _e=P(ue,[["__scopeId","data-v-320dce18"]]);const de=D({__name:"HomeView",setup(y){const u=R(),m=oe(),r=se(),_=le(),h=H(),b=V(!1),g=V(),q=I();Y(async()=>{g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),te(B,async s=>{console.log("onAuthStateChanged",s),s?(g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await E(s.uid),g.value.close()):(u.setAccount(null),g.value.close(),h.push({name:"login",query:{redir:window.location.href}}))})});async function E(s){await u.loadAccount(s),await _.loadGalleryList(s).catch(a=>n(`Error loading galleries - ${a}`));const e=m.loadPlaques(s).catch(a=>n(`Error loading plaques - ${a}`)),t=m.loadGalleryPlaques(_.gallery_list).catch(a=>n(`Error loading gallery plaques - ${a}`)),k=r.loadArchiveTokenMetas(s).catch(a=>n(`Error loading archive token metas - ${a}`)),v=r.loadGalleryTokenMetas(_.gallery_list).catch(a=>n(`Error loading token metas - ${a}`)),c=[e,t,k,t,v],x="0xd8945d98ed4233Cf87cfA4fDCC7a54FE279E8ee7";{const a=r.loadOpenseaMintedTokenMetas(x).catch($=>n(`Error loading opensea minted tokens - ${$}`)),O=r.loadOpenseaWalletTokenMetas(x).catch($=>n(`Error loading opensea wallet tokens - ${$}`));c.push(a),c.push(O)}await Promise.all(c),await r.loadOpenseaConvertedTokens();const f=q.query.plaque_id;f&&typeof f=="string"&&!m.plaque_map[f]&&await ne(f,{user_id:u.get_account.id,token_meta_id_list:[]}).catch(a=>{n(`Error adding plaque from query param = ${a}`)}),b.value=!0}return(s,e)=>{const t=d("el-main"),k=d("el-container");return i(),w(k,{style:{height:"100%","flex-direction":"column"}},{default:p(()=>[l(_e),l(t,{style:{"background-color":"#DAD9D7"},class:L(o(q).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:p(()=>[b.value?(i(),w(o(Z),{key:0})):C("",!0)]),_:1},8,["class"])]),_:1})}}});var Ee=P(de,[["__scopeId","data-v-568b1d22"]]);export{Ee as default};
