import{_ as z,d as J,r as y,c as N,v as ne,b as c,o as r,e as v,i as e,w as a,k as o,t as S,j as _,f,x as se,y as U,z as F,u as K,g as V,A as R,B as ie,C as de,h as T,D as ue,G as re,F as j,H as W,I as G,q as E,J as _e}from"./index.0edaa17d.js";import{u as L,c as ce}from"./plaque.7c2bec7b.js";import{c as pe}from"./token-meta.ba91ce12.js";import{u as X}from"./plaque.678384de.js";import{u as Y}from"./account.8a1b5219.js";import{s as Z}from"./util.7328021e.js";import{T as H}from"./types.ab61d3d9.js";import{u as ee}from"./breakpoints.69441797.js";import{u as te}from"./token-meta.5b0b81e8.js";import{_ as me}from"./TokenSelectList.1f9fda41.js";import{_ as fe}from"./PlaqueTokenItem.24444cf0.js";import{n as Q}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.367f1906.js";import"./thumbnail-image.7c0396c4.js";const ve=s=>(U("data-v-cc2989e6"),s=s(),F(),s),ye={class:"dialog-container"},ge={class:"dialog-footer"},ke=ve(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),he=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(s,{emit:d}){const P=s,i=y([]),p=y(!1),{screen_type:w}=ee(),x=X(),C=te(),I=Y(),g=N({get(){return P.show_add_token_dialog},set(n){d("update:show_add_token_dialog",n)}});ne(g,n=>{n&&(i.value=JSON.parse(JSON.stringify($.value.entity.token_meta_id_list)))});const $=N(()=>x.plaque_map[P.plaque_id]),D=N(()=>C.sorted_all_token_metas),A=async()=>{p.value=!0;try{for(let[n,t]of i.value.entries()){const l=C.all_token_metas[t];if(!l)throw"Failed to find store token for token: "+t;if(l.entity.platform!=H.Opensea)continue;const k=JSON.parse(JSON.stringify(l));k.entity.user_id=I.get_account.id,k.entity.platform=H.OpenseaArchive;const h=await pe(k.entity);i.value[n]=h.id}await L(P.plaque_id,{token_meta_id_list:i.value}),x.plaque_map[P.plaque_id].entity.token_meta_id_list=i.value}catch(n){Z(`Error updating plaque tokens - ${n}`)}p.value=!1,g.value=!1},m=()=>{i.value=[]};return(n,t)=>{const l=c("el-button"),k=c("el-dialog");return r(),v("div",ye,[e(k,{center:"",modelValue:f(g),"onUpdate:modelValue":t[1]||(t[1]=h=>se(g)?g.value=h:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:f(w)=="xs",top:"2vh"},{footer:a(()=>[o("div",ge,[o("div",null,S(`Artwork in playlist: ${i.value.length}`),1),ke,e(l,{onClick:m},{default:a(()=>[_("Clear")]),_:1}),e(l,{type:"info",onClick:A,loading:p.value},{default:a(()=>[_("Save")]),_:1},8,["loading"])])]),default:a(()=>[e(me,{selected_token_meta_id_list:i.value,"onUpdate:selected_token_meta_id_list":t[0]||(t[0]=h=>i.value=h),token_meta_list:f(D)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var qe=z(he,[["__scopeId","data-v-cc2989e6"]]);const b=s=>(U("data-v-2a08af85"),s=s(),F(),s),we={style:{display:"flex","align-items":"center",padding:"1em"}},xe={key:0},Ce=b(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),$e={class:"card-simple"},Ae=b(()=>o("hr",null,null,-1)),be=b(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Pe=b(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Se={style:{padding:"0.3em 1em"}},Ne={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Te={key:0,class:"card-detail"},Ve={style:{padding:"0 1em"}},Ie={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},De=b(()=>o("hr",null,null,-1)),Ee=b(()=>o("div",{style:{padding:"1em"}},"No artwork added",-1)),Le=b(()=>o("hr",null,null,-1)),je={style:{display:"flex",padding:"1em"}},Be=b(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),Oe={key:0,style:{padding:"1em"}},ze={style:{display:"flex","justify-content":"space-between"}},Je={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Ue={key:0},Fe=b(()=>o("div",null,"Associated User ID:",-1)),Me={key:1},Re={style:{display:"flex","justify-content":"end"}},Ge=J({__name:"PlaqueCard",props:{plaque:null},setup(s){const d=s,P=K(),i=y("simple"),p=y(!1),w=y(!1),x=y(!1),C=async()=>{x.value=!0,await L(d.plaque.id,{name:d.plaque.entity.name}).catch(n=>{Z(`Error updating plaque tokens - ${n}`)}),w.value=!1,x.value=!1},I=te(),g=N(()=>$.value.length==0?null:$.value[0]),$=N(()=>{const n=I.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(l=>n[l])});y("0"),y(!0);const D=()=>{G.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{L(d.plaque.id,{token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Tokens cleared"})}).catch(n=>{E({message:`Error clearing tokens from plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},A=()=>{G.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{L(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Plaque forgotten"})}).catch(n=>{E({message:`Error forgetting plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},m=()=>{const n=P.resolve({name:"preview-plaque",params:{plaque_id:d.plaque.id}});window.open(n.href)};return(n,t)=>{const l=c("el-button"),k=c("el-tag"),h=c("el-col"),q=c("el-row"),ae=c("ArrowRight"),B=c("el-icon"),O=c("el-collapse-transition"),M=c("Close"),le=c("el-card");return r(),V(le,null,{default:a(()=>[o("div",we,[w.value?R((r(),v("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=u=>d.plaque.entity.name=u),class:"edit-name-input"},null,512)),[[ie,d.plaque.entity.name]]):(r(),v("h1",xe,S(d.plaque.entity.name),1)),w.value?T("",!0):(r(),V(l,{key:2,icon:f(de),onClick:t[1]||(t[1]=u=>w.value=!0),class:"editIcon",circle:""},null,8,["icon"])),w.value?(r(),V(l,{key:3,icon:f(ue),loading:x.value,onClick:C,class:"editIcon",circle:"",type:x.value?"":"success",text:""},null,8,["icon","loading","type"])):T("",!0),Ce,e(k,{class:"ml-2",type:"success"},{default:a(()=>[_("online")]),_:1})]),e(O,null,{default:a(()=>[R(o("section",$e,[Ae,e(q,{style:{padding:"1em"}},{default:a(()=>[e(h,{span:12},{default:a(()=>{var u;return[be,o("span",null,S(((u=f(g))==null?void 0:u.entity.name)||"N/A"),1)]}),_:1}),e(h,{span:12},{default:a(()=>{var u;return[Pe,_(" "+S(((u=f(g))==null?void 0:u.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),o("div",Se,S(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),o("div",Ne,[e(l,{type:"info",onClick:t[2]||(t[2]=u=>p.value=!0)},{default:a(()=>[_("Add Artwork")]),_:1}),e(l,{onClick:t[3]||(t[3]=u=>i.value="detail")},{default:a(()=>[_(" Details"),e(B,{class:"el-icon--right"},{default:a(()=>[e(ae)]),_:1})]),_:1})])],512),[[re,i.value=="simple"]])]),_:1}),e(O,null,{default:a(()=>[i.value=="detail"?(r(),v("section",Te,[o("p",Ve,S(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),o("div",Ie,[e(l,{onClick:t[4]||(t[4]=u=>i.value="settings")},{default:a(()=>[_("Settings")]),_:1}),e(l,{onClick:D},{default:a(()=>[_("Clear Artwork")]),_:1})]),De,f($).length==0?(r(),v(j,{key:0},[Ee,Le],64)):T("",!0),(r(!0),v(j,null,W(f($),u=>(r(),V(fe,{token_meta:u},null,8,["token_meta"]))),256)),o("div",je,[e(l,{type:"info",onClick:t[5]||(t[5]=u=>p.value=!0)},{default:a(()=>[_("Add Artwork")]),_:1}),Be,e(l,{onClick:t[6]||(t[6]=u=>i.value="simple")},{default:a(()=>[_("Close"),e(B,{class:"el-icon--right"},{default:a(()=>[e(M)]),_:1})]),_:1})])])):T("",!0)]),_:1}),e(O,null,{default:a(()=>[i.value=="settings"?(r(),v("section",Oe,[o("div",ze,[e(l,null,{default:a(()=>[_("Preview Art")]),_:1}),e(l,{onClick:m},{default:a(()=>[_("Preview Plaque")]),_:1})]),o("div",Je,[s.plaque.entity.user_id?(r(),v("div",Ue,[Fe,o("div",null,S(s.plaque.entity.user_id),1)])):(r(),v("div",Me,"No associated user")),s.plaque.entity.user_id?(r(),V(l,{key:2,type:"danger",plain:"",onClick:A},{default:a(()=>[_("Forget Display")]),_:1})):T("",!0)]),o("div",Re,[e(l,{onClick:t[7]||(t[7]=u=>i.value="detail")},{default:a(()=>[_("Close"),e(B,{class:"el-icon--right"},{default:a(()=>[e(M)]),_:1})]),_:1})])])):T("",!0)]),_:1}),e(qe,{plaque_id:d.plaque.id,show_add_token_dialog:p.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=u=>p.value=u)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var He=z(Ge,[["__scopeId","data-v-2a08af85"]]);const oe=s=>(U("data-v-693bb944"),s=s(),F(),s),Qe={class:"subheader"},Ke=oe(()=>o("div",{style:{"padding-bottom":"40px"}},null,-1)),We={class:"add-button-container"},Xe={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ye=oe(()=>o("div",{style:{"font-size":"17px"}},"Add plaque",-1)),Ze={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},et=J({__name:"PlaqueList",setup(s){const d=y(!1),{width:P,screen_type:i}=ee(),p=y(!1),w=K(),x=Y(),C=y(""),I=X(),g=async()=>{d.value=!0,await ce({name:"Test Plaque",user_id:x.get_account.id,token_meta_id_list:[],created_at:Q.now(),updated_at:Q.now()}).catch(A=>E({message:`Error creating test plaque- ${A}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,p.value=!1},$=N(()=>JSON.parse(JSON.stringify(I.all_plaque_list)).sort((m,n)=>{const t=m.entity.name.toLowerCase(),l=n.entity.name.toLowerCase();return t<l?-1:t>l?1:0})),D=N(()=>C?$.value.filter(A=>A.entity.name.toLowerCase().includes(C.value.toLowerCase())):$.value);return(A,m)=>{const n=c("el-input"),t=c("Plus"),l=c("el-icon"),k=c("el-button"),h=c("el-dialog");return r(),v(j,null,[o("div",Qe,[e(n,{modelValue:C.value,"onUpdate:modelValue":m[0]||(m[0]=q=>C.value=q),"prefix-icon":f(_e),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"])]),Ke,(r(!0),v(j,null,W(f(D),q=>(r(),V(He,{plaque:q,key:q.id},null,8,["plaque"]))),128)),o("div",We,[o("div",Xe,[o("div",{class:"add-button",onClick:m[1]||(m[1]=q=>p.value=!0)},[e(l,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:a(()=>[e(t)]),_:1}),Ye])])]),e(h,{modelValue:p.value,"onUpdate:modelValue":m[3]||(m[3]=q=>p.value=q),title:"Add plaque",width:f(i)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:a(()=>[o("div",Ze,[e(k,{onClick:m[2]||(m[2]=q=>{f(w).push("qr-scan"),p.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:a(()=>[_("Scan Plaque QR Code")]),_:1}),e(k,{icon:"plus",onClick:g,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:a(()=>[_("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var ft=z(et,[["__scopeId","data-v-693bb944"]]);export{ft as default};
