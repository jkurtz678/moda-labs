import{_ as I,a as F,b as j,c as W,d as J}from"./WelcomeDialog.c5ad4b2f.js";import{d as L,r as P,c as K,a as x,w as d,n as Q,u as o,b as N,e as H,f as m,o as r,g as q,h as A,i as V,j as n,k as S,F as D,l as R,t as X,_ as B,m as Y,E as M,p as Z,R as ee}from"./index.cbd65a3d.js";import{u as G}from"./account.774c0209.js";import{u as te}from"./breakpoints.6c5b91ac.js";import{s as ae,a as O,o as oe}from"./firebaseConfig.4d01e9b5.js";import{s as l}from"./util.2465e7f3.js";import{u as ne}from"./plaque.0280400d.js";import{u as se}from"./token-meta.79efd9cb.js";import{u as le}from"./gallery.2a7770a4.js";import{a as re}from"./add-plaque.8d9aecce.js";import"./types.903c99bc.js";import"./plaque.9bc68070.js";import"./token-meta.3b6b8610.js";import"./gallery-token.7f50acd9.js";const ie={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},ue=L({__name:"Header",setup(U){const i=N(),k=H(),s=G(),u=P(!1),{md_and_up:p,screen_type:b}=te(),g=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&i.push({name:e.paneName})},h=K(()=>{const e=s.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),w=()=>{u.value=!0,ae(O).then(()=>{}).catch(e=>{l(e)}).finally(()=>{u.value=!1})},C=e=>new URL({"../assets/base.css":I,"../assets/logo.png":F,"../assets/logo.svg":j,"../assets/search-icon.svg":W}[`../assets/${e}`],self.location).href;return(e,t)=>{const f=m("el-image"),c=m("el-button"),y=m("el-tab-pane"),$=m("el-tabs"),v=m("el-header");return r(),x(v,{class:"header",style:Q(o(b)=="xs"?"padding: 0px 8px;":"")},{default:d(()=>[o(p)?(r(),x(f,{key:0,src:C("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):q("",!0),o(i).currentRoute.value.name=="qr-scan"?(r(),A(D,{key:1},[t[3]||(t[3]=V("div",{style:{"flex-grow":"1"}},null,-1)),n(c,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=_=>o(i).push("plaque-list"))},{default:d(()=>t[2]||(t[2]=[S(" Cancel ")])),_:1})],64)):(r(),A(D,{key:2},[n($,{modelValue:o(k).name,"onUpdate:modelValue":t[1]||(t[1]=_=>o(k).name=_),onTabClick:g,class:R(o(p)?"":"small-tabs")},{default:d(()=>[n(y,{label:"Plaques",name:"plaque-list"}),n(y,{label:"Artwork",name:"artwork-tile-grid"}),n(y,{label:"Galleries",name:"gallery-list"}),n(y,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),t[6]||(t[6]=V("div",{style:{"flex-grow":"1"}},null,-1)),o(p)?(r(),A("div",ie,[V("div",null,X(h.value),1),o(s).is_user_admin?(r(),x(c,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:d(()=>t[4]||(t[4]=[S("Admin")])),_:1})):q("",!0)])):q("",!0),n(c,{onClick:w,style:{"margin-left":"1em"},loading:u.value},{default:d(()=>t[5]||(t[5]=[S("Logout")])),_:1},8,["loading"])],64))]),_:1},8,["style"])}}});var ce=B(ue,[["__scopeId","data-v-5c106a87"]]);const _e=L({__name:"HomeView",setup(U){const i=G(),k=ne(),s=se(),u=le(),p=N(),b=P(!1),g=P(),h=H();let w;Y(async()=>{g.value=M.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),w=oe(O,async e=>{if(console.log("onAuthStateChanged",e),e){g.value=M.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{await C(e.uid)}finally{g.value.close()}}e||(i.setAccount(null),g.value.close(),p.push({name:"login",query:{redir:window.location.href}}))})}),Z(()=>{console.log("unsubscribe onAuthStateChanged on unmount"),w()});async function C(e){console.log("LOAD APP DATA"),await i.loadAccount(e),await u.loadGalleryList(e).catch(a=>l(`Error loading galleries - ${a}`)),console.log("done loading galleries");const t=k.loadPlaques(e).catch(a=>l(`Error loading plaques - ${a}`)),f=k.loadGalleryPlaques(u.gallery_plaque_list).catch(a=>l(`Error loading gallery plaques - ${a}`)),c=s.loadArchiveTokenMetas(e).catch(a=>l(`Error loading archive token metas - ${a}`)),y=s.loadGalleryTokenMetas(u.gallery_token_meta_list).catch(a=>l(`Error loading token metas - ${a}`)),$=s.loadDemoTokenMetas().catch(a=>l(`Error loading demo token metas - ${a}`)),v=[t,f,c,f,y,$],_=i.get_account.entity.wallet_address;if(_){const a=s.loadOpenseaMintedTokenMetas(_).catch(T=>l(`Error loading opensea minted tokens - ${T}`)),z=s.loadOpenseaWalletTokenMetas(_).catch(T=>l(`Error loading opensea wallet tokens - ${T}`));v.push(a),v.push(z)}await Promise.all(v),_&&await s.loadOpenseaConvertedTokens();const E=h.query.plaque_id;E&&typeof E=="string"&&(await re(e,E),p.replace({path:h.path,query:{}})),b.value=!0}return(e,t)=>{const f=m("el-main"),c=m("el-container");return r(),A(D,null,[n(c,{style:{height:"100%",position:"fixed",top:"0px",left:"0px",right:"0px",bottom:"0px"}},{default:d(()=>[n(ce),n(f,{style:{"background-color":"#DAD9D7"},class:R(o(h).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:d(()=>[b.value?(r(),x(o(ee),{key:0})):q("",!0)]),_:1},8,["class"])]),_:1}),n(J)],64)}}});var Ce=B(_e,[["__scopeId","data-v-0998a441"]]);export{Ce as default};
