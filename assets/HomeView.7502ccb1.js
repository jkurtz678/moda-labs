import{_ as U,a as z,b as F,c as j}from"./search-icon.822e7617.js";import{_ as P,d as H,u as I,a as L,r as S,c as W,b as d,o as c,e as b,w as m,f as o,g as C,h as A,F as M,i as n,j as V,n as R,k as T,t as J,p as K,l as Q,m as X,E as N,R as Y}from"./index.1498a7c8.js";import{u as B}from"./account.2a00324b.js";import{u as Z}from"./breakpoints.89ad2cac.js";import{s as ee,a as D,o as ae}from"./firebaseConfig.d7a6b5a9.js";import{s}from"./util.a1c4fcce.js";import{u as te}from"./plaque.78157675.js";import{u as oe}from"./token-meta.39e5483f.js";import{u as se}from"./plaque.093acf64.js";import{u as ne}from"./gallery.3ea0f64c.js";import"./types.6a5ef88e.js";import"./token-meta.e73e8480.js";import"./gallery.214f82bf.js";const G=h=>(K("data-v-162afaf1"),h=h(),Q(),h),le=G(()=>T("div",{style:{"flex-grow":"1"}},null,-1)),re=G(()=>T("div",{style:{"flex-grow":"1"}},null,-1)),ce={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},ie=H({__name:"Header",setup(h){const l=I(),p=L(),r=B(),i=S(!1),{md_and_up:k}=Z(),q=(e,a)=>{e.paneName&&typeof e.paneName=="string"&&l.push({name:e.paneName})},g=W(()=>{const e=r.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const a=e.entity.wallet_address;return a?`${a.substring(0,6)}...${a.substring(a.length-4)}`:""}),x=()=>{i.value=!0,ee(D).then(()=>{}).catch(e=>{s(e)}).finally(()=>{i.value=!1})},$=e=>new URL({"../assets/base.css":U,"../assets/logo.png":z,"../assets/logo.svg":F,"../assets/search-icon.svg":j}[`../assets/${e}`],self.location).href;return(e,a)=>{const f=d("el-image"),u=d("el-button"),y=d("el-tab-pane"),v=d("el-tabs"),w=d("el-header");return c(),b(w,{class:"header"},{default:m(()=>[o(k)?(c(),b(f,{key:0,src:$("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):C("",!0),o(l).currentRoute.value.name=="qr-scan"?(c(),A(M,{key:1},[le,n(u,{icon:"close",color:"#000000",onClick:a[0]||(a[0]=_=>o(l).push("plaque-list"))},{default:m(()=>[V(" Cancel ")]),_:1})],64)):(c(),A(M,{key:2},[n(v,{modelValue:o(p).name,"onUpdate:modelValue":a[1]||(a[1]=_=>o(p).name=_),onTabClick:q,class:R(o(k)?"":"small-tabs")},{default:m(()=>[n(y,{label:"Plaques",name:"plaque-list"}),n(y,{label:"Artwork",name:"artwork-tile-grid"}),n(y,{label:"Galleries",name:"gallery-list"}),n(y,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),re,o(k)?(c(),A("div",ce,[T("div",null,J(o(g)),1),o(r).is_user_admin?(c(),b(u,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:m(()=>[V("Admin")]),_:1})):C("",!0)])):C("",!0),n(u,{onClick:x,style:{"margin-left":"1em"},loading:i.value},{default:m(()=>[V("Logout")]),_:1},8,["loading"])],64))]),_:1})}}});var ue=P(ie,[["__scopeId","data-v-162afaf1"]]);const _e=H({__name:"HomeView",setup(h){const l=B(),p=te(),r=oe(),i=ne(),k=I(),q=S(!1),g=S(),x=L();X(async()=>{g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),ae(D,async e=>{console.log("onAuthStateChanged",e),e?(g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await $(e.uid),g.value.close()):(l.setAccount(null),g.value.close(),k.push({name:"login",query:{redir:window.location.href}}))})});async function $(e){await l.loadAccount(e),await i.loadGalleryList(e).catch(t=>s(`Error loading galleries - ${t}`));const a=p.loadPlaques(e).catch(t=>s(`Error loading plaques - ${t}`)),f=p.loadGalleryPlaques(i.gallery_list).catch(t=>s(`Error loading gallery plaques - ${t}`)),u=r.loadArchiveTokenMetas(e).catch(t=>s(`Error loading archive token metas - ${t}`)),y=r.loadGalleryTokenMetas(i.gallery_list).catch(t=>s(`Error loading token metas - ${t}`)),v=[a,f,u,f,y],w=l.get_account.entity.wallet_address;if(w){const t=r.loadOpenseaMintedTokenMetas(w).catch(E=>s(`Error loading opensea minted tokens - ${E}`)),O=r.loadOpenseaWalletTokenMetas(w).catch(E=>s(`Error loading opensea wallet tokens - ${E}`));v.push(t),v.push(O)}await Promise.all(v),await r.loadOpenseaConvertedTokens();const _=x.query.plaque_id;_&&typeof _=="string"&&!p.plaque_map[_]&&await se(_,{user_id:l.get_account.id,token_meta_id_list:[]}).catch(t=>{s(`Error adding plaque from query param = ${t}`)}),q.value=!0}return(e,a)=>{const f=d("el-main"),u=d("el-container");return c(),b(u,{style:{height:"100%","flex-direction":"column"}},{default:m(()=>[n(ue),n(f,{style:{"background-color":"#DAD9D7"},class:R(o(x).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:m(()=>[q.value?(c(),b(o(Y),{key:0})):C("",!0)]),_:1},8,["class"])]),_:1})}}});var Ce=P(_e,[["__scopeId","data-v-08f0d2c0"]]);export{Ce as default};
