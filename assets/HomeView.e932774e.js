import{_ as O,a as U,b as z,c as F}from"./search-icon.822e7617.js";import{_ as H,d as I,u as L,a as P,r as V,c as j,b as p,o as u,e as b,w as g,f as o,g as x,h as E,F as N,i as r,j as A,n as R,k as S,t as W,p as J,l as K,m as Q,E as T,R as X}from"./index.831b25a0.js";import{u as B}from"./account.72092b89.js";import{u as Y}from"./breakpoints.0af87429.js";import{s as Z,a as D,o as ee}from"./firebaseConfig.d7a6b5a9.js";import{s as l}from"./util.ffd4ce15.js";import{u as ae}from"./plaque.95052769.js";import{u as te}from"./token-meta.3d1f5885.js";import{u as oe}from"./plaque.093acf64.js";import{u as se}from"./gallery.62764c82.js";import"./types.6a5ef88e.js";import"./token-meta.2d60a689.js";import"./gallery.82c2a091.js";const G=k=>(J("data-v-68437b7c"),k=k(),K(),k),ne=G(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),le=G(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),re={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},ce=I({__name:"Header",setup(k){const c=L(),f=P(),_=B(),d=V(!1),{width:M,screen_type:n}=Y(),y=(e,a)=>{e.paneName&&typeof e.paneName=="string"&&c.push({name:e.paneName})},w=j(()=>{const e=_.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const a=e.entity.wallet_address;return a?`${a.substring(0,6)}...${a.substring(a.length-4)}`:""}),$=()=>{d.value=!0,Z(D).then(()=>{}).catch(e=>{l(e)}).finally(()=>{d.value=!1})},s=e=>new URL({"../assets/base.css":O,"../assets/logo.png":U,"../assets/logo.svg":z,"../assets/search-icon.svg":F}[`../assets/${e}`],self.location).href;return(e,a)=>{const v=p("el-image"),m=p("el-button"),i=p("el-tab-pane"),h=p("el-tabs"),t=p("el-header");return u(),b(t,{class:"header"},{default:g(()=>[o(n)!="sm"&&o(n)!="xs"?(u(),b(v,{key:0,src:s("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):x("",!0),o(c).currentRoute.value.name=="qr-scan"?(u(),E(N,{key:1},[ne,r(m,{icon:"close",color:"#000000",onClick:a[0]||(a[0]=q=>o(c).push("plaque-list"))},{default:g(()=>[A(" Cancel ")]),_:1})],64)):(u(),E(N,{key:2},[r(h,{modelValue:o(f).name,"onUpdate:modelValue":a[1]||(a[1]=q=>o(f).name=q),onTabClick:y,class:R(o(n)=="lg"||o(n)=="md"?"":"small-tabs")},{default:g(()=>[r(i,{label:"Plaques",name:"plaque-list"}),r(i,{label:"Artwork",name:"artwork-tile-grid"}),r(i,{label:"Galleries",name:"gallery-list"}),r(i,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),le,o(n)!="sm"&&o(n)!="xs"?(u(),E("div",re,[S("div",null,W(o(w)),1),o(_).is_user_admin?(u(),b(m,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:g(()=>[A("Admin")]),_:1})):x("",!0)])):x("",!0),r(m,{onClick:$,style:{"margin-left":"1em"},loading:d.value},{default:g(()=>[A("Logout")]),_:1},8,["loading"])],64))]),_:1})}}});var ie=H(ce,[["__scopeId","data-v-68437b7c"]]);const ue=I({__name:"HomeView",setup(k){const c=B(),f=ae(),_=te(),d=se(),M=L(),n=V(!1),y=V(),w=P();Q(async()=>{y.value=T.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),ee(D,async s=>{console.log("onAuthStateChanged",s),s?(y.value=T.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await $(s.uid),y.value.close()):(c.setAccount(null),y.value.close(),M.push({name:"login",query:{redir:window.location.href}}))})});async function $(s){await c.loadAccount(s),await d.loadGalleryList(s).catch(t=>l(`Error loading galleries - ${t}`));const e=f.loadPlaques(s).catch(t=>l(`Error loading plaques - ${t}`)),a=f.loadGalleryPlaques(d.gallery_list).catch(t=>l(`Error loading gallery plaques - ${t}`)),v=_.loadArchiveTokenMetas(s).catch(t=>l(`Error loading archive token metas - ${t}`));_.loadGalleryTokenMetas(d.gallery_list).catch(t=>l(`Error loading token metas - ${t}`));const m=[e,a,v,a],i=c.get_account.entity.wallet_address;if(i){const t=_.loadOpenseaMintedTokenMetas(i).catch(C=>l(`Error loading opensea minted tokens - ${C}`)),q=_.loadOpenseaWalletTokenMetas(i).catch(C=>l(`Error loading opensea wallet tokens - ${C}`));m.push(t),m.push(q)}await Promise.all(m);const h=w.query.plaque_id;h&&typeof h=="string"&&!f.plaque_map[h]&&await oe(h,{user_id:c.get_account.id,token_meta_id_list:[]}).catch(t=>{l(`Error adding plaque from query param = ${t}`)}),n.value=!0}return(s,e)=>{const a=p("el-main"),v=p("el-container");return u(),b(v,{style:{height:"100%","flex-direction":"column"}},{default:g(()=>[r(ie),r(a,{style:{"background-color":"#DAD9D7"},class:R(o(w).name=="artwork-tile-grid"?"remove-padding":"")},{default:g(()=>[n.value?(u(),b(o(X),{key:0})):x("",!0)]),_:1},8,["class"])]),_:1})}}});var xe=H(ue,[["__scopeId","data-v-6bf26dc3"]]);export{xe as default};
