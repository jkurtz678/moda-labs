import{_ as O,d as J,r as A,c as N,v as se,b as p,o as _,e as q,i as e,w as l,k as a,t as b,j as c,f,x as ie,y as U,z as F,u as W,g as I,A as G,B as de,C as ue,h as V,D as re,G as _e,F as j,H as X,I as H,q as E,J as ce}from"./index.33ebd277.js";import{u as L,c as pe}from"./plaque.39965a3b.js";import{c as me}from"./token-meta.c2748717.js";import{u as M}from"./plaque.6aff1671.js";import{u as Y}from"./account.cf3676e2.js";import{s as Z}from"./util.f9f7053f.js";import{T as Q}from"./types.6a5ef88e.js";import{u as ee}from"./breakpoints.89356d76.js";import{u as te}from"./token-meta.98c3f38d.js";import{_ as fe}from"./TokenSelectList.71f00e84.js";import{_ as ve}from"./PlaqueTokenItem.07dc1160.js";import{n as K}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.6458cbeb.js";import"./thumbnail-image.0f6fda4d.js";const ye=i=>(U("data-v-cc2989e6"),i=i(),F(),i),ge={class:"dialog-container"},ke={class:"dialog-footer"},qe=ye(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),he=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(i,{emit:d}){const w=i,v=A([]),r=A(!1),{screen_type:x}=ee(),h=M(),y=te(),D=Y(),C=N({get(){return w.show_add_token_dialog},set(m){d("update:show_add_token_dialog",m)}});se(C,m=>{m&&(v.value=JSON.parse(JSON.stringify(T.value.entity.token_meta_id_list)))});const T=N(()=>h.plaque_map[w.plaque_id]),S=N(()=>y.sorted_all_token_metas),g=async()=>{r.value=!0;try{for(let[m,o]of v.value.entries()){const t=y.all_token_metas[o];if(!t)throw"Failed to find store token for token: "+o;if(t.entity.platform!=Q.Opensea)continue;const s=JSON.parse(JSON.stringify(t));s.entity.user_id=D.get_account.id,s.entity.platform=Q.OpenseaArchive;const $=await me(s.entity);v.value[m]=$.id}await L(w.plaque_id,{token_meta_id_list:v.value}),h.plaque_map[w.plaque_id].entity.token_meta_id_list=v.value}catch(m){Z(`Error updating plaque tokens - ${m}`)}r.value=!1,C.value=!1},n=()=>{v.value=[]};return(m,o)=>{const t=p("el-button"),s=p("el-dialog");return _(),q("div",ge,[e(s,{center:"",modelValue:f(C),"onUpdate:modelValue":o[1]||(o[1]=$=>ie(C)?C.value=$:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:f(x)=="xs",top:"2vh"},{footer:l(()=>[a("div",ke,[a("div",null,b(`Artwork in playlist: ${v.value.length}`),1),qe,e(t,{onClick:n},{default:l(()=>[c("Clear")]),_:1}),e(t,{type:"info",onClick:g,loading:r.value},{default:l(()=>[c("Save")]),_:1},8,["loading"])])]),default:l(()=>[e(fe,{selected_token_meta_id_list:v.value,"onUpdate:selected_token_meta_id_list":o[0]||(o[0]=$=>v.value=$),token_meta_list:f(S)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var we=O(he,[["__scopeId","data-v-cc2989e6"]]);const P=i=>(U("data-v-103b3afa"),i=i(),F(),i),xe={style:{display:"flex","align-items":"center",padding:"1em"}},Ce={key:0},$e=P(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Ae={class:"card-simple"},Pe=P(()=>a("hr",null,null,-1)),Se=P(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),be=P(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ne={style:{padding:"0.3em 1em"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Ve={key:0,class:"card-detail"},Ie={style:{padding:"0 1em"}},De={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ee=P(()=>a("hr",null,null,-1)),Le=P(()=>a("div",{style:{padding:"1em"}},"No artwork added",-1)),je=P(()=>a("hr",null,null,-1)),ze={style:{display:"flex",padding:"1em"}},Be=P(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Oe={key:0,style:{padding:"1em"}},Je={style:{display:"flex","justify-content":"space-between"}},Ue={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Fe={key:0},Me=P(()=>a("div",null,"Associated User ID:",-1)),Re={key:1},Ge={style:{display:"flex","justify-content":"end"}},He=J({__name:"PlaqueCard",props:{plaque:null},setup(i){const d=i,w=M(),v=W(),r=A("simple"),x=A(!1),h=A(!1),y=A(!1),D=async()=>{y.value=!0,await L(d.plaque.id,{name:d.plaque.entity.name}).catch(o=>{Z(`Error updating plaque tokens - ${o}`)}),h.value=!1,y.value=!1},C=te(),T=N(()=>S.value.length==0?null:S.value[0]),S=N(()=>{const o=C.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(s=>o[s])}),g=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{L(d.plaque.id,{token_meta_id_list:[]}).then(()=>{w.plaque_map[d.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Tokens cleared"})}).catch(o=>{E({message:`Error clearing tokens from plaque - ${o}`,type:"error",showClose:!0,duration:12e3})})})},n=()=>{H.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{L(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{w.plaque_map[d.plaque.id].entity.user_id="",w.plaque_map[d.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Plaque forgotten"})}).catch(o=>{E({message:`Error forgetting plaque - ${o}`,type:"error",showClose:!0,duration:12e3})})})},m=()=>{const o=v.resolve({name:"preview-plaque",params:{plaque_id:d.plaque.id}});window.open(o.href)};return(o,t)=>{const s=p("el-button"),$=p("el-tag"),k=p("el-col"),le=p("el-row"),oe=p("ArrowRight"),z=p("el-icon"),B=p("el-collapse-transition"),R=p("Close"),ne=p("el-card");return _(),I(ne,null,{default:l(()=>[a("div",xe,[h.value?G((_(),q("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=u=>d.plaque.entity.name=u),class:"edit-name-input"},null,512)),[[de,d.plaque.entity.name]]):(_(),q("h1",Ce,b(d.plaque.entity.name),1)),h.value?V("",!0):(_(),I(s,{key:2,icon:f(ue),onClick:t[1]||(t[1]=u=>h.value=!0),class:"editIcon",circle:""},null,8,["icon"])),h.value?(_(),I(s,{key:3,icon:f(re),loading:y.value,onClick:D,class:"editIcon",circle:"",type:y.value?"":"success",text:""},null,8,["icon","loading","type"])):V("",!0),$e,e($,{class:"ml-2",type:"success"},{default:l(()=>[c("online")]),_:1})]),e(B,null,{default:l(()=>[G(a("section",Ae,[Pe,e(le,{style:{padding:"1em"}},{default:l(()=>[e(k,{span:12},{default:l(()=>{var u;return[Se,a("span",null,b(((u=f(T))==null?void 0:u.entity.name)||"N/A"),1)]}),_:1}),e(k,{span:12},{default:l(()=>{var u;return[be,c(" "+b(((u=f(T))==null?void 0:u.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),a("div",Ne,b(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),a("div",Te,[e(s,{type:"info",onClick:t[2]||(t[2]=u=>x.value=!0)},{default:l(()=>[c("Add Artwork")]),_:1}),e(s,{onClick:t[3]||(t[3]=u=>r.value="detail")},{default:l(()=>[c(" Details"),e(z,{class:"el-icon--right"},{default:l(()=>[e(oe)]),_:1})]),_:1})])],512),[[_e,r.value=="simple"]])]),_:1}),e(B,null,{default:l(()=>[r.value=="detail"?(_(),q("section",Ve,[a("p",Ie,b(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),a("div",De,[e(s,{onClick:t[4]||(t[4]=u=>r.value="settings")},{default:l(()=>[c("Settings")]),_:1}),e(s,{onClick:g},{default:l(()=>[c("Clear Artwork")]),_:1})]),Ee,f(S).length==0?(_(),q(j,{key:0},[Le,je],64)):V("",!0),(_(!0),q(j,null,X(f(S),u=>(_(),I(ve,{token_meta:u},null,8,["token_meta"]))),256)),a("div",ze,[e(s,{type:"info",onClick:t[5]||(t[5]=u=>x.value=!0)},{default:l(()=>[c("Add Artwork")]),_:1}),Be,e(s,{onClick:t[6]||(t[6]=u=>r.value="simple")},{default:l(()=>[c("Close"),e(z,{class:"el-icon--right"},{default:l(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(B,null,{default:l(()=>[r.value=="settings"?(_(),q("section",Oe,[a("div",Je,[e(s,null,{default:l(()=>[c("Preview Art")]),_:1}),e(s,{onClick:m},{default:l(()=>[c("Preview Plaque")]),_:1})]),a("div",Ue,[i.plaque.entity.user_id?(_(),q("div",Fe,[Me,a("div",null,b(i.plaque.entity.user_id),1)])):(_(),q("div",Re,"No associated user")),i.plaque.entity.user_id?(_(),I(s,{key:2,type:"danger",plain:"",onClick:n},{default:l(()=>[c("Forget Display")]),_:1})):V("",!0)]),a("div",Ge,[e(s,{onClick:t[7]||(t[7]=u=>r.value="detail")},{default:l(()=>[c("Close"),e(z,{class:"el-icon--right"},{default:l(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(we,{plaque_id:d.plaque.id,show_add_token_dialog:x.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=u=>x.value=u)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Qe=O(He,[["__scopeId","data-v-103b3afa"]]);const ae=i=>(U("data-v-9fca0326"),i=i(),F(),i),Ke={class:"subheader",style:{display:"flex","align-items":"center"}},We=ae(()=>a("div",{style:{"padding-bottom":"40px"}},null,-1)),Xe={class:"add-button-container"},Ye={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ze=ae(()=>a("div",{style:{"font-size":"17px"}},"Add plaque",-1)),et={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},tt=J({__name:"PlaqueList",setup(i){const d=A(!1),{width:w,screen_type:v}=ee(),r=A(!1),x=W(),h=Y(),y=A(""),D=M(),C=async()=>{d.value=!0,await pe({name:"Test Plaque",user_id:h.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(g=>E({message:`Error creating test plaque- ${g}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,r.value=!1},T=N(()=>JSON.parse(JSON.stringify(D.all_plaque_list)).sort((n,m)=>{const o=n.entity.name.toLowerCase(),t=m.entity.name.toLowerCase();return o<t?-1:o>t?1:0})),S=N(()=>{let g=[...T.value];return g=g.filter(n=>n.entity.name||n.entity.user_id||n.entity.token_meta_id_list.length>0),y?g.filter(n=>n.entity.name.toLowerCase().includes(y.value.toLowerCase())):g});return(g,n)=>{const m=p("el-input"),o=p("el-button"),t=p("Plus"),s=p("el-icon"),$=p("el-dialog");return _(),q(j,null,[a("div",Ke,[e(m,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=k=>y.value=k),"prefix-icon":f(ce),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),e(o,{icon:"Camera",type:"info",onClick:n[1]||(n[1]=k=>f(x).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:l(()=>[c("Scan")]),_:1})]),We,(_(!0),q(j,null,X(f(S),k=>(_(),I(Qe,{plaque:k,key:k.id},null,8,["plaque"]))),128)),a("div",Xe,[a("div",Ye,[a("div",{class:"add-button",onClick:n[2]||(n[2]=k=>r.value=!0)},[e(s,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:l(()=>[e(t)]),_:1}),Ze])])]),e($,{modelValue:r.value,"onUpdate:modelValue":n[4]||(n[4]=k=>r.value=k),title:"Add plaque",width:f(v)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:l(()=>[a("div",et,[e(o,{onClick:n[3]||(n[3]=k=>{f(x).push("qr-scan"),r.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:l(()=>[c("Scan Plaque QR Code")]),_:1}),e(o,{icon:"plus",onClick:C,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:l(()=>[c("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var vt=O(tt,[["__scopeId","data-v-9fca0326"]]);export{vt as default};
