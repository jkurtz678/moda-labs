import{_ as T,a as H,b as M,c as U}from"./search-icon.301e062d.js";import{d as E,u as N,a as S,r as k,c as F,b as i,o as c,e as f,f as n,g as b,h as w,F as V,i as l,w as _,j as $,t as G,k as L,_ as I,l as j,E as A,R as O}from"./index.a8985256.js";import{u as R}from"./account.f6eb4b47.js";import{u as z}from"./breakpoints.ec334bc7.js";import{s as J,a as g,b as B,o as K}from"./util.36b85f41.js";import{u as Q,a as W}from"./plaque.4d93ec43.js";import{u as X}from"./token-meta.fffd801c.js";import{u as Y}from"./plaque.234d51b2.js";const Z={style:{display:"flex","align-items":"center"}},ee=L("div",{style:{"flex-grow":"1"}},null,-1),te=L("div",{style:{"flex-grow":"1"}},null,-1),ae={key:0,style:{"margin-right":"10px"}},oe=E({__name:"Header",setup(D){const r=N(),d=S(),h=R(),m=k(!1),{width:q,screen_type:p}=z(),u=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&r.push({name:e.paneName})},y=F(()=>{const e=h.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),v=()=>{m.value=!0,J(B).then(()=>{}).catch(e=>{g(e)}).finally(()=>{m.value=!1})},o=e=>new URL({"../assets/base.css":T,"../assets/logo.png":H,"../assets/logo.svg":M,"../assets/search-icon.svg":U}[`../assets/${e}`],self.location).href;return(e,t)=>{const s=i("el-image"),a=i("el-button"),x=i("el-tab-pane"),P=i("el-tabs");return c(),f("div",Z,[n(p)!="xs"?(c(),b(s,{key:0,src:o("logo.png"),style:{width:"43px",height:"43px","margin-right":"2em"}},null,8,["src"])):w("",!0),n(r).currentRoute.value.name=="qr-scan"?(c(),f(V,{key:1},[ee,l(a,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=C=>n(r).push("plaque-list"))},{default:_(()=>[$(" Cancel ")]),_:1})],64)):(c(),f(V,{key:2},[l(P,{modelValue:n(d).name,"onUpdate:modelValue":t[1]||(t[1]=C=>n(d).name=C),onTabClick:u},{default:_(()=>[l(x,{label:"Plaques",name:"plaque-list"}),l(x,{label:"Tokens",name:"token-list"})]),_:1},8,["modelValue"]),te,n(p)!="xs"?(c(),f("div",ae,G(n(y)),1)):w("",!0),l(a,{onClick:v,style:{"margin-left":"1em"},loading:m.value},{default:_(()=>[$("Logout")]),_:1},8,["loading"])],64))])}}});const se=E({__name:"HomeView",setup(D){const r=R(),d=Q(),h=X(),m=W(),q=N(),p=k(!1),u=k(),y=S();j(async()=>{u.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),K(B,async o=>{console.log("onAuthStateChanged",o),o?(u.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await v(o.uid),u.value.close()):(r.setAccount(null),u.value.close(),q.push({name:"login",query:{redir:window.location.href}}))})});async function v(o){await r.loadAccount(o),await m.loadGalleryList(o).catch(a=>g(`Error loading galleries - ${a}`));const e=d.loadPlaques(o).catch(a=>g(`Error loading plaques - ${a}`)),t=h.loadArchiveTokenMetas(o).catch(a=>g(`Error loading archive token metas - ${a}`));await Promise.all([e,t]);const s=y.query.plaque_id;s&&typeof s=="string"&&!d.plaque_map[s]&&await Y(s,{user_id:r.get_account.id,token_meta_id_list:[]}).catch(a=>{g(`Error adding plaque from query param = ${a}`)}),p.value=!0}return(o,e)=>{const t=i("el-header"),s=i("el-main"),a=i("el-container");return c(),b(a,{style:{height:"100%"}},{default:_(()=>[l(t,{class:"header"},{default:_(()=>[l(oe)]),_:1}),l(s,{style:{"background-color":"#DAD9D7"}},{default:_(()=>[p.value?(c(),b(n(O),{key:0})):w("",!0)]),_:1})]),_:1})}}});var me=I(se,[["__scopeId","data-v-e9c7bc4a"]]);export{me as default};
