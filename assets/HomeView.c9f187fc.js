import{_ as z,a as F,b as j,c as W}from"./search-icon.3e51fc51.js";import{d as N,r as T,c as J,a as b,w as _,n as K,u as o,b as H,e as I,f as d,o as r,g as A,h as E,i as s,j as V,F as D,k as M,l as P,t as Q,_ as R,p as X,m as Y,q as Z,E as L,s as ee,R as te}from"./index.3e910c80.js";import{u as B}from"./account.43d6d275.js";import{u as ae}from"./breakpoints.9818c8c5.js";import{s as oe,a as G,o as se}from"./firebaseConfig.4d01e9b5.js";import{s as l}from"./util.6d1af7e6.js";import{u as ne}from"./plaque.e4b67f3b.js";import{u as le}from"./token-meta.7c7fb31b.js";import{u as re}from"./gallery.93dd3183.js";import{a as ce}from"./add-plaque.b06b46be.js";import"./types.fed76c89.js";import"./plaque.99bcdbad.js";import"./token-meta.e1a69122.js";import"./gallery-token.3bf3bf45.js";const O=h=>(X("data-v-5c106a87"),h=h(),Y(),h),ie=O(()=>P("div",{style:{"flex-grow":"1"}},null,-1)),ue=O(()=>P("div",{style:{"flex-grow":"1"}},null,-1)),_e={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},de=N({__name:"Header",setup(h){const c=H(),k=I(),n=B(),i=T(!1),{md_and_up:p,screen_type:w}=ae(),m=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&c.push({name:e.paneName})},v=J(()=>{const e=n.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),x=()=>{i.value=!0,oe(G).then(()=>{}).catch(e=>{l(e)}).finally(()=>{i.value=!1})},C=e=>new URL({"../assets/base.css":z,"../assets/logo.png":F,"../assets/logo.svg":j,"../assets/search-icon.svg":W}[`../assets/${e}`],self.location).href;return(e,t)=>{const g=d("el-image"),u=d("el-button"),f=d("el-tab-pane"),S=d("el-tabs"),q=d("el-header");return r(),b(q,{class:"header",style:K(o(w)=="xs"?"padding: 0px 8px;":"")},{default:_(()=>[o(p)?(r(),b(g,{key:0,src:C("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):A("",!0),o(c).currentRoute.value.name=="qr-scan"?(r(),E(D,{key:1},[ie,s(u,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=y=>o(c).push("plaque-list"))},{default:_(()=>[V(" Cancel ")]),_:1})],64)):(r(),E(D,{key:2},[s(S,{modelValue:o(k).name,"onUpdate:modelValue":t[1]||(t[1]=y=>o(k).name=y),onTabClick:m,class:M(o(p)?"":"small-tabs")},{default:_(()=>[s(f,{label:"Plaques",name:"plaque-list"}),s(f,{label:"Artwork",name:"artwork-tile-grid"}),s(f,{label:"Galleries",name:"gallery-list"}),s(f,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),ue,o(p)?(r(),E("div",_e,[P("div",null,Q(v.value),1),o(n).is_user_admin?(r(),b(u,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:_(()=>[V("Admin")]),_:1})):A("",!0)])):A("",!0),s(u,{onClick:x,style:{"margin-left":"1em"},loading:i.value},{default:_(()=>[V("Logout")]),_:1},8,["loading"])],64))]),_:1},8,["style"])}}});var pe=R(de,[["__scopeId","data-v-5c106a87"]]);const me=N({__name:"HomeView",setup(h){const c=B(),k=ne(),n=le(),i=re(),p=H(),w=T(!1),m=T(),v=I();let x;Z(async()=>{m.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),x=se(G,async e=>{if(console.log("onAuthStateChanged",e),e){m.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{await C(e.uid)}finally{m.value.close()}}e||(c.setAccount(null),m.value.close(),p.push({name:"login",query:{redir:window.location.href}}))})}),ee(()=>{console.log("unsubscribe onAuthStateChanged on unmount"),x()});async function C(e){console.log("LOAD APP DATA"),await c.loadAccount(e),await i.loadGalleryList(e).catch(a=>l(`Error loading galleries - ${a}`)),console.log("done loading galleries");const t=k.loadPlaques(e).catch(a=>l(`Error loading plaques - ${a}`)),g=k.loadGalleryPlaques(i.gallery_plaque_list).catch(a=>l(`Error loading gallery plaques - ${a}`)),u=n.loadArchiveTokenMetas(e).catch(a=>l(`Error loading archive token metas - ${a}`)),f=n.loadGalleryTokenMetas(i.gallery_token_meta_list).catch(a=>l(`Error loading token metas - ${a}`)),S=n.loadDemoTokenMetas().catch(a=>l(`Error loading demo token metas - ${a}`)),q=[t,g,u,g,f,S],y=c.get_account.entity.wallet_address;if(y){const a=n.loadOpenseaWalletTokenMetas(y).catch(U=>l(`Error loading opensea wallet tokens - ${U}`));q.push(a)}await Promise.all(q),y&&await n.loadOpenseaConvertedTokens();const $=v.query.plaque_id;$&&typeof $=="string"&&(await ce(e,$),p.replace({path:v.path,query:{}})),w.value=!0}return(e,t)=>{const g=d("el-main"),u=d("el-container");return r(),b(u,{style:{height:"100%",position:"fixed",top:"0px",left:"0px",right:"0px",bottom:"0px"}},{default:_(()=>[s(pe),s(g,{style:{"background-color":"#DAD9D7"},class:M(o(v).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:_(()=>[w.value?(r(),b(o(te),{key:0})):A("",!0)]),_:1},8,["class"])]),_:1})}}});var Ee=R(me,[["__scopeId","data-v-7522968a"]]);export{Ee as default};
