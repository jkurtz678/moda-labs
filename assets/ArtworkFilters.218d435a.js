import{u as T}from"./gallery.9f75faf0.js";import{T as b,e as F}from"./types.b78a5cbd.js";import{u as M}from"./plaque.c14bf239.js";import{d as O,r as p,z as f,c as w,N as P,a as A,w as i,_ as z,f as v,o as k,j as a,k as E,i as y,h as q,H as j,u as G,F as I,g as H}from"./index.7ef43f6e.js";const $=O({__name:"ArtworkFilters",props:{all_tokens:{},search_filter:{},use_local_storage:{type:Boolean},plaque_id:{}},emits:["update-filtered-tokens"],setup(C,{emit:N}){const r=C,S=T(),x=M(),B=N,u=p("");f(u,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_aspect_ratio_filter",t)});const n=p("");f(n,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_gallery",t)});const d=p("");f(d,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_platform",t)});const _=p("");f(_,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_downloaded",t)});const c=p("created_at");f(c,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_sort_order",t)});const V=w(()=>r.plaque_id?x.plaque_media_map[r.plaque_id]:null);P(()=>{r.use_local_storage&&(u.value=localStorage.getItem("artwork_grid_aspect_ratio_filter")||"",n.value=localStorage.getItem("artwork_grid_filter_by_gallery")||"",d.value=localStorage.getItem("artwork_grid_filter_by_platform")||"",_.value=localStorage.getItem("artwork_grid_filter_by_downloaded")||"",c.value=localStorage.getItem("artwork_grid_sort_order")||"name")});const L=w(()=>u.value||n.value||d.value||_.value),h=w(()=>{const t=new Set;return n.value&&S.gallery_token_meta_list.forEach(e=>{e.entity.gallery_id==n.value&&t.add(e.entity.token_meta_id)}),t}),U=w(()=>{if(!r.all_tokens)return[];let t=r.all_tokens.filter(e=>{var s,g;if(r.search_filter&&!((s=e.entity.artist)!=null&&s.toLowerCase().includes(r.search_filter.toLowerCase()))&&!((g=e.entity.name)!=null&&g.toLowerCase().includes(r.search_filter.toLowerCase()))||n.value&&!h.value.has(e.id))return!1;switch(d.value){case"moda_archive":if(e.entity.platform!=b.Archive)return!1;break;case"opensea":if(e.entity.platform!=b.Opensea&&e.entity.platform!=b.OpenseaArchive)return!1;break;case"archive_demo":if(e.entity.platform!=b.ArchiveDemo)return!1;break}if(V.value)switch(_.value){case"downloaded":if(!V.value[F(e)])return!1;break;case"not_downloaded":if(V.value[F(e)])return!1}switch(u.value){case"portrait":if(!e.entity.aspect_ratio||e.entity.aspect_ratio>.9)return!1;break;case"landscape":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<1.1)return!1;break;case"square":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<.9||e.entity.aspect_ratio>1.1)return!1;break}return!0});return c.value==="name"?t=t.sort((e,s)=>e.entity.name.localeCompare(s.entity.name)):c.value==="created_at"&&(t=t.sort((e,s)=>e.entity.created_at==null&&s.entity.created_at==null?0:e.entity.created_at==null?1:s.entity.created_at==null?-1:s.entity.created_at.seconds-e.entity.created_at.seconds)),t});return f(U,t=>{B("update-filtered-tokens",t)},{immediate:!0}),(t,e)=>{const s=v("el-button"),g=v("el-badge"),l=v("el-option"),m=v("el-select"),D=v("el-popover");return k(),A(D,{placement:"bottom",title:"Artwork Filters",width:300,trigger:"click"},{reference:i(()=>[a(g,{"is-dot":"",hidden:!L.value},{default:i(()=>[a(s,{icon:"Filter",style:{"margin-left":"10px"},type:"info",size:"small"},{default:i(()=>e[5]||(e[5]=[E("Filters")])),_:1})]),_:1},8,["hidden"])]),default:i(()=>[e[7]||(e[7]=y("div",{class:"caption"},"Filter by gallery",-1)),a(m,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),placeholder:"Filter by gallery",class:"filter-select"},{default:i(()=>[a(l,{label:"All artwork",value:""}),(k(!0),q(I,null,j(G(S).gallery_list,o=>(k(),A(l,{key:o.id,label:`${o.entity.name}`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[8]||(e[8]=y("div",{class:"caption"},"Filter by aspect ratio",-1)),a(m,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Landscape",value:"landscape"}),a(l,{label:"Portrait",value:"portrait"}),a(l,{label:"Square",value:"square"})]),_:1},8,["modelValue"]),e[9]||(e[9]=y("div",{class:"caption"},"Filter by platform",-1)),a(m,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Moda Archive",value:"moda_archive"}),a(l,{label:"Opensea",value:"opensea"}),a(l,{label:"Demo",value:"archive_demo"})]),_:1},8,["modelValue"]),t.plaque_id?(k(),q(I,{key:0},[e[6]||(e[6]=y("div",{class:"caption"},"Filter by downloaded",-1)),a(m,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=o=>_.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Downloaded",value:"downloaded"}),a(l,{label:"Not Downloaded",value:"not_downloaded"})]),_:1},8,["modelValue"])],64)):H("",!0),e[10]||(e[10]=y("div",{class:"caption"},"Sort order",-1)),a(m,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=o=>c.value=o),placeholder:"Sort by",class:"filter-select"},{default:i(()=>[a(l,{label:"Sort by name",value:"name"}),a(l,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"])]),_:1})}}});var W=z($,[["__scopeId","data-v-313d1b94"]]);export{W as A};
