import{d as U,c as S,b as p,o as c,e as x,k as t,i as e,f as v,t as T,v as W,F as B,_ as F,r as C,x as le,w as o,j as k,y as J,z as X,h as L,A as M,g as I,B as R,C as G,D as ne,G as se,H as ie,I as H,q as O,u as re}from"./index.116c829f.js";import{u as z,c as ue}from"./plaque.8894ab7b.js";import{u as Y,c as _e}from"./token-meta.5fa899ef.js";import{u as Z}from"./plaque.ca80324d.js";import{u as ee}from"./account.f835254a.js";import{c as de,T as Q}from"./types.01590581.js";import{u as ce,_ as pe}from"./PlaqueTokenItem.1d4b6816.js";import{s as te}from"./util.65625969.js";import{u as oe}from"./breakpoints.6444b96d.js";import{h as K}from"./firebaseConfig.bef60b65.js";import"./gallery.29f76025.js";const me=t("hr",{class:"hr"},null,-1),fe={class:"card-flex-container"},ve={style:{display:"flex","align-items":"center",margin:"5px 25px 5px 0px"}},ye={style:{flex:"3 1 0%"}},ge={class:"bold"},ke={class:"bold"},he={style:{"margin-right":"35px",opacity:"0.5"}},we=U({__name:"AddTokenItem",props:{in_list:{type:Boolean},token_meta:null},emits:["update_token_list"],setup(u,{emit:d}){const i=u,r=ce(i.token_meta),m=S(()=>de(i.token_meta.entity.platform)),y=S({get(){return i.in_list},set(){d("update_token_list",i.token_meta.id)}});return(V,b)=>{const P=p("el-image"),A=p("el-checkbox");return c(),x(B,null,[me,t("div",fe,[t("div",ve,[e(P,{src:v(r),style:{width:"50px",height:"50px"},fit:"contain"},null,8,["src"])]),t("div",ye,[t("p",ge,T(i.token_meta.entity.name),1),t("p",ke,T(i.token_meta.entity.artist),1)]),t("div",he,T(v(m)),1),e(A,{modelValue:v(y),"onUpdate:modelValue":b[0]||(b[0]=h=>W(y)?y.value=h:null)},null,8,["modelValue"])])],64)}}});const ae=u=>(R("data-v-14f74484"),u=u(),G(),u),qe={class:"dialog-container"},xe={key:0},$e=ae(()=>t("hr",{class:"hr"},null,-1)),Ce={class:"dialog-footer"},be=ae(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Ae=U({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(u,{emit:d}){const i=u,r=C([]),m=C(!1),y=C(""),{screen_type:V}=oe(),b=Z(),P=Y(),A=ee(),h=S({get(){return i.show_add_token_dialog},set(s){d("update:show_add_token_dialog",s)}});le(h,s=>{s&&(r.value=JSON.parse(JSON.stringify(a.value.entity.token_meta_id_list)))});const f=S(()=>P.sorted_all_token_metas),g=S(()=>{const s=[];if(f!=null&&f.value)for(let n of f==null?void 0:f.value)b.meta_in_playlist(i.plaque_id,n.id)?s.unshift(n):s.push(n);return y.value.trim()!==""?s.filter(n=>{var w,q;return((w=n.entity.artist)==null?void 0:w.toLowerCase().includes(y.value.toLowerCase()))||((q=n.entity.name)==null?void 0:q.toLowerCase().includes(y.value.toLowerCase()))}):s}),a=S(()=>b.plaque_map[i.plaque_id]),_=S(()=>{const s={};return r.value.forEach(n=>{s[n]=!0}),s}),E=s=>{r.value.some(n=>n===s)?r.value=r.value.filter(n=>n!=s):r.value.push(s)},$=async()=>{m.value=!0;try{for(let[s,n]of r.value.entries()){const w=P.all_token_metas[n];if(!w)throw"Failed to find store token for token: "+n;if(w.entity.platform!=Q.Opensea)continue;const q=JSON.parse(JSON.stringify(w));q.entity.user_id=A.get_account.id,q.entity.platform=Q.OpenseaArchive;const D=await _e(q.entity);r.value[s]=D.id}await z(i.plaque_id,{token_meta_id_list:r.value}),b.plaque_map[i.plaque_id].entity.token_meta_id_list=r.value}catch(s){te(`Error updating plaque tokens - ${s}`)}m.value=!1,h.value=!1},j=()=>{r.value=[]};return(s,n)=>{const w=p("el-card"),q=p("el-button"),D=p("el-dialog");return c(),x("div",qe,[e(D,{center:"",modelValue:v(h),"onUpdate:modelValue":n[1]||(n[1]=l=>W(h)?h.value=l:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:v(V)=="xs",top:"2vh"},{footer:o(()=>[t("div",Ce,[t("div",null,T(`Artwork in playlist: ${r.value.length}`),1),be,e(q,{onClick:j},{default:o(()=>[k("Clear")]),_:1}),e(q,{type:"info",onClick:$,loading:m.value},{default:o(()=>[k("Save")]),_:1},8,["loading"])])]),default:o(()=>[J(t("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=l=>y.value=l),class:"search-bar",placeholder:"Search by artwork title or artist name"},null,512),[[X,y.value]]),e(w,{class:"box-card",shadow:"never"},{default:o(()=>[v(g).length==0?(c(),x("div",xe,"No artwork found")):L("",!0),(c(!0),x(B,null,M(v(g),l=>(c(),I(we,{token_meta:l,in_list:Boolean(v(_)[l.id]),onUpdate_token_list:E},null,8,["token_meta","in_list"]))),256)),$e]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});var Se=F(Ae,[["__scopeId","data-v-14f74484"]]);const N=u=>(R("data-v-71baf983"),u=u(),G(),u),Pe={style:{display:"flex","align-items":"center",padding:"1em"}},Te={key:0},Ne=N(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Ve={class:"card-simple"},Le=N(()=>t("hr",null,null,-1)),Ie=N(()=>t("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Be=N(()=>t("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ee={style:{padding:"0.3em 1em"}},De={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Oe={key:0,class:"card-detail"},ze={style:{padding:"0 1em"}},Ue={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},je=N(()=>t("hr",null,null,-1)),Je=N(()=>t("div",{style:{padding:"1em"}},"No artwork added",-1)),Fe=N(()=>t("hr",null,null,-1)),Me={style:{display:"flex",padding:"1em"}},Re=N(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Ge={key:0,style:{padding:"1em",display:"flex","justify-content":"space-between"}},He=U({__name:"PlaqueCard",props:{plaque:null},setup(u){const d=u,i=C("simple"),r=C(!1),m=C(!1),y=C(!1),V=async()=>{y.value=!0,await z(d.plaque.id,{name:d.plaque.entity.name}).catch(g=>{te(`Error updating plaque tokens - ${g}`)}),m.value=!1,y.value=!1},b=Y(),P=S(()=>A.value.length==0?null:A.value[0]),A=S(()=>{const g=b.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(_=>g[_])});C("0"),C(!0);const h=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{z(d.plaque.id,{token_meta_id_list:[]}).then(()=>{O({type:"success",message:"Tokens cleared"})}).catch(g=>{O({message:`Error clearing tokens from plaque - ${g}`,type:"error",showClose:!0,duration:12e3})})})},f=()=>{H.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{z(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{O({type:"success",message:"Plaque forgotten"})}).catch(g=>{O({message:`Error forgetting plaque - ${g}`,type:"error",showClose:!0,duration:12e3})})})};return(g,a)=>{const _=p("el-button"),E=p("el-tag"),$=p("el-col"),j=p("el-row"),s=p("ArrowRight"),n=p("el-icon"),w=p("el-collapse-transition"),q=p("Close"),D=p("el-card");return c(),I(D,null,{default:o(()=>[t("div",Pe,[m.value?J((c(),x("input",{key:1,"onUpdate:modelValue":a[0]||(a[0]=l=>d.plaque.entity.name=l),class:"edit-name-input"},null,512)),[[X,d.plaque.entity.name]]):(c(),x("h1",Te,T(d.plaque.entity.name),1)),m.value?L("",!0):(c(),I(_,{key:2,icon:v(ne),onClick:a[1]||(a[1]=l=>m.value=!0),class:"editIcon",circle:""},null,8,["icon"])),m.value?(c(),I(_,{key:3,icon:v(se),loading:y.value,onClick:V,class:"editIcon",circle:"",type:y.value?"":"success",text:""},null,8,["icon","loading","type"])):L("",!0),Ne,e(E,{class:"ml-2",type:"success"},{default:o(()=>[k("online")]),_:1})]),e(w,null,{default:o(()=>[J(t("section",Ve,[Le,e(j,{style:{padding:"1em"}},{default:o(()=>[e($,{span:12},{default:o(()=>{var l;return[Ie,t("span",null,T(((l=v(P))==null?void 0:l.entity.name)||"N/A"),1)]}),_:1}),e($,{span:12},{default:o(()=>{var l;return[Be,k(" "+T(((l=v(P))==null?void 0:l.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),t("div",Ee,T(`Total artworks: ${u.plaque.entity.token_meta_id_list.length}`),1),t("div",De,[e(_,{type:"info",onClick:a[2]||(a[2]=l=>r.value=!0)},{default:o(()=>[k("Add Artwork")]),_:1}),e(_,{onClick:a[3]||(a[3]=l=>i.value="detail")},{default:o(()=>[k(" Details"),e(n,{class:"el-icon--right"},{default:o(()=>[e(s)]),_:1})]),_:1})])],512),[[ie,i.value=="simple"]])]),_:1}),e(w,null,{default:o(()=>[i.value=="detail"?(c(),x("section",Oe,[t("p",ze,T(`Total artworks: ${u.plaque.entity.token_meta_id_list.length}`),1),t("div",Ue,[e(_,{onClick:a[4]||(a[4]=l=>i.value="settings")},{default:o(()=>[k("Settings")]),_:1}),e(_,{onClick:h},{default:o(()=>[k("Clear Artwork")]),_:1})]),je,v(A).length==0?(c(),x(B,{key:0},[Je,Fe],64)):L("",!0),(c(!0),x(B,null,M(v(A),l=>(c(),I(pe,{token_meta:l},null,8,["token_meta"]))),256)),t("div",Me,[e(_,{type:"info",onClick:a[5]||(a[5]=l=>r.value=!0)},{default:o(()=>[k("Add Artwork")]),_:1}),Re,e(_,{onClick:a[6]||(a[6]=l=>i.value="simple")},{default:o(()=>[k("Close"),e(n,{class:"el-icon--right"},{default:o(()=>[e(q)]),_:1})]),_:1})])])):L("",!0)]),_:1}),e(w,null,{default:o(()=>[i.value=="settings"?(c(),x("section",Ge,[e(_,{type:"danger",plain:"",onClick:f},{default:o(()=>[k("Forget Display")]),_:1}),e(_,{onClick:a[7]||(a[7]=l=>i.value="detail")},{default:o(()=>[k("Close"),e(n,{class:"el-icon--right"},{default:o(()=>[e(q)]),_:1})]),_:1})])):L("",!0)]),_:1}),e(Se,{plaque_id:d.plaque.id,show_add_token_dialog:r.value,"onUpdate:show_add_token_dialog":a[8]||(a[8]=l=>r.value=l)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Qe=F(He,[["__scopeId","data-v-71baf983"]]);const Ke=u=>(R("data-v-684951ec"),u=u(),G(),u),We={class:"add-button-container"},Xe={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ye=Ke(()=>t("div",{style:{"font-size":"17px"}},"Add plaque",-1)),Ze={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},et=U({__name:"PlaqueList",setup(u){const d=C(!1),{width:i,screen_type:r}=oe(),m=C(!1),y=re(),V=ee(),b=Z(),P=async()=>{d.value=!0,await ue({name:"Test Plaque",user_id:V.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(h=>O({message:`Error creating test plaque- ${h}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,m.value=!1},A=S(()=>JSON.parse(JSON.stringify(b.all_plaque_list)).sort((f,g)=>{const a=f.entity.name.toLowerCase(),_=g.entity.name.toLowerCase();return a<_?-1:a>_?1:0}));return(h,f)=>{const g=p("Plus"),a=p("el-icon"),_=p("el-button"),E=p("el-dialog");return c(),x(B,null,[(c(!0),x(B,null,M(v(A),$=>(c(),I(Qe,{plaque:$,key:$.id},null,8,["plaque"]))),128)),t("div",We,[t("div",Xe,[t("div",{class:"add-button",onClick:f[0]||(f[0]=$=>m.value=!0)},[e(a,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[e(g)]),_:1}),Ye])])]),e(E,{modelValue:m.value,"onUpdate:modelValue":f[2]||(f[2]=$=>m.value=$),title:"Add plaque",width:v(r)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[t("div",Ze,[e(_,{onClick:f[1]||(f[1]=$=>{v(y).push("qr-scan"),m.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[k("Scan Plaque QR Code")]),_:1}),e(_,{icon:"plus",onClick:P,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[k("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var ct=F(et,[["__scopeId","data-v-684951ec"]]);export{ct as default};
