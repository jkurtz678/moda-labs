import{u as T}from"./gallery.47a243a3.js";import{T as k,e as I}from"./types.e0f521c1.js";import{u as M}from"./plaque.9298282e.js";import{d as O,r as v,B as f,c as h,P as E,a as A,w as i,_ as j,f as y,o as S,i as a,j as z,h as q,J as G,u as J,F as C,g as $,p as H,m as K,l as g}from"./index.80dff49d.js";const b=p=>(H("data-v-120011e1"),p=p(),K(),p),Q=b(()=>g("div",{class:"caption"},"Filter by gallery",-1)),R=b(()=>g("div",{class:"caption"},"Filter by aspect ratio",-1)),W=b(()=>g("div",{class:"caption"},"Filter by platform",-1)),X=b(()=>g("div",{class:"caption"},"Filter by downloaded",-1)),Y=b(()=>g("div",{class:"caption"},"Sort order",-1)),Z=O({__name:"ArtworkFilters",props:{all_tokens:{},search_filter:{},use_local_storage:{type:Boolean},plaque_id:{}},emits:["update-filtered-tokens"],setup(p,{emit:B}){const r=p,F=T(),x=M(),L=B,_=v("");f(_,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_aspect_ratio_filter",t)});const n=v("");f(n,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_gallery",t)});const d=v("");f(d,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_platform",t)});const u=v("");f(u,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_downloaded",t)});const c=v("created_at");f(c,t=>{r.use_local_storage&&localStorage.setItem("artwork_grid_sort_order",t)});const V=h(()=>r.plaque_id?x.plaque_media_map[r.plaque_id]:null);E(()=>{r.use_local_storage&&(_.value=localStorage.getItem("artwork_grid_aspect_ratio_filter")||"",n.value=localStorage.getItem("artwork_grid_filter_by_gallery")||"",d.value=localStorage.getItem("artwork_grid_filter_by_platform")||"",u.value=localStorage.getItem("artwork_grid_filter_by_downloaded")||"",c.value=localStorage.getItem("artwork_grid_sort_order")||"name")});const N=h(()=>_.value||n.value||d.value||u.value),U=h(()=>{const t=new Set;return n.value&&F.gallery_token_meta_list.forEach(e=>{e.entity.gallery_id==n.value&&t.add(e.entity.token_meta_id)}),console.log("ret set ",t),t}),D=h(()=>{if(!r.all_tokens)return[];let t=r.all_tokens.filter(e=>{var s,w;if(r.search_filter&&!((s=e.entity.artist)!=null&&s.toLowerCase().includes(r.search_filter.toLowerCase()))&&!((w=e.entity.name)!=null&&w.toLowerCase().includes(r.search_filter.toLowerCase()))||n.value&&!U.value.has(e.id))return!1;switch(d.value){case"moda_archive":if(e.entity.platform!=k.Archive)return!1;break;case"opensea":if(e.entity.platform!=k.Opensea&&e.entity.platform!=k.OpenseaArchive)return!1;break;case"archive_demo":if(e.entity.platform!=k.ArchiveDemo)return!1;break}if(V.value)switch(u.value){case"downloaded":if(!V.value[I(e)])return!1;break;case"not_downloaded":if(V.value[I(e)])return!1}switch(_.value){case"portrait":if(!e.entity.aspect_ratio||e.entity.aspect_ratio>.9)return!1;break;case"landscape":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<1.1)return!1;break;case"square":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<.9||e.entity.aspect_ratio>1.1)return!1;break}return!0});return c.value==="name"?t=t.sort((e,s)=>e.entity.name.localeCompare(s.entity.name)):c.value==="created_at"&&(t=t.sort((e,s)=>e.entity.created_at==null&&s.entity.created_at==null?0:e.entity.created_at==null?1:s.entity.created_at==null?-1:s.entity.created_at.seconds-e.entity.created_at.seconds)),t});return f(D,t=>{L("update-filtered-tokens",t)},{immediate:!0}),(t,e)=>{const s=y("el-button"),w=y("el-badge"),l=y("el-option"),m=y("el-select"),P=y("el-popover");return S(),A(P,{placement:"bottom",title:"Artwork Filters",width:300,trigger:"click"},{reference:i(()=>[a(w,{"is-dot":"",hidden:!N.value},{default:i(()=>[a(s,{icon:"Filter",style:{"margin-left":"10px"},type:"info",size:"small"},{default:i(()=>[z("Filters")]),_:1})]),_:1},8,["hidden"])]),default:i(()=>[Q,a(m,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),placeholder:"Filter by gallery",class:"filter-select"},{default:i(()=>[a(l,{label:"All artwork",value:""}),(S(!0),q(C,null,G(J(F).gallery_list,o=>(S(),A(l,{key:o.id,label:`${o.entity.name}`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),R,a(m,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=o=>_.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Landscape",value:"landscape"}),a(l,{label:"Portrait",value:"portrait"}),a(l,{label:"Square",value:"square"})]),_:1},8,["modelValue"]),W,a(m,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Moda Archive",value:"moda_archive"}),a(l,{label:"Opensea",value:"opensea"}),a(l,{label:"Demo",value:"archive_demo"})]),_:1},8,["modelValue"]),t.plaque_id?(S(),q(C,{key:0},[X,a(m,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=o=>u.value=o),class:"filter-select"},{default:i(()=>[a(l,{label:"All",value:""}),a(l,{label:"Downloaded",value:"downloaded"}),a(l,{label:"Not Downloaded",value:"not_downloaded"})]),_:1},8,["modelValue"])],64)):$("",!0),Y,a(m,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=o=>c.value=o),placeholder:"Sort by",class:"filter-select"},{default:i(()=>[a(l,{label:"Sort by name",value:"name"}),a(l,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"])]),_:1})}}});var re=j(Z,[["__scopeId","data-v-120011e1"]]);export{re as A};
