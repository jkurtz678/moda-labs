import{d as O,c as P,r as c,o as r,b as q,i as e,h as t,e as m,t as S,F as B,_ as R,k as x,v as se,w as o,x as M,y as W,g as I,z as F,f as L,A as ne,B as J,C as G,j as h,D as ae,G as le,H as ie,I as H,p as j,u as _e}from"./index.29d45cde.js";import{u as D,c as de}from"./plaque.a677a453.js";import{c as ue}from"./token-meta.4d8e4ad6.js";import{u as X}from"./plaque.44a8709d.js";import{i as re,j as ce,u as Y,T as Q,s as Z,m as K}from"./account.653f6167.js";import{u as ee,a as te}from"./token-meta.8026a0fc.js";import{_ as pe}from"./PlaqueTokenItem.76ec60ff.js";const me=e("hr",{class:"hr"},null,-1),fe={class:"card-flex-container"},ve={style:{display:"flex","align-items":"center",margin:"5px 25px 5px 0px"}},ye={style:{flex:"3 1 0%"}},ge={class:"bold"},he={class:"bold"},ke={style:{"margin-right":"35px",opacity:"0.5"}},we=O({props:{in_list:{type:Boolean},token_meta:null},emits:["update_token_list"],setup(a,{emit:_}){const d=a,u=P(()=>re(d.token_meta.entity.platform));return(p,f)=>{const V=c("el-image"),T=c("el-button");return r(),q(B,null,[me,e("div",fe,[e("div",ve,[t(V,{src:m(ce)(d.token_meta),style:{width:"50px",height:"50px"},fit:"contain"},null,8,["src"])]),e("div",ye,[e("p",ge,S(d.token_meta.entity.name),1),e("p",he,S(d.token_meta.entity.artist),1)]),e("div",ke,S(m(u)),1),t(T,{icon:a.in_list?"close":"plus",type:a.in_list?"danger":"success",plain:"",circle:"",onClick:f[0]||(f[0]=A=>_("update_token_list",d.token_meta.id))},null,8,["icon","type"])])],64)}}});const oe=a=>(J("data-v-5683b08c"),a=a(),G(),a),qe={class:"dialog-container"},xe={key:0},$e=oe(()=>e("hr",{class:"hr"},null,-1)),Ce={class:"dialog-footer"},be=oe(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),Se=h("Clear"),Te=h("Save"),Ae=O({props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(a,{emit:_}){const d=a,u=x([]),p=x(!1),f=x(""),{screen_type:V}=ee(),T=X(),A=te(),b=Y(),y=P({get(){return d.show_add_token_dialog},set(i){_("update:show_add_token_dialog",i)}});se(y,i=>{i&&(u.value=JSON.parse(JSON.stringify(l.value.entity.token_meta_id_list)))});const $=P(()=>Object.values(A.all_token_metas)),g=P(()=>{const i=[];if($!=null&&$.value)for(let s of $==null?void 0:$.value)T.meta_in_playlist(d.plaque_id,s.id)?i.unshift(s):i.push(s);return f.value.trim()!==""?i.filter(s=>{var k,w;return((k=s.entity.artist)==null?void 0:k.toLowerCase().includes(f.value.toLowerCase()))||((w=s.entity.name)==null?void 0:w.toLowerCase().includes(f.value.toLowerCase()))}):i}),l=P(()=>T.plaque_map[d.plaque_id]),v=P(()=>{const i={};return u.value.forEach(s=>{i[s]=!0}),i}),C=i=>{u.value.some(s=>s===i)?u.value=u.value.filter(s=>s!=i):u.value.push(i)},z=async()=>{p.value=!0;try{for(let[i,s]of u.value.entries()){const k=A.all_token_metas[s];if(!k)throw"Failed to find store token for token: "+s;if(k.entity.platform!=Q.Opensea)continue;const w=JSON.parse(JSON.stringify(k));w.entity.wallet_address=b.get_account.entity.wallet_address,w.entity.platform=Q.OpenseaArchive;const E=await ue(w.entity);u.value[i]=E.id}await D(d.plaque_id,{token_meta_id_list:u.value})}catch(i){Z(`Error updating plaque tokens - ${i}`)}p.value=!1,y.value=!1},U=()=>{u.value=[]};return(i,s)=>{const k=c("el-card"),w=c("el-button"),E=c("el-dialog");return r(),q("div",qe,[t(E,{center:"",modelValue:m(y),"onUpdate:modelValue":s[1]||(s[1]=n=>ne(y)?y.value=n:null),title:"Add tokens to plaque","close-on-click-modal":!1,fullscreen:m(V)=="xs"},{footer:o(()=>[e("span",Ce,[e("div",null,S(`Tokens in playlist: ${u.value.length}`),1),be,t(w,{onClick:U},{default:o(()=>[Se]),_:1}),t(w,{type:"info",onClick:z,loading:p.value},{default:o(()=>[Te]),_:1},8,["loading"])])]),default:o(()=>[M(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>f.value=n),class:"search-bar",placeholder:"Search by artwork title or artist name"},null,512),[[W,f.value]]),t(k,{class:"box-card",shadow:"never"},{default:o(()=>[m(g).length==0?(r(),q("div",xe,"No tokens found")):I("",!0),(r(!0),q(B,null,F(m(g),n=>(r(),L(we,{token_meta:n,in_list:Boolean(m(v)[n.id]),onUpdate_token_list:C},null,8,["token_meta","in_list"]))),256)),$e]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});var Pe=R(Ae,[["__scopeId","data-v-5683b08c"]]);const N=a=>(J("data-v-2285ddc0"),a=a(),G(),a),Ne={style:{display:"flex","align-items":"center",padding:"1em"}},Ve={key:0},Ie=N(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),Le=h("online"),Be={class:"card-simple"},Ee=N(()=>e("hr",null,null,-1)),je=N(()=>e("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),ze=N(()=>e("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),De={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em"}},Oe={style:{padding:"1em"}},Ue=h(" View "),Me={key:0,class:"card-detail"},Re={style:{padding:"0 1em"}},Fe={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Je=h("Settings"),Ge=h("Add Artwork"),He=N(()=>e("hr",null,null,-1)),Qe=N(()=>e("div",{style:{padding:"1em"}}," No tokens added",-1)),Ke=N(()=>e("hr",null,null,-1)),We={style:{display:"flex",padding:"1em"}},Xe=h("Clear Tokens"),Ye=N(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),Ze=h("Close"),et={key:0,style:{padding:"1em",display:"flex","justify-content":"space-between"}},tt=h("Forget Display"),ot=h("Close"),st=O({props:{plaque:null},setup(a){const _=a,d=x("simple"),u=x(!1),p=x(!1),f=x(!1),V=async()=>{f.value=!0,await D(_.plaque.id,{name:_.plaque.entity.name}).catch(g=>{Z(`Error updating plaque tokens - ${g}`)}),p.value=!1,f.value=!1},T=te(),A=P(()=>b.value.length==0?null:b.value[0]),b=P(()=>{const g=T.archive_token_meta_map;return _.plaque.entity.token_meta_id_list.map(v=>g[v])});x("0"),x(!0);const y=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${_.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{D(_.plaque.id,{token_meta_id_list:[]}).then(()=>{j({type:"success",message:"Tokens cleared"})}).catch(g=>{j({message:`Error clearing tokens from plaque - ${g}`,type:"error",showClose:!0,duration:12e3})})})},$=()=>{H.confirm(`Are you sure you want to forget the plaque named '${_.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{D(_.plaque.id,{wallet_address:"",token_meta_id_list:[]}).then(()=>{j({type:"success",message:"Plaque forgotten"})}).catch(g=>{j({message:`Error forgetting plaque - ${g}`,type:"error",showClose:!0,duration:12e3})})})};return(g,l)=>{const v=c("el-button"),C=c("el-tag"),z=c("el-col"),U=c("el-row"),i=c("ArrowRight"),s=c("el-icon"),k=c("el-collapse-transition"),w=c("Close"),E=c("el-card");return r(),L(E,null,{default:o(()=>[e("div",Ne,[p.value?M((r(),q("input",{key:1,"onUpdate:modelValue":l[0]||(l[0]=n=>_.plaque.entity.name=n),class:"edit-name-input"},null,512)),[[W,_.plaque.entity.name]]):(r(),q("h1",Ve,S(_.plaque.entity.name),1)),p.value?I("",!0):(r(),L(v,{key:2,icon:m(ae),onClick:l[1]||(l[1]=n=>p.value=!0),class:"editIcon",circle:""},null,8,["icon"])),p.value?(r(),L(v,{key:3,icon:m(le),loading:f.value,onClick:V,class:"editIcon",circle:"",type:f.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),Ie,t(C,{class:"ml-2",type:"success"},{default:o(()=>[Le]),_:1})]),t(k,null,{default:o(()=>[M(e("section",Be,[Ee,t(U,{style:{"margin-bottom":"8px",padding:"1em"}},{default:o(()=>[t(z,{span:12},{default:o(()=>{var n;return[je,e("span",null,S(((n=m(A))==null?void 0:n.entity.name)||"N/A"),1)]}),_:1}),t(z,{span:12},{default:o(()=>{var n;return[ze,h(" "+S(((n=m(A))==null?void 0:n.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),e("div",De,[e("div",Oe,S(`Total artworks: ${a.plaque.entity.token_meta_id_list.length}`),1),t(v,{onClick:l[2]||(l[2]=n=>d.value="detail")},{default:o(()=>[Ue,t(s,{class:"el-icon--right"},{default:o(()=>[t(i)]),_:1})]),_:1})])],512),[[ie,d.value=="simple"]])]),_:1}),t(k,null,{default:o(()=>[d.value=="detail"?(r(),q("section",Me,[e("p",Re,S(`Total artworks: ${a.plaque.entity.token_meta_id_list.length}`),1),e("div",Fe,[t(v,{onClick:l[3]||(l[3]=n=>d.value="settings")},{default:o(()=>[Je]),_:1}),t(v,{type:"info",onClick:l[4]||(l[4]=n=>u.value=!0)},{default:o(()=>[Ge]),_:1})]),He,m(b).length==0?(r(),q(B,{key:0},[Qe,Ke],64)):I("",!0),(r(!0),q(B,null,F(m(b),n=>(r(),L(pe,{token_meta:n},null,8,["token_meta"]))),256)),e("div",We,[t(v,{onClick:y},{default:o(()=>[Xe]),_:1}),Ye,t(v,{onClick:l[5]||(l[5]=n=>d.value="simple")},{default:o(()=>[Ze,t(s,{class:"el-icon--right"},{default:o(()=>[t(w)]),_:1})]),_:1})])])):I("",!0)]),_:1}),t(k,null,{default:o(()=>[d.value=="settings"?(r(),q("section",et,[t(v,{type:"danger",plain:"",onClick:$},{default:o(()=>[tt]),_:1}),t(v,{onClick:l[6]||(l[6]=n=>d.value="detail")},{default:o(()=>[ot,t(s,{class:"el-icon--right"},{default:o(()=>[t(w)]),_:1})]),_:1})])):I("",!0)]),_:1}),t(Pe,{plaque_id:_.plaque.id,show_add_token_dialog:u.value,"onUpdate:show_add_token_dialog":l[7]||(l[7]=n=>u.value=n)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var nt=R(st,[["__scopeId","data-v-2285ddc0"]]);const at=a=>(J("data-v-4c8baa0e"),a=a(),G(),a),lt={class:"add-button-container"},it={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},_t=at(()=>e("div",{style:{"font-size":"17px"}},"Add plaque",-1)),dt={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},ut=h("Scan Plaque QR Code"),rt=h("Add test plaque "),ct=O({setup(a){const _=x(!1),{width:d,screen_type:u}=ee(),p=x(!1),f=_e(),V=Y(),T=X(),A=async()=>{_.value=!0,await de({name:"Test Plaque",wallet_address:V.get_account.entity.wallet_address,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(b=>j({message:`Error creating test plaque- ${b}`,type:"error",showClose:!0,duration:12e3})),_.value=!1,p.value=!1};return(b,y)=>{const $=c("Plus"),g=c("el-icon"),l=c("el-button"),v=c("el-dialog");return r(),q(B,null,[(r(!0),q(B,null,F(m(T).plaques,C=>(r(),L(nt,{plaque:C,key:C.id},null,8,["plaque"]))),128)),e("div",lt,[e("div",it,[e("div",{class:"add-button",onClick:y[0]||(y[0]=C=>p.value=!0)},[t(g,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[t($)]),_:1}),_t])])]),t(v,{modelValue:p.value,"onUpdate:modelValue":y[2]||(y[2]=C=>p.value=C),title:"Add plaque",width:m(u)=="xs"?"90%":"50%"},{default:o(()=>[e("div",dt,[t(l,{onClick:y[1]||(y[1]=C=>{m(f).push("qr-scan"),p.value=!1}),icon:"camera",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[ut]),_:1}),t(l,{icon:"plus",onClick:A,loading:_.value,style:{margin:"10px 0px 10px 0px"}},{default:o(()=>[rt]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var kt=R(ct,[["__scopeId","data-v-4c8baa0e"]]);export{kt as default};
