import{_ as O,d as J,r as A,c as T,v as se,b as p,o as r,e as k,i as e,w as l,k as a,t as N,j as _,f,x as ie,y as U,z as F,u as W,g as I,A as G,B as de,C as ue,h as V,D as re,G as _e,F as j,H as X,I as H,q as E,J as ce}from"./index.7da2a13d.js";import{u as L,c as pe}from"./plaque.39965a3b.js";import{c as me}from"./token-meta.c2748717.js";import{u as M}from"./plaque.d9c1e390.js";import{u as Y}from"./account.c0fe71f5.js";import{s as Z}from"./util.646c9d85.js";import{T as Q}from"./types.6a5ef88e.js";import{u as ee}from"./breakpoints.8bdebfe0.js";import{u as te}from"./token-meta.ce357c9c.js";import{_ as fe}from"./TokenSelectList.41829435.js";import{_ as ve}from"./PlaqueTokenItem.135f991c.js";import{n as K}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.5abb9e4c.js";import"./thumbnail-image.9b00075a.js";const ye=s=>(U("data-v-cc2989e6"),s=s(),F(),s),ge={class:"dialog-container"},ke={class:"dialog-footer"},qe=ye(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),we=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(s,{emit:i}){const w=s,v=A([]),u=A(!1),{screen_type:h}=ee(),q=M(),y=te(),D=Y(),x=T({get(){return w.show_add_token_dialog},set(m){i("update:show_add_token_dialog",m)}});se(x,m=>{m&&(v.value=JSON.parse(JSON.stringify(b.value.entity.token_meta_id_list)))});const b=T(()=>q.plaque_map[w.plaque_id]),S=T(()=>y.sorted_all_token_metas),C=async()=>{u.value=!0;try{for(let[m,o]of v.value.entries()){const t=y.all_token_metas[o];if(!t)throw"Failed to find store token for token: "+o;if(t.entity.platform!=Q.Opensea)continue;const n=JSON.parse(JSON.stringify(t));n.entity.user_id=D.get_account.id,n.entity.platform=Q.OpenseaArchive;const $=await me(n.entity);v.value[m]=$.id}await L(w.plaque_id,{token_meta_id_list:v.value}),q.plaque_map[w.plaque_id].entity.token_meta_id_list=v.value}catch(m){Z(`Error updating plaque tokens - ${m}`)}u.value=!1,x.value=!1},c=()=>{v.value=[]};return(m,o)=>{const t=p("el-button"),n=p("el-dialog");return r(),k("div",ge,[e(n,{center:"",modelValue:f(x),"onUpdate:modelValue":o[1]||(o[1]=$=>ie(x)?x.value=$:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:f(h)=="xs",top:"2vh"},{footer:l(()=>[a("div",ke,[a("div",null,N(`Artwork in playlist: ${v.value.length}`),1),qe,e(t,{onClick:c},{default:l(()=>[_("Clear")]),_:1}),e(t,{type:"info",onClick:C,loading:u.value},{default:l(()=>[_("Save")]),_:1},8,["loading"])])]),default:l(()=>[e(fe,{selected_token_meta_id_list:v.value,"onUpdate:selected_token_meta_id_list":o[0]||(o[0]=$=>v.value=$),token_meta_list:f(S)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var he=O(we,[["__scopeId","data-v-cc2989e6"]]);const P=s=>(U("data-v-45b70c94"),s=s(),F(),s),xe={style:{display:"flex","align-items":"center",padding:"1em"}},Ce={key:0},$e=P(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Ae={class:"card-simple"},Pe=P(()=>a("hr",null,null,-1)),Se=P(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),be=P(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ne={style:{padding:"0.3em 1em"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Ve={key:0,class:"card-detail"},Ie={style:{padding:"0 1em"}},De={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ee=P(()=>a("hr",null,null,-1)),Le=P(()=>a("div",{style:{padding:"1em"}},"No artwork added",-1)),je=P(()=>a("hr",null,null,-1)),ze={style:{display:"flex",padding:"1em"}},Be=P(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Oe={key:0,style:{padding:"1em"}},Je={style:{display:"flex","justify-content":"space-between"}},Ue={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Fe={key:0},Me=P(()=>a("div",null,"Associated User ID:",-1)),Re={key:1},Ge={style:{display:"flex","justify-content":"end"}},He=J({__name:"PlaqueCard",props:{plaque:null},setup(s){const i=s,w=M(),v=W(),u=A("simple"),h=A(!1),q=A(!1),y=A(!1),D=async()=>{y.value=!0,await L(i.plaque.id,{name:i.plaque.entity.name}).catch(o=>{Z(`Error updating plaque tokens - ${o}`)}),q.value=!1,y.value=!1},x=te(),b=T(()=>S.value.length==0?null:S.value[0]),S=T(()=>{const o=x.archive_token_meta_map;return i.plaque.entity.token_meta_id_list.map(n=>o[n])}),C=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${i.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{L(i.plaque.id,{token_meta_id_list:[]}).then(()=>{w.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Tokens cleared"})}).catch(o=>{E({message:`Error clearing tokens from plaque - ${o}`,type:"error",showClose:!0,duration:12e3})})})},c=()=>{H.confirm(`Are you sure you want to forget the plaque named '${i.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{L(i.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{w.plaque_map[i.plaque.id].entity.user_id="",w.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Plaque forgotten"})}).catch(o=>{E({message:`Error forgetting plaque - ${o}`,type:"error",showClose:!0,duration:12e3})})})},m=()=>{const o=v.resolve({name:"preview-plaque",params:{plaque_id:i.plaque.id}});window.open(o.href)};return(o,t)=>{const n=p("el-button"),$=p("el-tag"),g=p("el-col"),le=p("el-row"),oe=p("ArrowRight"),z=p("el-icon"),B=p("el-collapse-transition"),R=p("Close"),ne=p("el-card");return r(),I(ne,null,{default:l(()=>[a("div",xe,[q.value?G((r(),k("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=d=>i.plaque.entity.name=d),class:"edit-name-input"},null,512)),[[de,i.plaque.entity.name]]):(r(),k("h1",Ce,N(i.plaque.entity.name),1)),q.value?V("",!0):(r(),I(n,{key:2,icon:f(ue),onClick:t[1]||(t[1]=d=>q.value=!0),class:"editIcon",circle:""},null,8,["icon"])),q.value?(r(),I(n,{key:3,icon:f(re),loading:y.value,onClick:D,class:"editIcon",circle:"",type:y.value?"":"success",text:""},null,8,["icon","loading","type"])):V("",!0),$e,e($,{class:"ml-2",type:"success"},{default:l(()=>[_("online")]),_:1})]),e(B,null,{default:l(()=>[G(a("section",Ae,[Pe,e(le,{style:{padding:"1em"}},{default:l(()=>[e(g,{span:12},{default:l(()=>{var d;return[Se,a("span",null,N(((d=f(b))==null?void 0:d.entity.name)||"N/A"),1)]}),_:1}),e(g,{span:12},{default:l(()=>{var d;return[be,_(" "+N(((d=f(b))==null?void 0:d.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),a("div",Ne,N(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),a("div",Te,[e(n,{type:"info",onClick:t[2]||(t[2]=d=>h.value=!0)},{default:l(()=>[_("Add Artwork")]),_:1}),e(n,{onClick:t[3]||(t[3]=d=>u.value="detail")},{default:l(()=>[_(" Details"),e(z,{class:"el-icon--right"},{default:l(()=>[e(oe)]),_:1})]),_:1})])],512),[[_e,u.value=="simple"]])]),_:1}),e(B,null,{default:l(()=>[u.value=="detail"?(r(),k("section",Ve,[a("p",Ie,N(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),a("div",De,[e(n,{onClick:t[4]||(t[4]=d=>u.value="settings")},{default:l(()=>[_("Settings")]),_:1}),e(n,{onClick:C},{default:l(()=>[_("Clear Artwork")]),_:1})]),Ee,f(S).length==0?(r(),k(j,{key:0},[Le,je],64)):V("",!0),(r(!0),k(j,null,X(f(S),d=>(r(),I(ve,{token_meta:d},null,8,["token_meta"]))),256)),a("div",ze,[e(n,{type:"info",onClick:t[5]||(t[5]=d=>h.value=!0)},{default:l(()=>[_("Add Artwork")]),_:1}),Be,e(n,{onClick:t[6]||(t[6]=d=>u.value="simple")},{default:l(()=>[_("Close"),e(z,{class:"el-icon--right"},{default:l(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(B,null,{default:l(()=>[u.value=="settings"?(r(),k("section",Oe,[a("div",Je,[e(n,null,{default:l(()=>[_("Preview Art")]),_:1}),e(n,{onClick:m},{default:l(()=>[_("Preview Plaque")]),_:1})]),a("div",Ue,[s.plaque.entity.user_id?(r(),k("div",Fe,[Me,a("div",null,N(s.plaque.entity.user_id),1)])):(r(),k("div",Re,"No associated user")),s.plaque.entity.user_id?(r(),I(n,{key:2,type:"danger",plain:"",onClick:c},{default:l(()=>[_("Forget Display")]),_:1})):V("",!0)]),a("div",Ge,[e(n,{onClick:t[7]||(t[7]=d=>u.value="detail")},{default:l(()=>[_("Close"),e(z,{class:"el-icon--right"},{default:l(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(he,{plaque_id:i.plaque.id,show_add_token_dialog:h.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=d=>h.value=d)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Qe=O(He,[["__scopeId","data-v-45b70c94"]]);const ae=s=>(U("data-v-4a1aeca1"),s=s(),F(),s),Ke={class:"subheader",style:{display:"flex","align-items":"center"}},We=ae(()=>a("div",{style:{"padding-bottom":"40px"}},null,-1)),Xe={class:"add-button-container"},Ye={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ze=ae(()=>a("div",{style:{"font-size":"17px"}},"Add plaque",-1)),et={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},tt=J({__name:"PlaqueList",setup(s){const i=A(!1),{width:w,screen_type:v}=ee(),u=A(!1),h=W(),q=Y(),y=A(""),D=M(),x=async()=>{i.value=!0,await pe({name:"Test Plaque",user_id:q.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(C=>E({message:`Error creating test plaque- ${C}`,type:"error",showClose:!0,duration:12e3})),i.value=!1,u.value=!1},b=T(()=>JSON.parse(JSON.stringify(D.all_plaque_list)).sort((c,m)=>{const o=c.entity.name.toLowerCase(),t=m.entity.name.toLowerCase();return o<t?-1:o>t?1:0})),S=T(()=>y?b.value.filter(C=>C.entity.name.toLowerCase().includes(y.value.toLowerCase())):b.value);return(C,c)=>{const m=p("el-input"),o=p("el-button"),t=p("Plus"),n=p("el-icon"),$=p("el-dialog");return r(),k(j,null,[a("div",Ke,[e(m,{modelValue:y.value,"onUpdate:modelValue":c[0]||(c[0]=g=>y.value=g),"prefix-icon":f(ce),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),e(o,{icon:"Camera",type:"info",onClick:c[1]||(c[1]=g=>f(h).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:l(()=>[_("Scan")]),_:1})]),We,(r(!0),k(j,null,X(f(S),g=>(r(),I(Qe,{plaque:g,key:g.id},null,8,["plaque"]))),128)),a("div",Xe,[a("div",Ye,[a("div",{class:"add-button",onClick:c[2]||(c[2]=g=>u.value=!0)},[e(n,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:l(()=>[e(t)]),_:1}),Ze])])]),e($,{modelValue:u.value,"onUpdate:modelValue":c[4]||(c[4]=g=>u.value=g),title:"Add plaque",width:f(v)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:l(()=>[a("div",et,[e(o,{onClick:c[3]||(c[3]=g=>{f(h).push("qr-scan"),u.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:l(()=>[_("Scan Plaque QR Code")]),_:1}),e(o,{icon:"plus",onClick:x,loading:i.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:l(()=>[_("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var vt=O(tt,[["__scopeId","data-v-4a1aeca1"]]);export{vt as default};
