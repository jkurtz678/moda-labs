import{_ as G,a as T,b as H,c as M}from"./search-icon.301e062d.js";import{d as N,u as S,a as L,r as C,c as U,b as m,o as r,e as k,f as s,g as q,h as b,F as A,i as n,w as d,j as v,t as F,k as P,_ as I,l as j,E,R as z}from"./index.b3fa10bc.js";import{u as R}from"./account.bc3fd2aa.js";import{u as O}from"./breakpoints.adca0f39.js";import{s as J,a as B,o as K}from"./firebaseConfig.d7a6b5a9.js";import{s as _}from"./util.a450f6a6.js";import{u as Q}from"./plaque.307f53b5.js";import{u as W}from"./token-meta.291cfb3a.js";import{u as X}from"./plaque.a28f3552.js";import{u as Y}from"./gallery.6a81436c.js";import"./types.ab61d3d9.js";import"./token-meta.5c286770.js";const Z={style:{display:"flex","align-items":"center"}},ee=P("div",{style:{"flex-grow":"1"}},null,-1),te=P("div",{style:{"flex-grow":"1"}},null,-1),ae={key:0,style:{"margin-right":"10px"}},oe=N({__name:"Header",setup(D){const i=S(),p=L(),f=R(),c=C(!1),{width:V,screen_type:y}=O(),g=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&i.push({name:e.paneName})},w=U(()=>{const e=f.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),x=()=>{c.value=!0,J(B).then(()=>{}).catch(e=>{_(e)}).finally(()=>{c.value=!1})},o=e=>new URL({"../assets/base.css":G,"../assets/logo.png":T,"../assets/logo.svg":H,"../assets/search-icon.svg":M}[`../assets/${e}`],self.location).href;return(e,t)=>{const h=m("el-image"),u=m("el-button"),l=m("el-tab-pane"),a=m("el-tabs");return r(),k("div",Z,[s(y)!="xs"?(r(),q(h,{key:0,src:o("logo.png"),style:{width:"43px",height:"43px","margin-right":"2em"}},null,8,["src"])):b("",!0),s(i).currentRoute.value.name=="qr-scan"?(r(),k(A,{key:1},[ee,n(u,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=$=>s(i).push("plaque-list"))},{default:d(()=>[v(" Cancel ")]),_:1})],64)):(r(),k(A,{key:2},[n(a,{modelValue:s(p).name,"onUpdate:modelValue":t[1]||(t[1]=$=>s(p).name=$),onTabClick:g},{default:d(()=>[n(l,{label:"Plaques",name:"plaque-list"}),n(l,{label:"Artwork",name:"token-list"}),n(l,{label:"Galleries",name:"gallery-list"})]),_:1},8,["modelValue"]),te,s(y)!="xs"?(r(),k("div",ae,[v(F(s(w)),1),s(f).is_user_admin?(r(),q(u,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:d(()=>[v("Admin")]),_:1})):b("",!0)])):b("",!0),n(u,{onClick:x,style:{"margin-left":"1em"},loading:c.value},{default:d(()=>[v("Logout")]),_:1},8,["loading"])],64))])}}});const se=N({__name:"HomeView",setup(D){const i=R(),p=Q(),f=W(),c=Y(),V=S(),y=C(!1),g=C(),w=L();j(async()=>{g.value=E.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),K(B,async o=>{console.log("onAuthStateChanged",o),o?(g.value=E.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await x(o.uid),g.value.close()):(i.setAccount(null),g.value.close(),V.push({name:"login",query:{redir:window.location.href}}))})});async function x(o){await i.loadAccount(o),await c.loadGalleryList(o).catch(a=>_(`Error loading galleries - ${a}`));const e=p.loadPlaques(o).catch(a=>_(`Error loading plaques - ${a}`)),t=p.loadGalleryPlaques(c.gallery_list).catch(a=>_(`Error loading gallery plaques - ${a}`)),h=f.loadArchiveTokenMetas(o).catch(a=>_(`Error loading archive token metas - ${a}`)),u=f.loadGalleryTokenMetas(c.gallery_list).catch(a=>_(`Error loading token metas - ${a}`));await Promise.all([e,t,h,u]);const l=w.query.plaque_id;l&&typeof l=="string"&&!p.plaque_map[l]&&await X(l,{user_id:i.get_account.id,token_meta_id_list:[]}).catch(a=>{_(`Error adding plaque from query param = ${a}`)}),y.value=!0}return(o,e)=>{const t=m("el-header"),h=m("el-main"),u=m("el-container");return r(),q(u,{style:{height:"100%"}},{default:d(()=>[n(t,{class:"header"},{default:d(()=>[n(oe)]),_:1}),n(h,{style:{"background-color":"#DAD9D7"}},{default:d(()=>[y.value?(r(),q(s(z),{key:0})):b("",!0)]),_:1})]),_:1})}}});var ye=I(se,[["__scopeId","data-v-43f4e3de"]]);export{ye as default};
