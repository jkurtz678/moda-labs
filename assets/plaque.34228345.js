import{p as r}from"./index.db76b1c1.js";import{g as n,a as o}from"./plaque.5dbbef46.js";import{u as _}from"./account.46d5f1ac.js";import{L as u,e as y,f as d,h as c,M as m}from"./util.25968482.js";const p=u(d),g=y(p,"gallery"),f=async a=>(await c(m(g))).docs.map(e=>({id:e.id,entity:e.data()})).filter(e=>{var i,l;return(l=(i=e==null?void 0:e.entity)==null?void 0:i.user_id_list)==null?void 0:l.includes(a)}),h=r({id:"gallery",state:()=>({gallery_list:[]}),getters:{get_user_id_list_for_galleries:a=>Array().concat.apply(Array(),a.gallery_list.map(s=>s.entity.user_id_list))},actions:{async loadGalleryList(a){this.gallery_list=await f(a)}}}),P=r({id:"plaque",state:()=>({plaques:[]}),getters:{plaque_map:a=>{const s={};return a.plaques.forEach(t=>{s[t.id]=t}),s},meta_in_playlist:a=>(s,t)=>a.plaque_map[s].entity.token_meta_id_list.some(i=>i==t),token_meta_id_list:a=>{let s=[];return a.plaques.forEach(t=>{s.push(...t.entity.token_meta_id_list)}),s}},actions:{async loadPlaques(a){_();const s=h();if(s.gallery_list.length>0){await n(s.get_user_id_list_for_galleries,t=>{for(let e=0;e<t.length;e++)t[e].entity.token_meta_id_list==null&&(t[e].entity.token_meta_id_list=[]);this.plaques=t});return}await o(a,t=>{for(let e=0;e<t.length;e++)t[e].entity.token_meta_id_list==null&&(t[e].entity.token_meta_id_list=[]);this.plaques=t})}}});export{h as a,P as u};
