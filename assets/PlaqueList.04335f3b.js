import{_ as M,d as G,r as w,c as S,y as ee,b as r,o as c,h as k,i as t,w as l,k as o,t as V,j as _,f as m,z as te,p as H,l as Q,u as le,v as I,e as N,A as W,B as re,C as ue,g as T,D as _e,G as ce,F as O,H as J,I as X,J as pe}from"./index.37282573.js";import{u as B,c as me}from"./plaque.093acf64.js";import{c as fe}from"./token-meta.2d60a689.js";import{u as K}from"./plaque.434e4667.js";import{u as ae}from"./account.346d43df.js";import{s as R}from"./util.af4fa2ea.js";import{T as Y}from"./types.6a5ef88e.js";import{u as oe}from"./breakpoints.f718c4aa.js";import{u as ne}from"./token-meta.275f31d4.js";import{_ as ye}from"./TokenSelectList.19879bb8.js";import{_ as ve}from"./PlaqueTokenItem.93e6da89.js";import{n as Z}from"./firebaseConfig.d7a6b5a9.js";import{u as ge}from"./gallery.3c1a5bf6.js";import"./thumbnail-image.12f07e15.js";import"./gallery.82c2a091.js";const ke=i=>(H("data-v-cc2989e6"),i=i(),Q(),i),qe={class:"dialog-container"},he={class:"dialog-footer"},we=ke(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),xe=G({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(i,{emit:s}){const q=i,u=w([]),y=w(!1),{screen_type:h}=oe(),x=K(),A=ne(),$=ae(),v=S({get(){return q.show_add_token_dialog},set(a){s("update:show_add_token_dialog",a)}});ee(v,a=>{a&&(u.value=JSON.parse(JSON.stringify(b.value.entity.token_meta_id_list)))});const b=S(()=>x.plaque_map[q.plaque_id]),P=S(()=>A.sorted_all_token_metas),z=async()=>{y.value=!0;try{for(let[a,e]of u.value.entries()){const n=A.all_token_metas[e];if(!n)throw"Failed to find store token for token: "+e;if(n.entity.platform!=Y.Opensea)continue;const f=JSON.parse(JSON.stringify(n));f.entity.user_id=$.get_account.id,f.entity.platform=Y.OpenseaArchive;const g=await fe(f.entity);u.value[a]=g.id}await B(q.plaque_id,{token_meta_id_list:u.value}),x.plaque_map[q.plaque_id].entity.token_meta_id_list=u.value}catch(a){R(`Error updating plaque tokens - ${a}`)}y.value=!1,v.value=!1},L=()=>{u.value=[]};return(a,e)=>{const n=r("el-button"),f=r("el-dialog");return c(),k("div",qe,[t(f,{center:"",modelValue:m(v),"onUpdate:modelValue":e[1]||(e[1]=g=>te(v)?v.value=g:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:m(h)=="xs",top:"2vh"},{footer:l(()=>[o("div",he,[o("div",null,V(`Artwork in playlist: ${u.value.length}`),1),we,t(n,{onClick:L},{default:l(()=>[_("Clear")]),_:1}),t(n,{type:"info",onClick:z,loading:y.value},{default:l(()=>[_("Save")]),_:1},8,["loading"])])]),default:l(()=>[t(ye,{selected_token_meta_id_list:u.value,"onUpdate:selected_token_meta_id_list":e[0]||(e[0]=g=>u.value=g),token_meta_list:m(P)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var Ce=M(xe,[["__scopeId","data-v-cc2989e6"]]);const C=i=>(H("data-v-62891d66"),i=i(),Q(),i),$e={style:{display:"flex","align-items":"center",padding:"1em"}},be={key:0},Se=C(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),Ae={class:"card-simple"},Pe=C(()=>o("hr",null,null,-1)),Ve=C(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Ne=C(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Te={style:{padding:"0.3em 1em"}},Ie={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},ze={key:0,class:"card-detail"},Le={style:{padding:"0 1em"}},Ee={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},De=C(()=>o("hr",null,null,-1)),Ue=C(()=>o("div",{style:{padding:"1em"}},"No artwork added",-1)),Be=C(()=>o("hr",null,null,-1)),Oe={style:{display:"flex",padding:"1em"}},je=C(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),Fe={key:0,style:{padding:"1em"}},Je={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Re={key:0},Me=C(()=>o("div",null,"Associated User ID:",-1)),Ge={key:1},He={style:{display:"flex","justify-content":"end"}},Qe=G({__name:"PlaqueCard",props:{plaque:null},setup(i){const s=i,q=K();le();const u=w("simple"),y=w(!1),h=w(!1),x=w(!1),A=async()=>{x.value=!0,await B(s.plaque.id,{name:s.plaque.entity.name}).catch(a=>{R(`Error updating plaque tokens - ${a}`)}),h.value=!1,x.value=!1},$=ne(),v=S(()=>b.value.length==0?null:b.value[0]),b=S(()=>{const a=$.archive_token_meta_map;return s.plaque.entity.token_meta_id_list.map(n=>a[n])}),P=S({get:()=>s.plaque.entity.orientation||"landscape",set:a=>{B(s.plaque.id,{orientation:a}).then(()=>{q.plaque_map[s.plaque.id].entity.orientation=a,I({type:"success",message:"Plaque orientation updated"})}).catch(e=>{R(`Error updating plaque orientation - ${e}`)})}}),z=()=>{X.confirm(`Are you sure you want to clear tokens for plaque '${s.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{B(s.plaque.id,{token_meta_id_list:[]}).then(()=>{q.plaque_map[s.plaque.id].entity.token_meta_id_list=[],I({type:"success",message:"Tokens cleared"})}).catch(a=>{I({message:`Error clearing tokens from plaque - ${a}`,type:"error",showClose:!0,duration:12e3})})})},L=()=>{X.confirm(`Are you sure you want to forget the plaque named '${s.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{B(s.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{q.plaque_map[s.plaque.id].entity.user_id="",q.plaque_map[s.plaque.id].entity.token_meta_id_list=[],I({type:"success",message:"Plaque forgotten"})}).catch(a=>{I({message:`Error forgetting plaque - ${a}`,type:"error",showClose:!0,duration:12e3})})})};return(a,e)=>{const n=r("el-button"),f=r("el-tag"),g=r("el-col"),E=r("el-row"),F=r("ArrowRight"),D=r("el-icon"),U=r("el-collapse-transition"),p=r("Close"),j=r("el-radio"),ie=r("el-radio-group"),de=r("el-card");return c(),N(de,null,{default:l(()=>[o("div",$e,[h.value?W((c(),k("input",{key:1,"onUpdate:modelValue":e[0]||(e[0]=d=>s.plaque.entity.name=d),class:"edit-name-input"},null,512)),[[re,s.plaque.entity.name]]):(c(),k("h1",be,V(s.plaque.entity.name),1)),h.value?T("",!0):(c(),N(n,{key:2,icon:m(ue),onClick:e[1]||(e[1]=d=>h.value=!0),class:"editIcon",circle:""},null,8,["icon"])),h.value?(c(),N(n,{key:3,icon:m(_e),loading:x.value,onClick:A,class:"editIcon",circle:"",type:x.value?"":"success",text:""},null,8,["icon","loading","type"])):T("",!0),Se,t(f,{class:"ml-2",type:"success"},{default:l(()=>[_("online")]),_:1})]),t(U,null,{default:l(()=>[W(o("section",Ae,[Pe,t(E,{style:{padding:"1em"}},{default:l(()=>[t(g,{span:12},{default:l(()=>{var d;return[Ve,o("span",null,V(((d=m(v))==null?void 0:d.entity.name)||"N/A"),1)]}),_:1}),t(g,{span:12},{default:l(()=>{var d;return[Ne,_(" "+V(((d=m(v))==null?void 0:d.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),o("div",Te,V(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),o("div",Ie,[t(n,{type:"info",onClick:e[2]||(e[2]=d=>y.value=!0)},{default:l(()=>[_("Add Artwork")]),_:1}),t(n,{onClick:e[3]||(e[3]=d=>u.value="detail")},{default:l(()=>[_(" Details"),t(D,{class:"el-icon--right"},{default:l(()=>[t(F)]),_:1})]),_:1})])],512),[[ce,u.value=="simple"]])]),_:1}),t(U,null,{default:l(()=>[u.value=="detail"?(c(),k("section",ze,[o("p",Le,V(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),o("div",Ee,[t(n,{onClick:e[4]||(e[4]=d=>u.value="settings")},{default:l(()=>[_("Settings")]),_:1}),t(n,{onClick:z},{default:l(()=>[_("Clear Artwork")]),_:1})]),De,m(b).length==0?(c(),k(O,{key:0},[Ue,Be],64)):T("",!0),(c(!0),k(O,null,J(m(b),d=>(c(),N(ve,{token_meta:d},null,8,["token_meta"]))),256)),o("div",Oe,[t(n,{type:"info",onClick:e[5]||(e[5]=d=>y.value=!0)},{default:l(()=>[_("Add Artwork")]),_:1}),je,t(n,{onClick:e[6]||(e[6]=d=>u.value="simple")},{default:l(()=>[_("Close"),t(D,{class:"el-icon--right"},{default:l(()=>[t(p)]),_:1})]),_:1})])])):T("",!0)]),_:1}),t(U,null,{default:l(()=>[u.value=="settings"?(c(),k("section",Fe,[o("div",Je,[i.plaque.entity.user_id?(c(),k("div",Re,[Me,o("div",null,V(i.plaque.entity.user_id),1)])):(c(),k("div",Ge,"No associated user")),i.plaque.entity.user_id?(c(),N(n,{key:2,type:"danger",plain:"",onClick:L},{default:l(()=>[_("Forget Display")]),_:1})):T("",!0)]),o("div",null,[t(ie,{modelValue:m(P),"onUpdate:modelValue":e[7]||(e[7]=d=>te(P)?P.value=d:null),class:"ml-4",style:{display:"flex","flex-direction":"column","align-items":"start"}},{default:l(()=>[t(j,{label:"landscape",size:"small"},{default:l(()=>[_("Landscape")]),_:1}),t(j,{label:"portrait",size:"small"},{default:l(()=>[_("Portrait")]),_:1}),t(j,{label:"landscape_reversed",size:"small"},{default:l(()=>[_("Landscape Reversed")]),_:1}),t(j,{label:"portrait_reversed",size:"small"},{default:l(()=>[_("Portrait Reversed")]),_:1})]),_:1},8,["modelValue"])]),o("div",He,[t(n,{onClick:e[8]||(e[8]=d=>u.value="detail")},{default:l(()=>[_("Close"),t(D,{class:"el-icon--right"},{default:l(()=>[t(p)]),_:1})]),_:1})])])):T("",!0)]),_:1}),t(Ce,{plaque_id:s.plaque.id,show_add_token_dialog:y.value,"onUpdate:show_add_token_dialog":e[9]||(e[9]=d=>y.value=d)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Ke=M(Qe,[["__scopeId","data-v-62891d66"]]);const se=i=>(H("data-v-0ea15fab"),i=i(),Q(),i),We={class:"subheader",style:{display:"flex","align-items":"center"}},Xe=se(()=>o("div",{style:{"padding-bottom":"40px"}},null,-1)),Ye={class:"add-button-container"},Ze={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},et=se(()=>o("div",{style:{"font-size":"17px"}},"Add plaque",-1)),tt={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},lt=G({__name:"PlaqueList",setup(i){const s=w(!1),{width:q,screen_type:u}=oe(),y=w(!1),h=le(),x=ae(),A=ge(),$=w(""),v=w(localStorage.getItem("filter_by_gallery")||"");ee(v,a=>{localStorage.setItem("filter_by_gallery",a)});const b=K(),P=async()=>{s.value=!0,await me({name:"Test Plaque",user_id:x.get_account.id,token_meta_id_list:[],created_at:Z.now(),updated_at:Z.now()}).catch(a=>I({message:`Error creating test plaque- ${a}`,type:"error",showClose:!0,duration:12e3})),s.value=!1,y.value=!1},z=S(()=>JSON.parse(JSON.stringify(b.all_plaque_list)).sort((e,n)=>{const f=e.entity.name.toLowerCase(),g=n.entity.name.toLowerCase();return f<g?-1:f>g?1:0})),L=S(()=>{let a=[...z.value];return a=a.filter(e=>e.entity.name||e.entity.user_id||e.entity.token_meta_id_list.length>0),v.value&&(a=a.filter(e=>{var n;return(n=A.gallery_list.find(f=>f.id==v.value))==null?void 0:n.entity.plaque_id_list.includes(e.id)})),$?a.filter(e=>e.entity.name.toLowerCase().includes($.value.toLowerCase())):a});return(a,e)=>{const n=r("el-input"),f=r("el-option"),g=r("el-select"),E=r("el-button"),F=r("Plus"),D=r("el-icon"),U=r("el-dialog");return c(),k(O,null,[o("div",We,[t(n,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=p=>$.value=p),"prefix-icon":m(pe),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),t(g,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=p=>v.value=p),placeholder:"Filter by gallery",style:{"margin-left":"10px",width:"260px"}},{default:l(()=>[t(f,{label:"All plaques",value:""}),(c(!0),k(O,null,J(m(A).gallery_list,p=>(c(),N(f,{key:p.id,label:`Filter by gallery - ${p.entity.name}`,value:p.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(E,{icon:"Camera",type:"info",onClick:e[2]||(e[2]=p=>m(h).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:l(()=>[_("Scan")]),_:1})]),Xe,(c(!0),k(O,null,J(m(L),p=>(c(),N(Ke,{plaque:p,key:p.id},null,8,["plaque"]))),128)),o("div",Ye,[o("div",Ze,[o("div",{class:"add-button",onClick:e[3]||(e[3]=p=>y.value=!0)},[t(D,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:l(()=>[t(F)]),_:1}),et])])]),t(U,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=p=>y.value=p),title:"Add plaque",width:m(u)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:l(()=>[o("div",tt,[t(E,{onClick:e[4]||(e[4]=p=>{m(h).push("qr-scan"),y.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:l(()=>[_("Scan Plaque QR Code")]),_:1}),t(E,{icon:"plus",onClick:P,loading:s.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:l(()=>[_("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var gt=M(lt,[["__scopeId","data-v-0ea15fab"]]);export{gt as default};
