import{_ as G,a as O,b as U,c as F}from"./search-icon.822e7617.js";import{_ as H,d as I,u as L,a as P,r as V,c as j,b as p,o as i,e as w,w as m,f as s,g as q,h as A,F as N,i as l,j as C,k as S,t as z,p as W,l as J,m as K,E as T,R as Q}from"./index.cce1f96b.js";import{u as R}from"./account.01e9d65a.js";import{u as X}from"./breakpoints.6305aeba.js";import{s as Y,a as B,o as Z}from"./firebaseConfig.d7a6b5a9.js";import{s as n}from"./util.9cc4cf79.js";import{u as ee}from"./plaque.1110697a.js";import{u as te}from"./token-meta.ca62214c.js";import{u as ae}from"./plaque.093acf64.js";import{u as oe}from"./gallery.da02e28b.js";import"./types.6a5ef88e.js";import"./token-meta.2d60a689.js";import"./gallery.82c2a091.js";const D=h=>(W("data-v-01d6d2aa"),h=h(),J(),h),se=D(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),ne=D(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),le={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},re=I({__name:"Header",setup(h){const r=L(),g=P(),u=R(),_=V(!1),{width:M,screen_type:k}=X(),f=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&r.push({name:e.paneName})},x=j(()=>{const e=u.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),$=()=>{_.value=!0,Y(B).then(()=>{}).catch(e=>{n(e)}).finally(()=>{_.value=!1})},o=e=>new URL({"../assets/base.css":G,"../assets/logo.png":O,"../assets/logo.svg":U,"../assets/search-icon.svg":F}[`../assets/${e}`],self.location).href;return(e,t)=>{const v=p("el-image"),d=p("el-button"),c=p("el-tab-pane"),y=p("el-tabs"),a=p("el-header");return i(),w(a,{class:"header"},{default:m(()=>[s(k)!="xs"?(i(),w(v,{key:0,src:o("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):q("",!0),s(r).currentRoute.value.name=="qr-scan"?(i(),A(N,{key:1},[se,l(d,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=b=>s(r).push("plaque-list"))},{default:m(()=>[C(" Cancel ")]),_:1})],64)):(i(),A(N,{key:2},[l(y,{modelValue:s(g).name,"onUpdate:modelValue":t[1]||(t[1]=b=>s(g).name=b),onTabClick:f},{default:m(()=>[l(c,{label:"Plaques",name:"plaque-list"}),l(c,{label:"Artwork",name:"token-list"}),l(c,{label:"Galleries",name:"gallery-list"}),l(c,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue"]),ne,s(k)!="xs"?(i(),A("div",le,[S("div",null,z(s(x)),1),s(u).is_user_admin?(i(),w(d,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:m(()=>[C("Admin")]),_:1})):q("",!0)])):q("",!0),l(d,{onClick:$,style:{"margin-left":"1em"},loading:_.value},{default:m(()=>[C("Logout")]),_:1},8,["loading"])],64))]),_:1})}}});var ce=H(re,[["__scopeId","data-v-01d6d2aa"]]);const ie=I({__name:"HomeView",setup(h){const r=R(),g=ee(),u=te(),_=oe(),M=L(),k=V(!1),f=V(),x=P();K(async()=>{f.value=T.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),Z(B,async o=>{console.log("onAuthStateChanged",o),o?(f.value=T.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await $(o.uid),f.value.close()):(r.setAccount(null),f.value.close(),M.push({name:"login",query:{redir:window.location.href}}))})});async function $(o){await r.loadAccount(o),await _.loadGalleryList(o).catch(a=>n(`Error loading galleries - ${a}`));const e=g.loadPlaques(o).catch(a=>n(`Error loading plaques - ${a}`)),t=g.loadGalleryPlaques(_.gallery_list).catch(a=>n(`Error loading gallery plaques - ${a}`)),v=u.loadArchiveTokenMetas(o).catch(a=>n(`Error loading archive token metas - ${a}`));u.loadGalleryTokenMetas(_.gallery_list).catch(a=>n(`Error loading token metas - ${a}`));const d=[e,t,v,t],c=r.get_account.entity.wallet_address;if(c){const a=u.loadOpenseaMintedTokenMetas(c).catch(E=>n(`Error loading opensea minted tokens - ${E}`)),b=u.loadOpenseaWalletTokenMetas(c).catch(E=>n(`Error loading opensea wallet tokens - ${E}`));d.push(a),d.push(b)}await Promise.all(d);const y=x.query.plaque_id;y&&typeof y=="string"&&!g.plaque_map[y]&&await ae(y,{user_id:r.get_account.id,token_meta_id_list:[]}).catch(a=>{n(`Error adding plaque from query param = ${a}`)}),k.value=!0}return(o,e)=>{const t=p("el-main"),v=p("el-container");return i(),w(v,{style:{height:"100%","flex-direction":"column"}},{default:m(()=>[l(ce),l(t,{style:{"background-color":"#DAD9D7"}},{default:m(()=>[k.value?(i(),w(s(Q),{key:0})):q("",!0)]),_:1})]),_:1})}}});var qe=H(ie,[["__scopeId","data-v-c3f6f82a"]]);export{qe as default};
