import{d as P,P as J,Q as X,r as A,o as k,h as w,F as U,I as j,M as O,f as d,S as Z,j as F,t as B,T as ee,U as te,m as H,z as ne,_ as K,u as Y,L as oe,c as D,b as V,k as y,n as q,i as c,w as g,V as L,e as le,g as Q,K as ae,p as se,l as re}from"./index.b2cff828.js";import{u as ie}from"./thumbnail-image.0d0d527c.js";import{c as ce,d as ue}from"./types.6a5ef88e.js";import{s as me}from"./util.ffcf7246.js";import{u as de}from"./token-meta.27f5f32c.js";import"./firebaseConfig.d7a6b5a9.js";import"./token-meta.2d60a689.js";import"./account.7f54a464.js";const _e={columnWidth:400,gap:0,keyMapper:(n,s,v,u)=>u,minColumns:1,maxColumns:void 0,rtl:!1,scrollContainer:null,ssrColumns:0};function pe({columns:n,columnWidth:s,emit:v,gap:u,items:r,maxColumns:m,minColumns:h,nextTick:C,onBeforeUnmount:b,onMounted:T,rtl:a,scrollContainer:e,ssrColumns:o,vue:i,wall:f,watch:M}){function $(l,t,p,R){const z=_(p);return R+t+z<=l?$(l,t,p+1,R+t+z):p}function _(l){const t=Array.isArray(s.value)?s.value:[s.value];return t[l%t.length]}function x(){const l=$(f.value.getBoundingClientRect().width,u.value,0,-u.value),t=W(S(l));return t>0?t:1}function S(l){const t=m==null?void 0:m.value;return t&&l>t?t:l}function W(l){const t=h==null?void 0:h.value;return t&&l<t?t:l}function G(l){return[...new Array(l)].map(()=>[])}if(o.value>0){const l=G(o.value);r.value.forEach((t,p)=>l[p%o.value].push(p)),n.value=l}async function N(l){if(l>=r.value.length)return;await C();const t=[...f.value.children];a.value&&t.reverse();const p=t.reduce((R,z)=>z.getBoundingClientRect().height<R.getBoundingClientRect().height?z:R);n.value[+p.dataset.index].push(l),await N(l+1)}async function E(l=!1){if(n.value.length===x()&&!l){v(i===2?"redraw-skip":"redrawSkip");return}n.value=G(x());const t=e==null?void 0:e.value,p=t?t.scrollTop:window.scrollY;await N(0),t?t.scrollBy({top:p-t.scrollTop}):window.scrollTo({top:p}),v("redraw")}const I=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>E());return T(()=>{E(),I==null||I.observe(f.value)}),b(()=>I==null?void 0:I.unobserve(f.value)),M([r,a],()=>E(!0)),M([s,u,h,m],()=>E()),{getColumnWidthTarget:_}}const ke=["data-index"],ve=P({__name:"masonry-wall",props:J({columnWidth:{},items:{},gap:{},rtl:{type:Boolean},ssrColumns:{},scrollContainer:{},minColumns:{},maxColumns:{},keyMapper:{type:Function}},_e),emits:["redraw","redrawSkip"],setup(n,{emit:s}){const v=n,{columnWidth:u,items:r,gap:m,rtl:h,ssrColumns:C,scrollContainer:b,minColumns:T,maxColumns:a,keyMapper:e}=X(v),o=A([]),i=A(),{getColumnWidthTarget:f}=pe({columns:o,columnWidth:u,emit:s,gap:m,items:r,keyMapper:e,maxColumns:a,minColumns:T,nextTick:ee,onBeforeUnmount:te,onMounted:H,rtl:h,scrollContainer:b,ssrColumns:C,vue:3,wall:i,watch:ne});return(M,$)=>(k(),w("div",{ref_key:"wall",ref:i,class:"masonry-wall",style:O({display:"flex",gap:`${d(m)}px`})},[(k(!0),w(U,null,j(o.value,(_,x)=>(k(),w("div",{key:x,class:"masonry-column","data-index":x,style:O({display:"flex","flex-basis":`${d(f)(x)}px`,"flex-direction":"column","flex-grow":1,gap:`${d(m)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(k(!0),w(U,null,j(_,(S,W)=>(k(),w("div",{key:d(e)(d(r)[S],x,W,S),class:"masonry-item"},[Z(M.$slots,"default",{item:d(r)[S],column:x,row:W,index:S},()=>[F(B(d(r)[S]),1)])]))),128))],12,ke))),128))],4))}}),fe=(()=>{const n=ve;return n.install=s=>{s.component("MasonryWall",n)},n})();const ye=["src"],we={class:"header"},he={class:"platform"},xe={style:{"font-size":"1.6em","font-weight":"bold"}},ge={key:0},Ce={key:1,style:{"font-weight":"bold"}},be={style:{"font-size":"0.9em","line-height":"1.3em"}},Te=P({__name:"ArtworkTile",props:{token_meta:null},setup(n){const s=n,v=Y(),u=ie(oe(s,"token_meta")),r=A(!1),m=D(()=>ce(s.token_meta.entity.platform)),h=async()=>{const a=await ue(s.token_meta);if(!a){me("Error getting source file");return}window.open(a,"_blank")},C=()=>{const a=v.resolve({name:"preview-plaque",params:{token_meta_id:s.token_meta.id}});window.open(a.href)},b=()=>{window.open(s.token_meta.entity.public_link,"_blank")},T=()=>{window.open(s.token_meta.entity.artist_social_link,"_blank")};return(a,e)=>{const o=V("el-button"),i=V("el-tooltip");return k(),w("div",{class:"custom-card",onClick:e[1]||(e[1]=f=>r.value=!r.value)},[y("img",{class:q(r.value?"absolute":""),src:d(u)},null,10,ye),y("div",{class:q(["transition absolute",r.value?"hide-blur":"show-blur"])},[y("div",we,B(`${n.token_meta.entity.name} | ${n.token_meta.entity.artist}`),1),y("div",he,B(d(m)),1)],2),y("div",{class:q(["detail-container transition",r.value?"show-blur":"hide-blur absolute"])},[y("div",xe,B(n.token_meta.entity.name),1),n.token_meta.entity.artist_social_link?(k(),w("div",ge,[c(o,{link:"",style:{"font-weight":"bold",display:"block"},onClick:L(T,["stop"])},{default:g(()=>[F(B(n.token_meta.entity.artist),1)]),_:1},8,["onClick"])])):(k(),w("div",Ce,B(n.token_meta.entity.artist),1)),r.value?(k(),w(U,{key:2},[c(i,{class:"box-item",effect:"dark",content:"Download art",placement:"top"},{default:g(()=>[c(o,{icon:"Download",text:"",circle:"",onClick:L(h,["stop"])},null,8,["onClick"])]),_:1}),c(i,{class:"box-item",effect:"dark",content:"Preview plaque",placement:"top"},{default:g(()=>[c(o,{icon:"Tickets",text:"",circle:"",onClick:L(C,["stop"])},null,8,["onClick"])]),_:1}),n.token_meta.entity.public_link?(k(),le(i,{key:0,class:"box-item",effect:"dark",content:"QR Code Link",placement:"top"},{default:g(()=>[c(o,{icon:"Link",text:"",circle:"",onClick:L(b,["stop"])},null,8,["onClick"])]),_:1})):Q("",!0),c(i,{class:"box-item",effect:"dark",content:"Edit art data",placement:"top"},{default:g(()=>[c(o,{icon:"Edit",text:"",circle:"",onClick:e[0]||(e[0]=L(f=>d(v).push({name:"edit-artwork",params:{token_meta_id:s.token_meta.id}}),["stop"]))})]),_:1})],64)):Q("",!0),y("div",be,B(n.token_meta.entity.description),1)],2)])}}});var Se=K(Te,[["__scopeId","data-v-03d61273"]]);const Be=n=>(se("data-v-33742f3e"),n=n(),re(),n),Ve={class:"subheader",style:{display:"flex","align-items":"center"}},Ae=Be(()=>y("div",{style:{"padding-bottom":"40px"}},null,-1)),Me=P({__name:"ArtworkTileGrid",setup(n){const s=Y(),v=de(),u=A(""),r=A(null),m=A(localStorage.getItem("token_list_sort_order")||"name"),h=A(1e3),C=D(()=>v.sorted_all_token_metas),b=D(()=>{let a=C.value.filter(e=>{var o,i;return((o=e.entity.artist)==null?void 0:o.toLowerCase().includes(u.value.toLowerCase()))||((i=e.entity.name)==null?void 0:i.toLowerCase().includes(u.value.toLowerCase()))});return m.value==="name"?a=a.sort((e,o)=>e.entity.name.localeCompare(o.entity.name)):m.value==="created_at"&&(a=a.sort((e,o)=>e.entity.created_at==null&&o.entity.created_at==null?0:e.entity.created_at==null?1:o.entity.created_at==null?-1:o.entity.created_at.seconds-e.entity.created_at.seconds)),a}),T=D(()=>{const a=b.value,e=0,o=e+h.value;return a.slice(e,o)});return H(()=>{if(!document.getElementById("masonry-container")){console.log("ArtworkTileGrid error, masonary_wall element not found");return}}),(a,e)=>{const o=V("el-input"),i=V("el-option"),f=V("el-select"),M=V("el-button"),$=V("RouterView");return k(),w(U,null,[y("div",Ve,[c(o,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=_=>u.value=_),"prefix-icon":d(ae),placeholder:"Search artwork or artist",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),c(f,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=_=>m.value=_),placeholder:"Sort by",style:{"margin-left":"10px"}},{default:g(()=>[c(i,{label:"Sort by name",value:"name"}),c(i,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"]),c(M,{icon:"Plus",onClick:e[2]||(e[2]=_=>d(s).push({name:"new-artwork"})),color:"#000000",style:{"margin-left":"10px"},size:"small"},{default:g(()=>[F("Artwork")]),_:1})]),Ae,y("div",{id:"masonry-container",ref_key:"masonryContainer",ref:r,style:{"overflow-y":"auto",height:"100%",padding:"10px",margin:"-10px"}},[c(d(fe),{id:"masonary-wall","scroll-container":r.value,items:d(T),"column-width":250,gap:14},{default:g(({item:_})=>[c(Se,{token_meta:_},null,8,["token_meta"])]),_:1},8,["scroll-container","items"])],512),c($)],64)}}});var Ue=K(Me,[["__scopeId","data-v-33742f3e"]]);export{Ue as default};
