import{_ as z,d as J,r as v,c as S,v as ne,b as _,o as m,e as A,i as e,w as o,k as a,t as T,j as u,f,x as se,y as U,z as F,u as K,g as E,A as R,B as ie,C as de,h as I,D as re,G as ue,F as D,H as W,I as G,q as L,J as _e}from"./index.8510418c.js";import{u as B,c as ce}from"./plaque.60454c0e.js";import{c as pe}from"./token-meta.ba91ce12.js";import{u as X}from"./plaque.813df5f5.js";import{u as Y}from"./account.046c06e8.js";import{s as Z}from"./util.3e29b554.js";import{T as H}from"./types.ab61d3d9.js";import{u as ee}from"./breakpoints.c72cb334.js";import{u as te}from"./token-meta.4e61cefe.js";import{_ as me}from"./TokenSelectList.ddea8a9f.js";import{_ as fe}from"./PlaqueTokenItem.1f8da690.js";import{n as Q}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.838b8f8d.js";import"./thumbnail-image.eaca636b.js";const ve=i=>(U("data-v-cc2989e6"),i=i(),F(),i),ye={class:"dialog-container"},ge={class:"dialog-footer"},ke=ve(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),we=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(i,{emit:d}){const P=i,s=v([]),c=v(!1),{screen_type:h}=ee(),q=X(),x=te(),N=Y(),y=S({get(){return P.show_add_token_dialog},set(n){d("update:show_add_token_dialog",n)}});ne(y,n=>{n&&(s.value=JSON.parse(JSON.stringify(C.value.entity.token_meta_id_list)))});const C=S(()=>q.plaque_map[P.plaque_id]),V=S(()=>x.sorted_all_token_metas),$=async()=>{c.value=!0;try{for(let[n,t]of s.value.entries()){const l=x.all_token_metas[t];if(!l)throw"Failed to find store token for token: "+t;if(l.entity.platform!=H.Opensea)continue;const g=JSON.parse(JSON.stringify(l));g.entity.user_id=N.get_account.id,g.entity.platform=H.OpenseaArchive;const k=await pe(g.entity);s.value[n]=k.id}await B(P.plaque_id,{token_meta_id_list:s.value}),q.plaque_map[P.plaque_id].entity.token_meta_id_list=s.value}catch(n){Z(`Error updating plaque tokens - ${n}`)}c.value=!1,y.value=!1},p=()=>{s.value=[]};return(n,t)=>{const l=_("el-button"),g=_("el-dialog");return m(),A("div",ye,[e(g,{center:"",modelValue:f(y),"onUpdate:modelValue":t[1]||(t[1]=k=>se(y)?y.value=k:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:f(h)=="xs",top:"2vh"},{footer:o(()=>[a("div",ge,[a("div",null,T(`Artwork in playlist: ${s.value.length}`),1),ke,e(l,{onClick:p},{default:o(()=>[u("Clear")]),_:1}),e(l,{type:"info",onClick:$,loading:c.value},{default:o(()=>[u("Save")]),_:1},8,["loading"])])]),default:o(()=>[e(me,{selected_token_meta_id_list:s.value,"onUpdate:selected_token_meta_id_list":t[0]||(t[0]=k=>s.value=k),token_meta_list:f(V)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var he=z(we,[["__scopeId","data-v-cc2989e6"]]);const b=i=>(U("data-v-1c15685a"),i=i(),F(),i),qe={style:{display:"flex","align-items":"center",padding:"1em"}},xe={key:0},Ce=b(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),$e={class:"card-simple"},Ae=b(()=>a("hr",null,null,-1)),be=b(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Pe=b(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Se={style:{padding:"0.3em 1em"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Ne={key:0,class:"card-detail"},Ve={style:{padding:"0 1em"}},Ie={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ee=b(()=>a("hr",null,null,-1)),Le=b(()=>a("div",{style:{padding:"1em"}},"No artwork added",-1)),Be=b(()=>a("hr",null,null,-1)),De={style:{display:"flex",padding:"1em"}},Oe=b(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),je={key:0,style:{padding:"1em"}},ze={style:{display:"flex","justify-content":"space-between"}},Je={style:{padding:"1em 0em"}},Ue={style:{display:"flex","justify-content":"end"}},Fe=J({__name:"PlaqueCard",props:{plaque:null},setup(i){const d=i,P=K(),s=v("simple"),c=v(!1),h=v(!1),q=v(!1),x=async()=>{q.value=!0,await B(d.plaque.id,{name:d.plaque.entity.name}).catch(n=>{Z(`Error updating plaque tokens - ${n}`)}),h.value=!1,q.value=!1},N=te(),y=S(()=>C.value.length==0?null:C.value[0]),C=S(()=>{const n=N.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(l=>n[l])});v("0"),v(!0);const V=()=>{G.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{B(d.plaque.id,{token_meta_id_list:[]}).then(()=>{L({type:"success",message:"Tokens cleared"})}).catch(n=>{L({message:`Error clearing tokens from plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},$=()=>{G.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{B(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{L({type:"success",message:"Plaque forgotten"})}).catch(n=>{L({message:`Error forgetting plaque - ${n}`,type:"error",showClose:!0,duration:12e3})})})},p=()=>{const n=P.resolve({name:"preview-plaque",params:{plaque_id:d.plaque.id}});window.open(n.href)};return(n,t)=>{const l=_("el-button"),g=_("el-tag"),k=_("el-col"),w=_("el-row"),ae=_("ArrowRight"),O=_("el-icon"),j=_("el-collapse-transition"),M=_("Close"),le=_("el-card");return m(),E(le,null,{default:o(()=>[a("div",qe,[h.value?R((m(),A("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=r=>d.plaque.entity.name=r),class:"edit-name-input"},null,512)),[[ie,d.plaque.entity.name]]):(m(),A("h1",xe,T(d.plaque.entity.name),1)),h.value?I("",!0):(m(),E(l,{key:2,icon:f(de),onClick:t[1]||(t[1]=r=>h.value=!0),class:"editIcon",circle:""},null,8,["icon"])),h.value?(m(),E(l,{key:3,icon:f(re),loading:q.value,onClick:x,class:"editIcon",circle:"",type:q.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),Ce,e(g,{class:"ml-2",type:"success"},{default:o(()=>[u("online")]),_:1})]),e(j,null,{default:o(()=>[R(a("section",$e,[Ae,e(w,{style:{padding:"1em"}},{default:o(()=>[e(k,{span:12},{default:o(()=>{var r;return[be,a("span",null,T(((r=f(y))==null?void 0:r.entity.name)||"N/A"),1)]}),_:1}),e(k,{span:12},{default:o(()=>{var r;return[Pe,u(" "+T(((r=f(y))==null?void 0:r.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),a("div",Se,T(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),a("div",Te,[e(l,{type:"info",onClick:t[2]||(t[2]=r=>c.value=!0)},{default:o(()=>[u("Add Artwork")]),_:1}),e(l,{onClick:t[3]||(t[3]=r=>s.value="detail")},{default:o(()=>[u(" Details"),e(O,{class:"el-icon--right"},{default:o(()=>[e(ae)]),_:1})]),_:1})])],512),[[ue,s.value=="simple"]])]),_:1}),e(j,null,{default:o(()=>[s.value=="detail"?(m(),A("section",Ne,[a("p",Ve,T(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),a("div",Ie,[e(l,{onClick:t[4]||(t[4]=r=>s.value="settings")},{default:o(()=>[u("Settings")]),_:1}),e(l,{onClick:V},{default:o(()=>[u("Clear Artwork")]),_:1})]),Ee,f(C).length==0?(m(),A(D,{key:0},[Le,Be],64)):I("",!0),(m(!0),A(D,null,W(f(C),r=>(m(),E(fe,{token_meta:r},null,8,["token_meta"]))),256)),a("div",De,[e(l,{type:"info",onClick:t[5]||(t[5]=r=>c.value=!0)},{default:o(()=>[u("Add Artwork")]),_:1}),Oe,e(l,{onClick:t[6]||(t[6]=r=>s.value="simple")},{default:o(()=>[u("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(j,null,{default:o(()=>[s.value=="settings"?(m(),A("section",je,[a("div",ze,[e(l,null,{default:o(()=>[u("Preview Art")]),_:1}),e(l,{onClick:p},{default:o(()=>[u("Preview Plaque")]),_:1})]),a("div",Je,[e(l,{type:"danger",plain:"",onClick:$},{default:o(()=>[u("Forget Display")]),_:1})]),a("div",Ue,[e(l,{onClick:t[7]||(t[7]=r=>s.value="detail")},{default:o(()=>[u("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(he,{plaque_id:d.plaque.id,show_add_token_dialog:c.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=r=>c.value=r)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Me=z(Fe,[["__scopeId","data-v-1c15685a"]]);const oe=i=>(U("data-v-693bb944"),i=i(),F(),i),Re={class:"subheader"},Ge=oe(()=>a("div",{style:{"padding-bottom":"40px"}},null,-1)),He={class:"add-button-container"},Qe={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ke=oe(()=>a("div",{style:{"font-size":"17px"}},"Add plaque",-1)),We={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},Xe=J({__name:"PlaqueList",setup(i){const d=v(!1),{width:P,screen_type:s}=ee(),c=v(!1),h=K(),q=Y(),x=v(""),N=X(),y=async()=>{d.value=!0,await ce({name:"Test Plaque",user_id:q.get_account.id,token_meta_id_list:[],created_at:Q.now(),updated_at:Q.now()}).catch($=>L({message:`Error creating test plaque- ${$}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,c.value=!1},C=S(()=>JSON.parse(JSON.stringify(N.all_plaque_list)).sort((p,n)=>{const t=p.entity.name.toLowerCase(),l=n.entity.name.toLowerCase();return t<l?-1:t>l?1:0})),V=S(()=>x?C.value.filter($=>$.entity.name.toLowerCase().includes(x.value.toLowerCase())):C.value);return($,p)=>{const n=_("el-input"),t=_("Plus"),l=_("el-icon"),g=_("el-button"),k=_("el-dialog");return m(),A(D,null,[a("div",Re,[e(n,{modelValue:x.value,"onUpdate:modelValue":p[0]||(p[0]=w=>x.value=w),"prefix-icon":f(_e),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"])]),Ge,(m(!0),A(D,null,W(f(V),w=>(m(),E(Me,{plaque:w,key:w.id},null,8,["plaque"]))),128)),a("div",He,[a("div",Qe,[a("div",{class:"add-button",onClick:p[1]||(p[1]=w=>c.value=!0)},[e(l,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[e(t)]),_:1}),Ke])])]),e(k,{modelValue:c.value,"onUpdate:modelValue":p[3]||(p[3]=w=>c.value=w),title:"Add plaque",width:f(s)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[a("div",We,[e(g,{onClick:p[2]||(p[2]=w=>{f(h).push("qr-scan"),c.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[u("Scan Plaque QR Code")]),_:1}),e(g,{icon:"plus",onClick:y,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[u("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var ct=z(Xe,[["__scopeId","data-v-693bb944"]]);export{ct as default};
