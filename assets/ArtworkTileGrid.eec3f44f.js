import{d as F,P as Y,Q as J,r as b,o as h,h as g,F as q,I as N,M as j,f,S as X,j as G,t as R,T as Z,U as ee,m as O,z as te,_ as Q,u as K,L as ne,c as U,b as $,k as C,n as P,i as d,w as M,V as D,e as oe,g as le,K as ae,p as ie,l as re}from"./index.3d944360.js";import{u as se}from"./thumbnail-image.7a3c95a9.js";import{c as ce,d as ue}from"./types.6a5ef88e.js";import{s as me}from"./util.63de370d.js";import{u as de}from"./token-meta.a67d7a4a.js";import"./firebaseConfig.d7a6b5a9.js";import"./token-meta.2d60a689.js";import"./account.c8546714.js";const _e={columnWidth:400,gap:0,keyMapper:(t,a,x,_)=>_,minColumns:1,maxColumns:void 0,rtl:!1,scrollContainer:null,ssrColumns:0};function pe({columns:t,columnWidth:a,emit:x,gap:_,items:i,maxColumns:c,minColumns:p,nextTick:T,onBeforeUnmount:B,onMounted:V,rtl:u,scrollContainer:n,ssrColumns:l,vue:v,wall:s,watch:m}){function k(o,e,w,L){const W=r(w);return L+e+W<=o?k(o,e,w+1,L+e+W):w}function r(o){const e=Array.isArray(a.value)?a.value:[a.value];return e[o%e.length]}function y(){const o=k(s.value.getBoundingClientRect().width,_.value,0,-_.value),e=A(S(o));return e>0?e:1}function S(o){const e=c==null?void 0:c.value;return e&&o>e?e:o}function A(o){const e=p==null?void 0:p.value;return e&&o<e?e:o}function E(o){return[...new Array(o)].map(()=>[])}if(l.value>0){const o=E(l.value);i.value.forEach((e,w)=>o[w%l.value].push(w)),t.value=o}async function I(o){if(o>=i.value.length)return;await T();const e=[...s.value.children];u.value&&e.reverse();const w=e.reduce((L,W)=>W.getBoundingClientRect().height<L.getBoundingClientRect().height?W:L);t.value[+w.dataset.index].push(o),await I(o+1)}async function z(o=!1){if(t.value.length===y()&&!o){x(v===2?"redraw-skip":"redrawSkip");return}t.value=E(y());const e=n==null?void 0:n.value,w=e?e.scrollTop:window.scrollY;await I(0),e?e.scrollBy({top:w-e.scrollTop}):window.scrollTo({top:w}),x("redraw")}const H=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>z());return V(()=>{z(),H==null||H.observe(s.value)}),B(()=>H==null?void 0:H.unobserve(s.value)),m([i,u],()=>z(!0)),m([a,_,p,c],()=>z()),{getColumnWidthTarget:r}}const fe=["data-index"],ve=F({__name:"masonry-wall",props:Y({columnWidth:{},items:{},gap:{},rtl:{type:Boolean},ssrColumns:{},scrollContainer:{},minColumns:{},maxColumns:{},keyMapper:{type:Function}},_e),emits:["redraw","redrawSkip"],setup(t,{emit:a}){const x=t,{columnWidth:_,items:i,gap:c,rtl:p,ssrColumns:T,scrollContainer:B,minColumns:V,maxColumns:u,keyMapper:n}=J(x),l=b([]),v=b(),{getColumnWidthTarget:s}=pe({columns:l,columnWidth:_,emit:a,gap:c,items:i,keyMapper:n,maxColumns:u,minColumns:V,nextTick:Z,onBeforeUnmount:ee,onMounted:O,rtl:p,scrollContainer:B,ssrColumns:T,vue:3,wall:v,watch:te});return(m,k)=>(h(),g("div",{ref_key:"wall",ref:v,class:"masonry-wall",style:j({display:"flex",gap:`${f(c)}px`})},[(h(!0),g(q,null,N(l.value,(r,y)=>(h(),g("div",{key:y,class:"masonry-column","data-index":y,style:j({display:"flex","flex-basis":`${f(s)(y)}px`,"flex-direction":"column","flex-grow":1,gap:`${f(c)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(h(!0),g(q,null,N(r,(S,A)=>(h(),g("div",{key:f(n)(f(i)[S],y,A,S),class:"masonry-item"},[X(m.$slots,"default",{item:f(i)[S],column:y,row:A,index:S},()=>[G(R(f(i)[S]),1)])]))),128))],12,fe))),128))],4))}}),ke=(()=>{const t=ve;return t.install=a=>{a.component("MasonryWall",t)},t})();const ye=["src"],he={class:"header"},we={class:"platform"},ge={style:{"font-size":"1.6em","font-weight":"bold"}},xe={key:0},Ce={key:1,style:{"font-weight":"bold"}},be={key:3,style:{height:"32px"}},Te={style:{"font-size":"0.9em","line-height":"1.3em"}},Se=F({__name:"ArtworkTile",props:{token_meta:null},setup(t){const a=t,x=K(),_=se(ne(a,"token_meta")),i=b(!1),c=b(0),p=b(),T=b(),B=U(()=>ce(a.token_meta.entity.platform)),V=async()=>{const s=await ue(a.token_meta);if(!s){me("Error getting source file");return}window.open(s,"_blank")},u=()=>{const s=x.resolve({name:"preview-plaque",params:{token_meta_id:a.token_meta.id}});window.open(s.href)},n=()=>{window.open(a.token_meta.entity.public_link,"_blank")},l=()=>{window.open(a.token_meta.entity.artist_social_link,"_blank")};function v(s){if(!p.value){console.log("animateDivHeight - error finding tile container");return}if(s&&c.value==0&&(c.value=p.value.offsetHeight),!T.value){console.log("animateDivHeight - error finding detail container");return}let m;s?m=T.value.offsetHeight:m=c.value;const k=300,r=10,y=p.value.offsetHeight,S=Math.ceil(m-y),A=Math.ceil(k/r),E=S/A;let I=0;const z=setInterval(()=>{if(I>=A){p.value.style.height=m+"px",clearInterval(z);return}I++;const H=y+E*I;p.value.style.height=H+"px"},r)}return(s,m)=>{const k=$("el-button"),r=$("el-tooltip");return h(),g("div",{ref_key:"tile_container",ref:p,class:"custom-card",onClick:m[1]||(m[1]=()=>{i.value=!i.value,v(i.value)})},[C("img",{class:P(i.value?"absolute":""),src:f(_)},null,10,ye),C("div",{class:P(["transition absolute",i.value?"hide-blur":"show-blur"])},[C("div",he,R(`${t.token_meta.entity.name} | ${t.token_meta.entity.artist}`),1),C("div",we,R(f(B)),1)],2),C("div",{ref_key:"detail_container",ref:T,class:P(["detail-container transition",i.value?"show-blur":"hide-blur absolute-no-b"])},[C("div",ge,R(t.token_meta.entity.name),1),t.token_meta.entity.artist_social_link?(h(),g("div",xe,[d(k,{link:"",style:{"font-weight":"bold",display:"block"},onClick:D(l,["stop"])},{default:M(()=>[G(R(t.token_meta.entity.artist),1)]),_:1},8,["onClick"])])):(h(),g("div",Ce,R(t.token_meta.entity.artist),1)),i.value?(h(),g(q,{key:2},[d(r,{class:"box-item",effect:"dark",content:"Download art",placement:"top"},{default:M(()=>[d(k,{icon:"Download",text:"",circle:"",onClick:D(V,["stop"])},null,8,["onClick"])]),_:1}),d(r,{class:"box-item",effect:"dark",content:"Preview plaque",placement:"top"},{default:M(()=>[d(k,{icon:"Tickets",text:"",circle:"",onClick:D(u,["stop"])},null,8,["onClick"])]),_:1}),t.token_meta.entity.public_link?(h(),oe(r,{key:0,class:"box-item",effect:"dark",content:"QR Code Link",placement:"top"},{default:M(()=>[d(k,{icon:"Link",text:"",circle:"",onClick:D(n,["stop"])},null,8,["onClick"])]),_:1})):le("",!0),d(r,{class:"box-item",effect:"dark",content:"Edit art data",placement:"top"},{default:M(()=>[d(k,{icon:"Edit",text:"",circle:"",onClick:m[0]||(m[0]=D(y=>f(x).push({name:"edit-artwork",params:{token_meta_id:a.token_meta.id}}),["stop"]))})]),_:1})],64)):(h(),g("div",be)),C("div",Te,R(t.token_meta.entity.description),1)],2)],512)}}});var Me=Q(Se,[["__scopeId","data-v-21cf7d0e"]]);const Be=t=>(ie("data-v-33742f3e"),t=t(),re(),t),Ve={class:"subheader",style:{display:"flex","align-items":"center"}},Ae=Be(()=>C("div",{style:{"padding-bottom":"40px"}},null,-1)),Re=F({__name:"ArtworkTileGrid",setup(t){const a=K(),x=de(),_=b(""),i=b(null),c=b(localStorage.getItem("token_list_sort_order")||"name"),p=b(1e3),T=U(()=>x.sorted_all_token_metas),B=U(()=>{let u=T.value.filter(n=>{var l,v;return((l=n.entity.artist)==null?void 0:l.toLowerCase().includes(_.value.toLowerCase()))||((v=n.entity.name)==null?void 0:v.toLowerCase().includes(_.value.toLowerCase()))});return c.value==="name"?u=u.sort((n,l)=>n.entity.name.localeCompare(l.entity.name)):c.value==="created_at"&&(u=u.sort((n,l)=>n.entity.created_at==null&&l.entity.created_at==null?0:n.entity.created_at==null?1:l.entity.created_at==null?-1:l.entity.created_at.seconds-n.entity.created_at.seconds)),u}),V=U(()=>{const u=B.value,n=0,l=n+p.value;return u.slice(n,l)});return O(()=>{if(!document.getElementById("masonry-container")){console.log("ArtworkTileGrid error, masonary_wall element not found");return}}),(u,n)=>{const l=$("el-input"),v=$("el-option"),s=$("el-select"),m=$("el-button"),k=$("RouterView");return h(),g(q,null,[C("div",Ve,[d(l,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=r=>_.value=r),"prefix-icon":f(ae),placeholder:"Search artwork or artist",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),d(s,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=r=>c.value=r),placeholder:"Sort by",style:{"margin-left":"10px"}},{default:M(()=>[d(v,{label:"Sort by name",value:"name"}),d(v,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"]),d(m,{icon:"Plus",onClick:n[2]||(n[2]=r=>f(a).push({name:"new-artwork"})),color:"#000000",style:{"margin-left":"10px"},size:"small"},{default:M(()=>[G("Artwork")]),_:1})]),Ae,C("div",{id:"masonry-container",ref_key:"masonryContainer",ref:i,style:{"overflow-y":"auto",height:"100%",padding:"10px",margin:"-10px"}},[d(f(ke),{id:"masonary-wall","scroll-container":i.value,items:f(V),"column-width":250,gap:14},{default:M(({item:r})=>[d(Me,{token_meta:r},null,8,["token_meta"])]),_:1},8,["scroll-container","items"])],512),d(k)],64)}}});var Ue=Q(Re,[["__scopeId","data-v-33742f3e"]]);export{Ue as default};
