import{d as te,r as y,c as I,B as K,h as b,i as e,w as a,u as M,f as c,o as m,l as n,t as C,j as r,_ as ae,p as _e,m as ce,z as L,a as j,b as $e,C as Ce,D as je,G as Je,g as W,H as We,I as Ge,F as H,J as ue,A as G,n as Ke,K as He}from"./index.dc013b60.js";import{u as E,d as Qe}from"./plaque.34819a80.js";import{c as Xe}from"./token-meta.9b03395e.js";import{u as le}from"./plaque.e6159fd5.js";import{u as pe,g as Ye}from"./account.53acdf76.js";import{s as U,m as be,a as Se}from"./util.d8537e07.js";import{T as xe,O as Ze}from"./types.67d14e22.js";import{u as Ae}from"./breakpoints.0c301cfb.js";import{u as Pe}from"./token-meta.eb6ec882.js";import{_ as et}from"./TokenSelectList.d1c469c6.js";import{i as P,h as tt,r as at,j as lt}from"./firebaseConfig.4d01e9b5.js";import{P as nt}from"./PlaqueTokenItem.a852ccbd.js";import{u as ot}from"./gallery.c972db51.js";import"./thumbnail-image.ce276e3c.js";import"./ArtworkFilters.94cb164f.js";import"./gallery-token.f19a7c70.js";const it=g=>(_e("data-v-114b0920"),g=g(),ce(),g),st={class:"dialog-container"},rt={class:"dialog-footer"},dt=it(()=>n("div",{style:{"flex-grow":"1"}},null,-1)),ut=te({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:{}},emits:["update:show_add_token_dialog"],setup(g,{emit:l}){const p=g,u=y([]),x=y(!1),V=l,{screen_type:N}=Ae(),$=le(),q=Pe(),k=pe(),d=I({get(){return p.show_add_token_dialog},set(S){V("update:show_add_token_dialog",S)}});K(d,S=>{S&&(u.value=JSON.parse(JSON.stringify(A.value.entity.token_meta_id_list)))});const A=I(()=>$.plaque_map[p.plaque_id]),T=I(()=>q.sorted_all_token_metas),R=async()=>{x.value=!0;try{for(let[S,s]of u.value.entries()){const o=q.all_token_metas[s];if(!o)throw"Failed to find store token for token: "+s;if(o.entity.platform!=xe.Opensea)continue;const h=JSON.parse(JSON.stringify(o));h.entity.user_id=k.get_account.id,h.entity.platform=xe.OpenseaArchive;const w=await Xe(h.entity);u.value[S]=w.id}await E(p.plaque_id,{token_meta_id_list:u.value}),$.plaque_map[p.plaque_id].entity.token_meta_id_list=u.value}catch(S){U(`Error updating plaque tokens - ${S}`)}x.value=!1,d.value=!1},z=()=>{u.value=[]};return(S,s)=>{const o=c("el-button"),h=c("el-dialog");return m(),b("div",st,[e(h,{center:"",modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=w=>d.value=w),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:M(N)=="xs",top:"2vh","destroy-on-close":""},{footer:a(()=>[n("div",rt,[n("div",null,C(`Artwork in playlist: ${u.value.length}`),1),dt,e(o,{onClick:z},{default:a(()=>[r("Clear")]),_:1}),e(o,{type:"info",onClick:R,loading:x.value},{default:a(()=>[r("Save")]),_:1},8,["loading"])])]),default:a(()=>[e(et,{selected_token_meta_id_list:u.value,"onUpdate:selected_token_meta_id_list":s[0]||(s[0]=w=>u.value=w),token_meta_list:T.value,plaque_id:S.plaque_id},null,8,["selected_token_meta_id_list","token_meta_list","plaque_id"])]),_:1},8,["modelValue","fullscreen"])])}}});var _t=ae(ut,[["__scopeId","data-v-114b0920"]]);const ct={class:"controller-buttons"},pt=te({__name:"PlaqueController",props:{plaque:{}},setup(g){const l=le(),p=g,u=y(!1),x=y(!1),V=y(!1),N=y(!1),$=I({get:()=>p.plaque.entity.orientation||"landscape",set:k=>{E(p.plaque.id,{orientation:k}).then(()=>{l.plaque_map[p.plaque.id].entity.orientation=k,L({type:"success",message:"Plaque orientation updated"})}).catch(d=>{U(`Error updating plaque orientation - ${d}`)})}}),q=k=>{const d={type:k,time_sent:P.now()};E(p.plaque.id,{command:d}).then(()=>{l.plaque_map[p.plaque.id].entity.command=d,L({type:"success",message:"Command sent to plaque"})}).catch(A=>{U(`Error sending command to plaque - ${A}`)}).finally(()=>{u.value=!1,x.value=!1,V.value=!1,N.value=!1})};return(k,d)=>{const A=c("el-button"),T=c("el-radio"),R=c("el-radio-group");return m(),b("div",null,[n("div",ct,[e(A,{circle:"",text:"",loading:u.value,icon:"DArrowLeft",onClick:d[0]||(d[0]=z=>{u.value=!0,q("playlist_previous")})},null,8,["loading"]),e(A,{circle:"",text:"",loading:x.value,icon:"VideoPlay",onClick:d[1]||(d[1]=z=>{x.value=!0,q("play")})},null,8,["loading"]),e(A,{circle:"",text:"",icon:"VideoPause",loading:V.value,onClick:d[2]||(d[2]=z=>{V.value=!0,q("pause")})},null,8,["loading"]),e(A,{circle:"",text:"",icon:"DArrowRight",loading:N.value,onClick:d[3]||(d[3]=z=>{N.value=!0,q("playlist_next")})},null,8,["loading"])]),e(R,{modelValue:$.value,"onUpdate:modelValue":d[4]||(d[4]=z=>$.value=z),style:{display:"flex","flex-direction":"column","align-items":"start","margin-top":"20px"}},{default:a(()=>[e(T,{label:"landscape",size:"small"},{default:a(()=>[r("Landscape")]),_:1}),e(T,{label:"portrait",size:"small"},{default:a(()=>[r("Portrait")]),_:1}),e(T,{label:"landscape_reversed",size:"small"},{default:a(()=>[r("Landscape Reversed")]),_:1}),e(T,{label:"portrait_reversed",size:"small"},{default:a(()=>[r("Portrait Reversed")]),_:1})]),_:1},8,["modelValue"])])}}});var mt=ae(pt,[["__scopeId","data-v-100e65c8"]]);const F=g=>(_e("data-v-72e02654"),g=g(),ce(),g),yt={style:{display:"flex","align-items":"center",padding:"1em"}},ft={key:0},vt=F(()=>n("div",{style:{"flex-grow":"1"}},null,-1)),gt={class:"card-simple"},qt=F(()=>n("hr",null,null,-1)),ht=F(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),kt=F(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),wt={style:{padding:"0.3em 1em"}},Ct={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},bt={key:0,class:"card-detail"},xt={style:{padding:"0 1em"}},$t={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},St=F(()=>n("hr",null,null,-1)),At=F(()=>n("div",{style:{padding:"1em"}},"No artwork added",-1)),Pt=F(()=>n("hr",null,null,-1)),Vt={style:{display:"flex",padding:"1em"}},Nt=F(()=>n("div",{style:{"flex-grow":"1"}},null,-1)),zt={key:0,style:{padding:"1em"}},Lt={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Et={key:0},It=F(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"Associated User",-1)),Tt={key:0},Dt={key:1},Ut={style:{"font-size":"var(--el-font-size-extra-small)"}},Mt={key:1},Ft={style:{"margin-bottom":"1em"}},Ot=F(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"Machine Info",-1)),Rt={key:0,style:{"margin-bottom":"1em"}},Bt=F(()=>n("div",{class:"caption"},"Admin only commands",-1)),jt={style:{"margin-bottom":"1em"}},Jt={style:{"margin-bottom":"1em"}},Wt={style:{"margin-bottom":"1em"}},Gt={style:{"margin-bottom":"1em"}},Kt={style:{"margin-top":"1em"}},Ht=F(()=>n("div",{class:"caption"},"Enable Support VPN",-1)),Qt={style:{display:"flex","justify-content":"end"}},Xt=te({__name:"PlaqueCard",props:{plaque:{}},setup(g){const l=g,p=le();$e();const u=y("simple"),x=y(!1),V=y(!1),N=y(""),$=y(!1),q=y(!1),k=y(!1),d=y(!1),A=y(!1),T=y(!1),R=y(!1),z=y(!1),S=y(!1);P.now();const s=async()=>{$.value=!0,await E(l.plaque.id,{name:l.plaque.entity.name}).catch(t=>{U(`Error updating plaque tokens - ${t}`)}),V.value=!1,$.value=!1},o=pe(),h=Pe(),w=I(()=>D.value.length==0?null:D.value[0]),D=I(()=>{const t=h.all_token_metas;return l.plaque.entity.token_meta_id_list.map(_=>t[_])}),X=I(()=>Se(l.plaque)),ne=I(()=>{const t=l.plaque.entity.last_check_in_time;return t?new Date(t.seconds*1e3).toLocaleString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}):"N/A"}),oe=t=>new Date(t.seconds*1e3).toLocaleString("en-US",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),ie=()=>{G.confirm(`Are you sure you want to clear tokens for plaque '${l.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{E(l.plaque.id,{token_meta_id_list:[]}).then(()=>{p.plaque_map[l.plaque.id].entity.token_meta_id_list=[],L({type:"success",message:"Tokens cleared"})}).catch(t=>{L({message:`Error clearing tokens from plaque - ${t}`,type:"error",showClose:!0,duration:12e3})})})},se=()=>{G.confirm(`Are you sure you want to forget the plaque named '${l.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{E(l.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{p.plaque_map[l.plaque.id].entity.user_id="",p.plaque_map[l.plaque.id].entity.token_meta_id_list=[],L({type:"success",message:"Plaque forgotten"})}).catch(t=>{L({message:`Error forgetting plaque - ${t}`,type:"error",showClose:!0,duration:12e3})})})};K(u,t=>{t=="settings"&&l.plaque.entity.user_id&&!N.value&&Ye(l.plaque.entity.user_id).then(i=>{N.value=i.entity.email}).catch(i=>{L({message:`Error loading user account - ${i}`,type:"error",showClose:!0,duration:12e3})})});const Y=I({get:()=>Boolean(l.plaque.entity.vpn_active),set:t=>{E(l.plaque.id,{vpn_active:t}).then(()=>{p.plaque_map[l.plaque.id].entity.vpn_active=t,L({type:"success",message:"VPN setting updated"})}).catch(i=>{U(`Error updating VPN setting- ${i}`)})}}),f=I(()=>{var _,J,B;const t=(B=(J=(_=l==null?void 0:l.plaque)==null?void 0:_.entity)==null?void 0:J.machine_data)==null?void 0:B.updated_at;return t?new Date(t.seconds*1e3+t.nanoseconds/1e6).toLocaleString():"N/A"}),Ve=()=>{const t={type:"upload_logs",time_sent:P.now()};q.value=!0,E(l.plaque.id,{command:t}).then(()=>{p.plaque_map[l.plaque.id].entity.command=t,L({type:"success",message:"Command sent to plaque"})}).catch(i=>{U(`Error sending command to plaque - ${i}`)}).finally(()=>{q.value=!1})},Ne=()=>{G.confirm(`Are you sure you want to restart the plaque '${l.plaque.entity.name}'?`,"Restart plaque",{type:"warning"}).then(()=>{const t={type:"restart_machine",time_sent:P.now()};k.value=!0,E(l.plaque.id,{command:t}).then(()=>{p.plaque_map[l.plaque.id].entity.command=t,L({type:"success",message:"Command sent to plaque"})}).catch(i=>{U(`Error sending command to plaque - ${i}`)}).finally(()=>{k.value=!1})})},ze=()=>{G.confirm(`Are you sure you want to restart the app on plaque '${l.plaque.entity.name}'?`,"Restart app",{type:"warning"}).then(()=>{const t={type:"restart_app",time_sent:P.now()};d.value=!0,E(l.plaque.id,{command:t}).then(()=>{p.plaque_map[l.plaque.id].entity.command=t,L({type:"success",message:"Command sent to plaque"})}).catch(i=>{U(`Error sending command to plaque - ${i}`)}).finally(()=>{d.value=!1})})},Z=(t,i)=>E(t,{command:i}).then(()=>{p.plaque_map[t].entity.command=i,L({type:"success",message:"Command sent to plaque"})}).catch(_=>{U(`Error sending command to plaque - ${_}`)}),Le=()=>{const t={type:"display_extend",time_sent:P.now()};T.value=!0,Z(l.plaque.id,t).finally(()=>{T.value=!1})},Ee=()=>{const t={type:"display_mirror",time_sent:P.now()};R.value=!0,Z(l.plaque.id,t).finally(()=>{R.value=!1})},Ie=async()=>{G.confirm("Are you sure you want to clear all media files on this plaque? The files will have to be redownloaded if you want to play them again.","Clear files",{type:"warning"}).then(async()=>{z.value=!0,await E(l.plaque.id,{token_meta_id_list:[]}).then(()=>{p.plaque_map[l.plaque.id].entity.token_meta_id_list=[]}).catch(t=>{U(`Error clearing media files - ${t}`)}),setTimeout(()=>{const t={type:"clear_media_files",time_sent:P.now()};Z(l.plaque.id,t).finally(()=>{z.value=!1})},3e3)})},Te=async()=>{G.confirm("Are you sure you want to clear all wifi profiles on this plaque? The plaque will have to be reconnected to wifi before it can be controlled through this app.","Clear WiFi profiles",{type:"warning"}).then(async()=>{S.value=!0,await E(l.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{p.plaque_map[l.plaque.id].entity.user_id="",p.plaque_map[l.plaque.id].entity.token_meta_id_list=[]}).catch(t=>{U(`Error clearing media wifi profiles - ${t}`)}),setTimeout(()=>{const t={type:"clear_wifi_profiles",time_sent:P.now()};Z(l.plaque.id,t).finally(()=>{S.value=!1})},5e3)})},De=async t=>{const i=tt(),_=`viewer-logs/${t}`,J=at(i,_);try{const B=await lt(J);window.open(B,"_blank");return}catch(B){console.log(`downloadLogs - failed to download logs for ${t}`,B),U(`Error downloading logs - ${B}`)}return""};return(t,i)=>{const _=c("el-button"),J=c("el-tag"),B=c("el-tooltip"),me=c("el-col"),Ue=c("el-row"),Me=c("ArrowRight"),re=c("el-icon"),de=c("el-collapse-transition"),ye=c("Close"),ee=c("el-table-column"),Fe=c("el-table"),Oe=c("el-dialog"),Re=c("el-switch"),Be=c("el-card");return m(),j(Be,null,{default:a(()=>[n("div",yt,[V.value?Ce((m(),b("input",{key:1,"onUpdate:modelValue":i[0]||(i[0]=v=>l.plaque.entity.name=v),class:"edit-name-input"},null,512)),[[je,l.plaque.entity.name]]):(m(),b("h1",ft,C(l.plaque.entity.name),1)),V.value?W("",!0):(m(),j(_,{key:2,icon:M(Je),onClick:i[1]||(i[1]=v=>V.value=!0),class:"editIcon",circle:""},null,8,["icon"])),V.value?(m(),j(_,{key:3,icon:M(We),loading:$.value,onClick:s,class:"editIcon",circle:"",type:$.value?"":"success",text:""},null,8,["icon","loading","type"])):W("",!0),vt,e(B,{class:"box-item",effect:"dark",content:`Last activity ${ne.value}`,placement:"top"},{default:a(()=>[X.value?(m(),j(J,{key:0,class:"ml-2",type:"success"},{default:a(()=>[r("online")]),_:1})):(m(),j(J,{key:1,class:"ml-2",type:"danger"},{default:a(()=>[r("offline")]),_:1}))]),_:1},8,["content"])]),e(de,null,{default:a(()=>[Ce(n("section",gt,[qt,e(Ue,{style:{padding:"1em"}},{default:a(()=>[e(me,{span:12},{default:a(()=>{var v;return[ht,n("span",null,C(((v=w.value)==null?void 0:v.entity.name)||"N/A"),1)]}),_:1}),e(me,{span:12},{default:a(()=>{var v;return[kt,r(" "+C(((v=w.value)==null?void 0:v.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),n("div",wt,C(`Total artworks: ${t.plaque.entity.token_meta_id_list.length}`),1),n("div",Ct,[e(_,{type:"info",onClick:i[2]||(i[2]=v=>x.value=!0)},{default:a(()=>[r("Add Artwork")]),_:1}),e(_,{onClick:i[3]||(i[3]=v=>u.value="detail")},{default:a(()=>[r(" Details"),e(re,{class:"el-icon--right"},{default:a(()=>[e(Me)]),_:1})]),_:1})])],512),[[Ge,u.value=="simple"]])]),_:1}),e(de,null,{default:a(()=>[u.value=="detail"?(m(),b("section",bt,[n("p",xt,C(`Total artworks: ${t.plaque.entity.token_meta_id_list.length}`),1),n("div",$t,[e(_,{onClick:i[4]||(i[4]=v=>u.value="settings")},{default:a(()=>[r("Settings")]),_:1}),e(_,{onClick:ie},{default:a(()=>[r("Clear Artwork")]),_:1})]),St,D.value.length==0?(m(),b(H,{key:0},[At,Pt],64)):W("",!0),(m(!0),b(H,null,ue(D.value,v=>(m(),j(nt,{token_meta:v},null,8,["token_meta"]))),256)),n("div",Vt,[e(_,{type:"info",onClick:i[5]||(i[5]=v=>x.value=!0)},{default:a(()=>[r("Add Artwork")]),_:1}),Nt,e(_,{onClick:i[6]||(i[6]=v=>u.value="simple")},{default:a(()=>[r("Close"),e(re,{class:"el-icon--right"},{default:a(()=>[e(ye)]),_:1})]),_:1})])])):W("",!0)]),_:1}),e(de,null,{default:a(()=>{var v,fe,ve,ge,qe,he,ke,we;return[u.value=="settings"?(m(),b("section",zt,[e(mt,{plaque:l.plaque},null,8,["plaque"]),n("div",Lt,[t.plaque.entity.user_id?(m(),b("div",Et,[It,N.value?(m(),b("div",Tt,C(N.value),1)):(m(),b("div",Dt,"Loading...")),n("div",Ut,C(t.plaque.entity.user_id),1)])):(m(),b("div",Mt,"No associated user")),t.plaque.entity.user_id?(m(),j(_,{key:2,type:"danger",plain:"",onClick:se},{default:a(()=>[r("Forget Display")]),_:1})):W("",!0)]),n("div",Ft,[Ot,n("div",null,"Machine name: "+C((fe=(v=t.plaque.entity.machine_data)==null?void 0:v.machine_name)!=null?fe:"N/A"),1),n("div",null,"Version: "+C((ge=(ve=t.plaque.entity.machine_data)==null?void 0:ve.version)!=null?ge:"N/A"),1),n("div",null,"Local IP: "+C((he=(qe=t.plaque.entity.machine_data)==null?void 0:qe.local_ip)!=null?he:"N/A"),1),n("div",null,"Public IP: "+C((we=(ke=t.plaque.entity.machine_data)==null?void 0:ke.public_ip)!=null?we:"N/A"),1),n("div",null,"Updated At: "+C(f.value),1),n("div",null,"Free Space: "+C(t.plaque.entity.free_space?M(be)(t.plaque.entity.free_space):"N/A"),1)]),M(o).is_user_admin?(m(),b("div",Rt,[Bt,n("div",jt,[e(_,{plain:"",onClick:Ve,loading:q.value},{default:a(()=>[r("Upload Logs To Cloud")]),_:1},8,["loading"]),e(_,{plain:"",onClick:i[7]||(i[7]=O=>A.value=!0)},{default:a(()=>[r("View Logs")]),_:1})]),n("div",Jt,[e(_,{plain:"",onClick:Le,loading:T.value},{default:a(()=>[r("Extend Display")]),_:1},8,["loading"]),e(_,{plain:"",onClick:Ee,loading:R.value},{default:a(()=>[r("Mirror Display")]),_:1},8,["loading"])]),n("div",Wt,[e(_,{type:"danger",plain:"",onClick:ze,loading:d.value},{default:a(()=>[r("Restart App")]),_:1},8,["loading"]),e(_,{type:"danger",plain:"",onClick:Ne,loading:k.value},{default:a(()=>[r("Restart Machine")]),_:1},8,["loading"])]),n("div",Gt,[e(_,{type:"danger",plain:"",onClick:Ie,loading:z.value},{default:a(()=>[r(" Clear Media Files")]),_:1},8,["loading"]),e(_,{type:"danger",plain:"",onClick:Te,loading:S.value},{default:a(()=>[r(" Clear WiFi Profiles")]),_:1},8,["loading"])]),e(Oe,{modelValue:A.value,"onUpdate:modelValue":i[8]||(i[8]=O=>A.value=O),title:"Uploaded Logs",width:"75%"},{default:a(()=>[e(Fe,{data:t.plaque.entity.uploaded_log_files},{default:a(()=>[e(ee,{prop:"file_name",label:"File Name",width:"400"}),e(ee,{prop:"upload_time",label:"Time Uploaded"},{default:a(({row:O})=>[r(C(oe(O.upload_time)),1)]),_:1}),e(ee,{prop:"bytes",label:"Size"},{default:a(({row:O})=>[r(C(M(be)(O.bytes)),1)]),_:1}),e(ee,{fixed:"right",label:"",width:"80"},{default:a(({row:O})=>[e(_,{icon:"Download",text:"",circle:"",onClick:ra=>De(O.file_name)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"]),n("div",Kt,[Ht,e(Re,{modelValue:Y.value,"onUpdate:modelValue":i[9]||(i[9]=O=>Y.value=O),"active-text":"Enabled","inactive-text":"Off"},null,8,["modelValue"])])])):W("",!0),n("div",Qt,[e(_,{onClick:i[10]||(i[10]=O=>u.value="detail")},{default:a(()=>[r("Close"),e(re,{class:"el-icon--right"},{default:a(()=>[e(ye)]),_:1})]),_:1})])])):W("",!0)]}),_:1}),e(_t,{plaque_id:l.plaque.id,show_add_token_dialog:x.value,"onUpdate:show_add_token_dialog":i[11]||(i[11]=v=>x.value=v)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Yt=ae(Xt,[["__scopeId","data-v-72e02654"]]);const Q=g=>(_e("data-v-b9e41b2a"),g=g(),ce(),g),Zt=Q(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"Filter by gallery",-1)),ea=Q(()=>n("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"Online only",-1)),ta=Q(()=>n("div",{class:"caption"},"Sort order",-1)),aa=Q(()=>n("div",{style:{"padding-bottom":"90px"}},null,-1)),la={class:"add-button-container"},na={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},oa=Q(()=>n("div",{style:{"font-size":"17px"}},"Add plaque",-1)),ia={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},sa=te({__name:"PlaqueList",setup(g){const l=y(!1),{screen_type:p}=Ae(),u=y(!1),x=$e(),V=pe(),N=ot(),$=y(""),q=y(localStorage.getItem("plaque_list_filter_by_gallery")||"");K(q,s=>{localStorage.setItem("plaque_list_filter_by_gallery",s)});const k=y(localStorage.getItem("online_filter")==="true"||!1);K(k,s=>{if(s){localStorage.setItem("online_filter","true");return}localStorage.setItem("online_filter","false")});const d=y(localStorage.getItem("plaque_list_sort_order")||"name");K(d,s=>{localStorage.setItem("plaque_list_sort_order",s)});const A=le(),T=async()=>{l.value=!0,await Qe({name:"Test Plaque",user_id:V.get_account.id,token_meta_id_list:[],created_at:P.now(),updated_at:P.now(),orientation:Ze.Landscape,command:{type:"",time_sent:P.fromMillis(0)},last_check_in_time:P.fromMillis(0),vpn_active:!1,machine_data:{machine_name:"",version:"",local_ip:"",public_ip:"",updated_at:P.fromMillis(0)},free_space:0,local_media_list:[]}).catch(s=>L({message:`Error creating test plaque- ${s}`,type:"error",showClose:!0,duration:12e3})),l.value=!1,u.value=!1},R=I(()=>JSON.parse(JSON.stringify(A.all_plaque_list)).sort((o,h)=>{const w=o.entity.name.toLowerCase(),D=h.entity.name.toLowerCase();return w<D?-1:w>D?1:0})),z=I(()=>{const s=new Set;return q.value&&N.gallery_plaque_list.forEach(o=>{o.entity.gallery_id==q.value&&s.add(o.entity.plaque_id)}),s}),S=I(()=>{let s=[...R.value];return s=s.filter(o=>o.entity.name||o.entity.user_id||o.entity.token_meta_id_list.length>0),q.value&&(s=s.filter(o=>z.value.has(o.id))),k.value&&(s=s.filter(o=>Se(o))),d.value=="name"?s=s.sort((o,h)=>o.entity.name.localeCompare(h.entity.name)):d.value=="last_check_in_time"&&(s=s.sort((o,h)=>o.entity.last_check_in_time==null&&h.entity.last_check_in_time==null?0:o.entity.last_check_in_time==null?1:h.entity.last_check_in_time==null?-1:h.entity.last_check_in_time.seconds-o.entity.last_check_in_time.seconds)),$.value?s.filter(o=>o.entity.name.toLowerCase().includes($.value.toLowerCase())):s});return(s,o)=>{const h=c("el-input"),w=c("el-button"),D=c("el-option"),X=c("el-select"),ne=c("el-switch"),oe=c("el-popover"),ie=c("Plus"),se=c("el-icon"),Y=c("el-dialog");return m(),b(H,null,[n("div",{class:"subheader",style:Ke([{display:"flex","align-items":"center"},M(p)=="xs"?"padding: 0px 8px 10px;":""])},[e(h,{modelValue:$.value,"onUpdate:modelValue":o[0]||(o[0]=f=>$.value=f),"prefix-icon":M(He),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),e(oe,{placement:"bottom",title:"Plaque Filters",width:300,trigger:"click"},{reference:a(()=>[e(w,{icon:"Filter",style:{"margin-left":"10px"},type:"info",size:"small"},{default:a(()=>[r("Filters")]),_:1})]),default:a(()=>[Zt,e(X,{modelValue:q.value,"onUpdate:modelValue":o[1]||(o[1]=f=>q.value=f),placeholder:"Filter by gallery",style:{width:"260px","margin-bottom":"12px"}},{default:a(()=>[e(D,{label:"All plaques",value:""}),(m(!0),b(H,null,ue(M(N).gallery_list,f=>(m(),j(D,{key:f.id,label:`${f.entity.name}`,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),ea,e(ne,{modelValue:k.value,"onUpdate:modelValue":o[2]||(o[2]=f=>k.value=f),style:{"margin-bottom":"1em"}},null,8,["modelValue"]),ta,e(X,{modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=f=>d.value=f),placeholder:"Sort by",class:"filter-select"},{default:a(()=>[e(D,{label:"Sort by name",value:"name"}),e(D,{label:"Sort by last activity",value:"last_check_in_time"})]),_:1},8,["modelValue"])]),_:1}),e(w,{icon:"Camera",type:"info",onClick:o[4]||(o[4]=f=>M(x).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:a(()=>[r("Scan")]),_:1})],4),aa,(m(!0),b(H,null,ue(S.value,f=>(m(),j(Yt,{plaque:f,key:f.id},null,8,["plaque"]))),128)),n("div",la,[n("div",na,[n("div",{class:"add-button",onClick:o[5]||(o[5]=f=>u.value=!0)},[e(se,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:a(()=>[e(ie)]),_:1}),oa])])]),e(Y,{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=f=>u.value=f),title:"Add plaque",width:M(p)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:a(()=>[n("div",ia,[e(w,{onClick:o[6]||(o[6]=f=>{M(x).push("qr-scan"),u.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:a(()=>[r("Scan Plaque QR Code")]),_:1}),e(w,{icon:"plus",onClick:T,loading:l.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:a(()=>[r("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var xa=ae(sa,[["__scopeId","data-v-b9e41b2a"]]);export{xa as default};
