import{_ as z,d as J,r as $,c as T,v as se,b as c,o as r,e as k,i as e,w as a,k as o,t as N,j as _,f as v,x as ie,y as U,z as F,u as W,g as I,A as G,B as de,C as ue,h as V,D as re,G as _e,F as j,H as X,I as H,q as E,J as ce}from"./index.904c8176.js";import{u as L,c as pe}from"./plaque.738893ff.js";import{c as me}from"./token-meta.ba91ce12.js";import{u as M}from"./plaque.40e3e5ca.js";import{u as Y}from"./account.806f39a5.js";import{s as Z}from"./util.7b999d87.js";import{T as Q}from"./types.ab61d3d9.js";import{u as ee}from"./breakpoints.735c1f64.js";import{u as te}from"./token-meta.e0f2a8b7.js";import{_ as fe}from"./TokenSelectList.706ca0fa.js";import{_ as ve}from"./PlaqueTokenItem.f8e1a2c0.js";import{n as K}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.660b0066.js";import"./thumbnail-image.da005d16.js";const ye=s=>(U("data-v-cc2989e6"),s=s(),F(),s),ge={class:"dialog-container"},ke={class:"dialog-footer"},qe=ye(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),he=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(s,{emit:i}){const h=s,f=$([]),u=$(!1),{screen_type:A}=ee(),q=M(),y=te(),D=Y(),w=T({get(){return h.show_add_token_dialog},set(m){i("update:show_add_token_dialog",m)}});se(w,m=>{m&&(f.value=JSON.parse(JSON.stringify(S.value.entity.token_meta_id_list)))});const S=T(()=>q.plaque_map[h.plaque_id]),P=T(()=>y.sorted_all_token_metas),x=async()=>{u.value=!0;try{for(let[m,l]of f.value.entries()){const t=y.all_token_metas[l];if(!t)throw"Failed to find store token for token: "+l;if(t.entity.platform!=Q.Opensea)continue;const n=JSON.parse(JSON.stringify(t));n.entity.user_id=D.get_account.id,n.entity.platform=Q.OpenseaArchive;const C=await me(n.entity);f.value[m]=C.id}await L(h.plaque_id,{token_meta_id_list:f.value}),q.plaque_map[h.plaque_id].entity.token_meta_id_list=f.value}catch(m){Z(`Error updating plaque tokens - ${m}`)}u.value=!1,w.value=!1},p=()=>{f.value=[]};return(m,l)=>{const t=c("el-button"),n=c("el-dialog");return r(),k("div",ge,[e(n,{center:"",modelValue:v(w),"onUpdate:modelValue":l[1]||(l[1]=C=>ie(w)?w.value=C:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:v(A)=="xs",top:"2vh"},{footer:a(()=>[o("div",ke,[o("div",null,N(`Artwork in playlist: ${f.value.length}`),1),qe,e(t,{onClick:p},{default:a(()=>[_("Clear")]),_:1}),e(t,{type:"info",onClick:x,loading:u.value},{default:a(()=>[_("Save")]),_:1},8,["loading"])])]),default:a(()=>[e(fe,{selected_token_meta_id_list:f.value,"onUpdate:selected_token_meta_id_list":l[0]||(l[0]=C=>f.value=C),token_meta_list:v(P)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var we=z(he,[["__scopeId","data-v-cc2989e6"]]);const b=s=>(U("data-v-45b70c94"),s=s(),F(),s),xe={style:{display:"flex","align-items":"center",padding:"1em"}},Ce={key:0},$e=b(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),be={class:"card-simple"},Ae=b(()=>o("hr",null,null,-1)),Pe=b(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Se=b(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ne={style:{padding:"0.3em 1em"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Ve={key:0,class:"card-detail"},Ie={style:{padding:"0 1em"}},De={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ee=b(()=>o("hr",null,null,-1)),Le=b(()=>o("div",{style:{padding:"1em"}},"No artwork added",-1)),je=b(()=>o("hr",null,null,-1)),Be={style:{display:"flex",padding:"1em"}},Oe=b(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),ze={key:0,style:{padding:"1em"}},Je={style:{display:"flex","justify-content":"space-between"}},Ue={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Fe={key:0},Me=b(()=>o("div",null,"Associated User ID:",-1)),Re={key:1},Ge={style:{display:"flex","justify-content":"end"}},He=J({__name:"PlaqueCard",props:{plaque:null},setup(s){const i=s,h=M(),f=W(),u=$("simple"),A=$(!1),q=$(!1),y=$(!1),D=async()=>{y.value=!0,await L(i.plaque.id,{name:i.plaque.entity.name}).catch(l=>{Z(`Error updating plaque tokens - ${l}`)}),q.value=!1,y.value=!1},w=te(),S=T(()=>P.value.length==0?null:P.value[0]),P=T(()=>{const l=w.archive_token_meta_map;return i.plaque.entity.token_meta_id_list.map(n=>l[n])}),x=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${i.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{L(i.plaque.id,{token_meta_id_list:[]}).then(()=>{h.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Tokens cleared"})}).catch(l=>{E({message:`Error clearing tokens from plaque - ${l}`,type:"error",showClose:!0,duration:12e3})})})},p=()=>{H.confirm(`Are you sure you want to forget the plaque named '${i.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{L(i.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{h.plaque_map[i.plaque.id].entity.user_id="",h.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Plaque forgotten"})}).catch(l=>{E({message:`Error forgetting plaque - ${l}`,type:"error",showClose:!0,duration:12e3})})})},m=()=>{const l=f.resolve({name:"preview-plaque",params:{plaque_id:i.plaque.id}});window.open(l.href)};return(l,t)=>{const n=c("el-button"),C=c("el-tag"),g=c("el-col"),ae=c("el-row"),le=c("ArrowRight"),B=c("el-icon"),O=c("el-collapse-transition"),R=c("Close"),ne=c("el-card");return r(),I(ne,null,{default:a(()=>[o("div",xe,[q.value?G((r(),k("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=d=>i.plaque.entity.name=d),class:"edit-name-input"},null,512)),[[de,i.plaque.entity.name]]):(r(),k("h1",Ce,N(i.plaque.entity.name),1)),q.value?V("",!0):(r(),I(n,{key:2,icon:v(ue),onClick:t[1]||(t[1]=d=>q.value=!0),class:"editIcon",circle:""},null,8,["icon"])),q.value?(r(),I(n,{key:3,icon:v(re),loading:y.value,onClick:D,class:"editIcon",circle:"",type:y.value?"":"success",text:""},null,8,["icon","loading","type"])):V("",!0),$e,e(C,{class:"ml-2",type:"success"},{default:a(()=>[_("online")]),_:1})]),e(O,null,{default:a(()=>[G(o("section",be,[Ae,e(ae,{style:{padding:"1em"}},{default:a(()=>[e(g,{span:12},{default:a(()=>{var d;return[Pe,o("span",null,N(((d=v(S))==null?void 0:d.entity.name)||"N/A"),1)]}),_:1}),e(g,{span:12},{default:a(()=>{var d;return[Se,_(" "+N(((d=v(S))==null?void 0:d.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),o("div",Ne,N(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),o("div",Te,[e(n,{type:"info",onClick:t[2]||(t[2]=d=>A.value=!0)},{default:a(()=>[_("Add Artwork")]),_:1}),e(n,{onClick:t[3]||(t[3]=d=>u.value="detail")},{default:a(()=>[_(" Details"),e(B,{class:"el-icon--right"},{default:a(()=>[e(le)]),_:1})]),_:1})])],512),[[_e,u.value=="simple"]])]),_:1}),e(O,null,{default:a(()=>[u.value=="detail"?(r(),k("section",Ve,[o("p",Ie,N(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),o("div",De,[e(n,{onClick:t[4]||(t[4]=d=>u.value="settings")},{default:a(()=>[_("Settings")]),_:1}),e(n,{onClick:x},{default:a(()=>[_("Clear Artwork")]),_:1})]),Ee,v(P).length==0?(r(),k(j,{key:0},[Le,je],64)):V("",!0),(r(!0),k(j,null,X(v(P),d=>(r(),I(ve,{token_meta:d},null,8,["token_meta"]))),256)),o("div",Be,[e(n,{type:"info",onClick:t[5]||(t[5]=d=>A.value=!0)},{default:a(()=>[_("Add Artwork")]),_:1}),Oe,e(n,{onClick:t[6]||(t[6]=d=>u.value="simple")},{default:a(()=>[_("Close"),e(B,{class:"el-icon--right"},{default:a(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(O,null,{default:a(()=>[u.value=="settings"?(r(),k("section",ze,[o("div",Je,[e(n,null,{default:a(()=>[_("Preview Art")]),_:1}),e(n,{onClick:m},{default:a(()=>[_("Preview Plaque")]),_:1})]),o("div",Ue,[s.plaque.entity.user_id?(r(),k("div",Fe,[Me,o("div",null,N(s.plaque.entity.user_id),1)])):(r(),k("div",Re,"No associated user")),s.plaque.entity.user_id?(r(),I(n,{key:2,type:"danger",plain:"",onClick:p},{default:a(()=>[_("Forget Display")]),_:1})):V("",!0)]),o("div",Ge,[e(n,{onClick:t[7]||(t[7]=d=>u.value="detail")},{default:a(()=>[_("Close"),e(B,{class:"el-icon--right"},{default:a(()=>[e(R)]),_:1})]),_:1})])])):V("",!0)]),_:1}),e(we,{plaque_id:i.plaque.id,show_add_token_dialog:A.value,"onUpdate:show_add_token_dialog":t[8]||(t[8]=d=>A.value=d)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Qe=z(He,[["__scopeId","data-v-45b70c94"]]);const oe=s=>(U("data-v-693bb944"),s=s(),F(),s),Ke={class:"subheader"},We=oe(()=>o("div",{style:{"padding-bottom":"40px"}},null,-1)),Xe={class:"add-button-container"},Ye={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ze=oe(()=>o("div",{style:{"font-size":"17px"}},"Add plaque",-1)),et={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},tt=J({__name:"PlaqueList",setup(s){const i=$(!1),{width:h,screen_type:f}=ee(),u=$(!1),A=W(),q=Y(),y=$(""),D=M(),w=async()=>{i.value=!0,await pe({name:"Test Plaque",user_id:q.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(x=>E({message:`Error creating test plaque- ${x}`,type:"error",showClose:!0,duration:12e3})),i.value=!1,u.value=!1},S=T(()=>JSON.parse(JSON.stringify(D.all_plaque_list)).sort((p,m)=>{const l=p.entity.name.toLowerCase(),t=m.entity.name.toLowerCase();return l<t?-1:l>t?1:0})),P=T(()=>y?S.value.filter(x=>x.entity.name.toLowerCase().includes(y.value.toLowerCase())):S.value);return(x,p)=>{const m=c("el-input"),l=c("Plus"),t=c("el-icon"),n=c("el-button"),C=c("el-dialog");return r(),k(j,null,[o("div",Ke,[e(m,{modelValue:y.value,"onUpdate:modelValue":p[0]||(p[0]=g=>y.value=g),"prefix-icon":v(ce),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"])]),We,(r(!0),k(j,null,X(v(P),g=>(r(),I(Qe,{plaque:g,key:g.id},null,8,["plaque"]))),128)),o("div",Xe,[o("div",Ye,[o("div",{class:"add-button",onClick:p[1]||(p[1]=g=>u.value=!0)},[e(t,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:a(()=>[e(l)]),_:1}),Ze])])]),e(C,{modelValue:u.value,"onUpdate:modelValue":p[3]||(p[3]=g=>u.value=g),title:"Add plaque",width:v(f)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:a(()=>[o("div",et,[e(n,{onClick:p[2]||(p[2]=g=>{v(A).push("qr-scan"),u.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:a(()=>[_("Scan Plaque QR Code")]),_:1}),e(n,{icon:"plus",onClick:w,loading:i.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:a(()=>[_("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var vt=z(tt,[["__scopeId","data-v-693bb944"]]);export{vt as default};
