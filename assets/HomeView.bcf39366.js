import{_ as T,a as M,b as U,c as F}from"./search-icon.822e7617.js";import{_ as H,d as I,u as L,a as P,r as V,c as j,b as _,o as l,e as k,w as d,f as s,g as b,h as x,F as S,i as r,j as C,k as $,t as z,p as O,l as J,m as K,E as N,R as Q}from"./index.bd322ca6.js";import{u as R}from"./account.53dd0585.js";import{u as W}from"./breakpoints.abba5afc.js";import{s as X,a as B,o as Y}from"./firebaseConfig.d7a6b5a9.js";import{s as u}from"./util.6b9b1be5.js";import{u as Z}from"./plaque.ea6a01bb.js";import{u as ee}from"./token-meta.28342bcd.js";import{u as te}from"./plaque.093acf64.js";import{u as ae}from"./gallery.eb4c71a9.js";import"./types.6a5ef88e.js";import"./token-meta.2d60a689.js";import"./gallery.82c2a091.js";const D=g=>(O("data-v-555e63c2"),g=g(),J(),g),oe=D(()=>$("div",{style:{"flex-grow":"1"}},null,-1)),se=D(()=>$("div",{style:{"flex-grow":"1"}},null,-1)),ne={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},le=I({__name:"Header",setup(g){const c=L(),m=P(),f=R(),i=V(!1),{width:A,screen_type:y}=W(),p=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&c.push({name:e.paneName})},w=j(()=>{const e=f.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),q=()=>{i.value=!0,X(B).then(()=>{}).catch(e=>{u(e)}).finally(()=>{i.value=!1})},o=e=>new URL({"../assets/base.css":T,"../assets/logo.png":M,"../assets/logo.svg":U,"../assets/search-icon.svg":F}[`../assets/${e}`],self.location).href;return(e,t)=>{const h=_("el-image"),v=_("el-button"),n=_("el-tab-pane"),a=_("el-tabs"),G=_("el-header");return l(),k(G,{class:"header"},{default:d(()=>[s(y)!="xs"?(l(),k(h,{key:0,src:o("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):b("",!0),s(c).currentRoute.value.name=="qr-scan"?(l(),x(S,{key:1},[oe,r(v,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=E=>s(c).push("plaque-list"))},{default:d(()=>[C(" Cancel ")]),_:1})],64)):(l(),x(S,{key:2},[r(a,{modelValue:s(m).name,"onUpdate:modelValue":t[1]||(t[1]=E=>s(m).name=E),onTabClick:p},{default:d(()=>[r(n,{label:"Plaques",name:"plaque-list"}),r(n,{label:"Artwork",name:"token-list"}),r(n,{label:"Galleries",name:"gallery-list"})]),_:1},8,["modelValue"]),se,s(y)!="xs"?(l(),x("div",ne,[$("div",null,z(s(w)),1),s(f).is_user_admin?(l(),k(v,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:d(()=>[C("Admin")]),_:1})):b("",!0)])):b("",!0),r(v,{onClick:q,style:{"margin-left":"1em"},loading:i.value},{default:d(()=>[C("Logout")]),_:1},8,["loading"])],64))]),_:1})}}});var re=H(le,[["__scopeId","data-v-555e63c2"]]);const ce=I({__name:"HomeView",setup(g){const c=R(),m=Z(),f=ee(),i=ae(),A=L(),y=V(!1),p=V(),w=P();K(async()=>{p.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),Y(B,async o=>{console.log("onAuthStateChanged",o),o?(p.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await q(o.uid),p.value.close()):(c.setAccount(null),p.value.close(),A.push({name:"login",query:{redir:window.location.href}}))})});async function q(o){await c.loadAccount(o),await i.loadGalleryList(o).catch(a=>u(`Error loading galleries - ${a}`));const e=m.loadPlaques(o).catch(a=>u(`Error loading plaques - ${a}`)),t=m.loadGalleryPlaques(i.gallery_list).catch(a=>u(`Error loading gallery plaques - ${a}`)),h=f.loadArchiveTokenMetas(o).catch(a=>u(`Error loading archive token metas - ${a}`)),v=f.loadGalleryTokenMetas(i.gallery_list).catch(a=>u(`Error loading token metas - ${a}`));await Promise.all([e,t,h,v]);const n=w.query.plaque_id;n&&typeof n=="string"&&!m.plaque_map[n]&&await te(n,{user_id:c.get_account.id,token_meta_id_list:[]}).catch(a=>{u(`Error adding plaque from query param = ${a}`)}),y.value=!0}return(o,e)=>{const t=_("el-main"),h=_("el-container");return l(),k(h,{style:{height:"100%","flex-direction":"column"}},{default:d(()=>[r(re),r(t,{style:{"background-color":"#DAD9D7"}},{default:d(()=>[y.value?(l(),k(s(Q),{key:0})):b("",!0)]),_:1})]),_:1})}}});var we=H(ce,[["__scopeId","data-v-5ccd8969"]]);export{we as default};
