import{d as F,P as Y,Q as J,r as T,o as h,h as x,F as q,I as N,M as j,f as p,S as X,j as G,t as A,T as Z,U as ee,m as O,z as te,_ as Q,u as K,L as ne,c as U,b as R,k as b,n as P,i as _,w as H,V as D,e as oe,g as le,K as ae,p as ie,l as se}from"./index.53a82732.js";import{u as re}from"./thumbnail-image.0034c36b.js";import{c as ce,d as ue}from"./types.6a5ef88e.js";import{s as de}from"./util.38c23d05.js";import{u as me}from"./token-meta.2fff2867.js";import"./firebaseConfig.d7a6b5a9.js";import"./token-meta.2d60a689.js";import"./account.0c809fe0.js";const _e={columnWidth:400,gap:0,keyMapper:(t,a,C,f)=>f,minColumns:1,maxColumns:void 0,rtl:!1,scrollContainer:null,ssrColumns:0};function fe({columns:t,columnWidth:a,emit:C,gap:f,items:i,maxColumns:d,minColumns:r,nextTick:y,onBeforeUnmount:B,onMounted:M,rtl:m,scrollContainer:n,ssrColumns:l,vue:v,wall:c,watch:u}){function k(o,e,w,L){const W=s(w);return L+e+W<=o?k(o,e,w+1,L+e+W):w}function s(o){const e=Array.isArray(a.value)?a.value:[a.value];return e[o%e.length]}function g(){const o=k(c.value.getBoundingClientRect().width,f.value,0,-f.value),e=V(S(o));return e>0?e:1}function S(o){const e=d==null?void 0:d.value;return e&&o>e?e:o}function V(o){const e=r==null?void 0:r.value;return e&&o<e?e:o}function E(o){return[...new Array(o)].map(()=>[])}if(l.value>0){const o=E(l.value);i.value.forEach((e,w)=>o[w%l.value].push(w)),t.value=o}async function $(o){if(o>=i.value.length)return;await y();const e=[...c.value.children];m.value&&e.reverse();const w=e.reduce((L,W)=>W.getBoundingClientRect().height<L.getBoundingClientRect().height?W:L);t.value[+w.dataset.index].push(o),await $(o+1)}async function I(o=!1){if(t.value.length===g()&&!o){C(v===2?"redraw-skip":"redrawSkip");return}t.value=E(g());const e=n==null?void 0:n.value,w=e?e.scrollTop:window.scrollY;await $(0),e?e.scrollBy({top:w-e.scrollTop}):window.scrollTo({top:w}),C("redraw")}const z=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>I());return M(()=>{I(),z==null||z.observe(c.value)}),B(()=>z==null?void 0:z.unobserve(c.value)),u([i,m],()=>I(!0)),u([a,f,r,d],()=>I()),{getColumnWidthTarget:s}}const pe=["data-index"],ve=F({__name:"masonry-wall",props:Y({columnWidth:{},items:{},gap:{},rtl:{type:Boolean},ssrColumns:{},scrollContainer:{},minColumns:{},maxColumns:{},keyMapper:{type:Function}},_e),emits:["redraw","redrawSkip"],setup(t,{emit:a}){const C=t,{columnWidth:f,items:i,gap:d,rtl:r,ssrColumns:y,scrollContainer:B,minColumns:M,maxColumns:m,keyMapper:n}=J(C),l=T([]),v=T(),{getColumnWidthTarget:c}=fe({columns:l,columnWidth:f,emit:a,gap:d,items:i,keyMapper:n,maxColumns:m,minColumns:M,nextTick:Z,onBeforeUnmount:ee,onMounted:O,rtl:r,scrollContainer:B,ssrColumns:y,vue:3,wall:v,watch:te});return(u,k)=>(h(),x("div",{ref_key:"wall",ref:v,class:"masonry-wall",style:j({display:"flex",gap:`${p(d)}px`})},[(h(!0),x(q,null,N(l.value,(s,g)=>(h(),x("div",{key:g,class:"masonry-column","data-index":g,style:j({display:"flex","flex-basis":`${p(c)(g)}px`,"flex-direction":"column","flex-grow":1,gap:`${p(d)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(h(!0),x(q,null,N(s,(S,V)=>(h(),x("div",{key:p(n)(p(i)[S],g,V,S),class:"masonry-item"},[X(u.$slots,"default",{item:p(i)[S],column:g,row:V,index:S},()=>[G(A(p(i)[S]),1)])]))),128))],12,pe))),128))],4))}}),ke=(()=>{const t=ve;return t.install=a=>{a.component("MasonryWall",t)},t})();const ye=["src"],ge={class:"header"},he={class:"platform"},we={style:{"font-size":"1.6em","font-weight":"bold"}},xe={key:0},Ce={key:1,style:{"font-weight":"bold"}},be={key:3,style:{height:"32px"}},Te={style:{"font-size":"0.9em","line-height":"1.3em"}},Se=F({__name:"ArtworkTile",props:{token_meta:null},setup(t){const a=t,C=K(),f=re(ne(a,"token_meta")),i=T(!1),d=T(0),r=T(),y=T(),B=U(()=>ce(a.token_meta.entity.platform)),M=async()=>{const c=await ue(a.token_meta);if(!c){de("Error getting source file");return}window.open(c,"_blank")},m=()=>{const c=C.resolve({name:"preview-plaque",params:{token_meta_id:a.token_meta.id}});window.open(c.href)},n=()=>{window.open(a.token_meta.entity.public_link,"_blank")},l=()=>{window.open(a.token_meta.entity.artist_social_link,"_blank")};function v(c){if(!r.value){console.log("animateDivHeight - error finding tile container");return}if(c&&d.value==0&&(console.log("offset height",r.value.offsetHeight),d.value=r.value.offsetHeight),!y.value){console.log("animateDivHeight - error finding detail container");return}console.log("tile container before:",r.value.offsetHeight),console.log("detail container before:",y.value.offsetHeight);let u;c?u=y.value.offsetHeight-8:u=d.value;const k=300,s=10,g=r.value.offsetHeight,S=u-g,V=Math.ceil(k/s),E=S/V;console.log("target height",u);let $=0;const I=setInterval(()=>{$>=V&&(r.value.style.height=u+"px",console.log("tile container after:",r.value.offsetHeight),console.log("detail container after:",y.value.offsetHeight),console.log("detail container after:",y.value.offsetHeight),clearInterval(I)),$++;const z=g+E*$;r.value.style.height=z+"px"},s)}return(c,u)=>{const k=R("el-button"),s=R("el-tooltip");return h(),x("div",{ref_key:"tile_container",ref:r,class:"custom-card",onClick:u[1]||(u[1]=()=>{i.value=!i.value,v(i.value)})},[b("img",{class:P(i.value?"absolute":""),src:p(f)},null,10,ye),b("div",{class:P(["transition absolute",i.value?"hide-blur":"show-blur"])},[b("div",ge,A(`${t.token_meta.entity.name} | ${t.token_meta.entity.artist}`),1),b("div",he,A(p(B)),1)],2),b("div",{ref_key:"detail_container",ref:y,class:P(["detail-container transition",i.value?"show-blur":"hide-blur absolute-no-b"])},[b("div",we,A(t.token_meta.entity.name),1),t.token_meta.entity.artist_social_link?(h(),x("div",xe,[_(k,{link:"",style:{"font-weight":"bold",display:"block"},onClick:D(l,["stop"])},{default:H(()=>[G(A(t.token_meta.entity.artist),1)]),_:1},8,["onClick"])])):(h(),x("div",Ce,A(t.token_meta.entity.artist),1)),i.value?(h(),x(q,{key:2},[_(s,{class:"box-item",effect:"dark",content:"Download art",placement:"top"},{default:H(()=>[_(k,{icon:"Download",text:"",circle:"",onClick:D(M,["stop"])},null,8,["onClick"])]),_:1}),_(s,{class:"box-item",effect:"dark",content:"Preview plaque",placement:"top"},{default:H(()=>[_(k,{icon:"Tickets",text:"",circle:"",onClick:D(m,["stop"])},null,8,["onClick"])]),_:1}),t.token_meta.entity.public_link?(h(),oe(s,{key:0,class:"box-item",effect:"dark",content:"QR Code Link",placement:"top"},{default:H(()=>[_(k,{icon:"Link",text:"",circle:"",onClick:D(n,["stop"])},null,8,["onClick"])]),_:1})):le("",!0),_(s,{class:"box-item",effect:"dark",content:"Edit art data",placement:"top"},{default:H(()=>[_(k,{icon:"Edit",text:"",circle:"",onClick:u[0]||(u[0]=D(g=>p(C).push({name:"edit-artwork",params:{token_meta_id:a.token_meta.id}}),["stop"]))})]),_:1})],64)):(h(),x("div",be)),b("div",Te,A(t.token_meta.entity.description),1)],2)],512)}}});var He=Q(Se,[["__scopeId","data-v-2d1da4cd"]]);const Be=t=>(ie("data-v-33742f3e"),t=t(),se(),t),Me={class:"subheader",style:{display:"flex","align-items":"center"}},Ve=Be(()=>b("div",{style:{"padding-bottom":"40px"}},null,-1)),Ae=F({__name:"ArtworkTileGrid",setup(t){const a=K(),C=me(),f=T(""),i=T(null),d=T(localStorage.getItem("token_list_sort_order")||"name"),r=T(1e3),y=U(()=>C.sorted_all_token_metas),B=U(()=>{let m=y.value.filter(n=>{var l,v;return((l=n.entity.artist)==null?void 0:l.toLowerCase().includes(f.value.toLowerCase()))||((v=n.entity.name)==null?void 0:v.toLowerCase().includes(f.value.toLowerCase()))});return d.value==="name"?m=m.sort((n,l)=>n.entity.name.localeCompare(l.entity.name)):d.value==="created_at"&&(m=m.sort((n,l)=>n.entity.created_at==null&&l.entity.created_at==null?0:n.entity.created_at==null?1:l.entity.created_at==null?-1:l.entity.created_at.seconds-n.entity.created_at.seconds)),m}),M=U(()=>{const m=B.value,n=0,l=n+r.value;return m.slice(n,l)});return O(()=>{if(!document.getElementById("masonry-container")){console.log("ArtworkTileGrid error, masonary_wall element not found");return}}),(m,n)=>{const l=R("el-input"),v=R("el-option"),c=R("el-select"),u=R("el-button"),k=R("RouterView");return h(),x(q,null,[b("div",Me,[_(l,{modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=s=>f.value=s),"prefix-icon":p(ae),placeholder:"Search artwork or artist",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),_(c,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=s=>d.value=s),placeholder:"Sort by",style:{"margin-left":"10px"}},{default:H(()=>[_(v,{label:"Sort by name",value:"name"}),_(v,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"]),_(u,{icon:"Plus",onClick:n[2]||(n[2]=s=>p(a).push({name:"new-artwork"})),color:"#000000",style:{"margin-left":"10px"},size:"small"},{default:H(()=>[G("Artwork")]),_:1})]),Ve,b("div",{id:"masonry-container",ref_key:"masonryContainer",ref:i,style:{"overflow-y":"auto",height:"100%",padding:"10px",margin:"-10px"}},[_(p(ke),{id:"masonary-wall","scroll-container":i.value,items:p(M),"column-width":250,gap:14},{default:H(({item:s})=>[_(He,{token_meta:s},null,8,["token_meta"])]),_:1},8,["scroll-container","items"])],512),_(k)],64)}}});var Ue=Q(Ae,[["__scopeId","data-v-33742f3e"]]);export{Ue as default};
