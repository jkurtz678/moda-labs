import{d as D,c as N,r as c,o as u,b as q,i as e,h as t,t as A,e as v,F as B,_ as F,k as x,v as se,w as o,x as R,y as W,g as I,z as M,f as L,A as ne,B as J,C as G,j as h,D as le,G as ae,H as ie,I as H,p as j,u as _e}from"./index.15049fac.js";import{u as z,c as de}from"./plaque.04b9e0a4.js";import{c as re}from"./token-meta.6824a539.js";import{u as X}from"./plaque.141bc630.js";import{i as ue,u as Y,T as Q,s as Z,j as K}from"./account.ae2eb44e.js";import{_ as ce,a as pe,b as me,c as fe,u as ee,d as te}from"./token-meta.c58fd0c8.js";import{_ as ve}from"./PlaqueTokenItem.43dd20d8.js";const ge=e("hr",{class:"hr"},null,-1),ye={class:"card-flex-container"},he={style:{display:"flex","align-items":"center",margin:"5px 25px 5px 0px"}},ke={style:{flex:"3 1 0%"}},we={class:"bold"},qe={class:"bold"},xe={style:{"margin-right":"35px",opacity:"0.5"}},$e=D({props:{in_list:{type:Boolean},token:null},emits:["update_token_list"],setup(l,{emit:_}){const d=l,r=N(()=>ue(d.token.entity.platform)),p=m=>new URL({"../assets/base.css":ce,"../assets/logo.png":pe,"../assets/logo.svg":me,"../assets/search-icon.svg":fe}[`../assets/${m}`],self.location).href;return(m,P)=>{const T=c("el-image"),S=c("el-button");return u(),q(B,null,[ge,e("div",ye,[e("div",he,[t(T,{src:d.token.entity.thumbnail_url||p("logo.png"),style:{width:"50px",height:"50px"},fit:"contain"},null,8,["src"])]),e("div",ke,[e("p",we,A(d.token.entity.name),1),e("p",qe,A(d.token.entity.artist),1)]),e("div",xe,A(v(r)),1),t(S,{icon:l.in_list?"close":"plus",type:l.in_list?"danger":"success",plain:"",circle:"",onClick:P[0]||(P[0]=$=>_("update_token_list",d.token.id))},null,8,["icon","type"])])],64)}}});const oe=l=>(J("data-v-74e16b08"),l=l(),G(),l),Ce={class:"dialog-container"},be={key:0},Se=oe(()=>e("hr",{class:"hr"},null,-1)),Ae={class:"dialog-footer"},Pe=oe(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),Te=h("Clear"),Ne=h("Save"),Ve=D({props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(l,{emit:_}){const d=l,r=x([]),p=x(!1),m=x(""),{screen_type:P}=ee(),T=X(),S=te(),$=Y(),g=N({get(){return d.show_add_token_dialog},set(i){_("update:show_add_token_dialog",i)}});se(g,i=>{i&&(r.value=JSON.parse(JSON.stringify(a.value.entity.token_meta_id_list)))});const C=N(()=>Object.values(S.all_token_metas)),y=N(()=>{const i=[];if(C!=null&&C.value)for(let s of C==null?void 0:C.value)T.meta_in_playlist(d.plaque_id,s.id)?i.unshift(s):i.push(s);return m.value.trim()!==""?i.filter(s=>{var k,w;return((k=s.entity.artist)==null?void 0:k.toLowerCase().includes(m.value.toLowerCase()))||((w=s.entity.name)==null?void 0:w.toLowerCase().includes(m.value.toLowerCase()))}):i}),a=N(()=>T.plaque_map[d.plaque_id]),f=N(()=>{const i={};return r.value.forEach(s=>{i[s]=!0}),i}),b=i=>{r.value.some(s=>s===i)?r.value=r.value.filter(s=>s!=i):r.value.push(i)},U=async()=>{p.value=!0;try{for(let[i,s]of r.value.entries()){const k=S.all_token_metas[s];if(!k)throw"Failed to find store token for token: "+s;if(k.entity.platform!=Q.Opensea)continue;const w=JSON.parse(JSON.stringify(k));w.entity.wallet_address=$.get_account.entity.wallet_address,w.entity.platform=Q.OpenseaArchive;const E=await re(w.entity);r.value[i]=E.id}await z(d.plaque_id,{token_meta_id_list:r.value})}catch(i){Z(`Error updating plaque tokens - ${i}`)}p.value=!1,g.value=!1},O=()=>{r.value=[]};return(i,s)=>{const k=c("el-card"),w=c("el-button"),E=c("el-dialog");return u(),q("div",Ce,[t(E,{center:"",modelValue:v(g),"onUpdate:modelValue":s[1]||(s[1]=n=>ne(g)?g.value=n:null),title:"Add tokens to plaque","close-on-click-modal":!1,fullscreen:v(P)=="xs"},{footer:o(()=>[e("span",Ae,[e("div",null,A(`Tokens in playlist: ${r.value.length}`),1),Pe,t(w,{onClick:O},{default:o(()=>[Te]),_:1}),t(w,{type:"info",onClick:U,loading:p.value},{default:o(()=>[Ne]),_:1},8,["loading"])])]),default:o(()=>[R(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>m.value=n),class:"search-bar",placeholder:"Search by artwork title or artist name"},null,512),[[W,m.value]]),t(k,{class:"box-card",shadow:"never"},{default:o(()=>[v(y).length==0?(u(),q("div",be,"No tokens found")):I("",!0),(u(!0),q(B,null,M(v(y),n=>(u(),L($e,{token:n,in_list:Boolean(v(f)[n.id]),onUpdate_token_list:b},null,8,["token","in_list"]))),256)),Se]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});var Ie=F(Ve,[["__scopeId","data-v-74e16b08"]]);const V=l=>(J("data-v-2285ddc0"),l=l(),G(),l),Le={style:{display:"flex","align-items":"center",padding:"1em"}},Be={key:0},Ee=V(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),je=h("online"),Ue={class:"card-simple"},ze=V(()=>e("hr",null,null,-1)),De=V(()=>e("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Oe=V(()=>e("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Re={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em"}},Fe={style:{padding:"1em"}},Me=h(" View "),Je={key:0,class:"card-detail"},Ge={style:{padding:"0 1em"}},He={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Qe=h("Settings"),Ke=h("Add Artwork"),We=V(()=>e("hr",null,null,-1)),Xe=V(()=>e("div",{style:{padding:"1em"}}," No tokens added",-1)),Ye=V(()=>e("hr",null,null,-1)),Ze={style:{display:"flex",padding:"1em"}},et=h("Clear Tokens"),tt=V(()=>e("div",{style:{"flex-grow":"1"}},null,-1)),ot=h("Close"),st={key:0,style:{padding:"1em",display:"flex","justify-content":"space-between"}},nt=h("Forget Display"),lt=h("Close"),at=D({props:{plaque:null},setup(l){const _=l,d=x("simple"),r=x(!1),p=x(!1),m=x(!1),P=async()=>{m.value=!0,await z(_.plaque.id,{name:_.plaque.entity.name}).catch(y=>{Z(`Error updating plaque tokens - ${y}`)}),p.value=!1,m.value=!1},T=te(),S=N(()=>$.value.length==0?null:$.value[0]),$=N(()=>{const y=T.archive_token_meta_map;return _.plaque.entity.token_meta_id_list.map(f=>y[f])});x("0"),x(!0);const g=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${_.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{z(_.plaque.id,{token_meta_id_list:[]}).then(()=>{j({type:"success",message:"Tokens cleared"})}).catch(y=>{j({message:`Error clearing tokens from plaque - ${y}`,type:"error",showClose:!0,duration:12e3})})})},C=()=>{H.confirm(`Are you sure you want to forget the plaque named '${_.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{z(_.plaque.id,{wallet_address:"",token_meta_id_list:[]}).then(()=>{j({type:"success",message:"Plaque forgotten"})}).catch(y=>{j({message:`Error forgetting plaque - ${y}`,type:"error",showClose:!0,duration:12e3})})})};return(y,a)=>{const f=c("el-button"),b=c("el-tag"),U=c("el-col"),O=c("el-row"),i=c("ArrowRight"),s=c("el-icon"),k=c("el-collapse-transition"),w=c("Close"),E=c("el-card");return u(),L(E,null,{default:o(()=>[e("div",Le,[p.value?R((u(),q("input",{key:1,"onUpdate:modelValue":a[0]||(a[0]=n=>_.plaque.entity.name=n),class:"edit-name-input"},null,512)),[[W,_.plaque.entity.name]]):(u(),q("h1",Be,A(_.plaque.entity.name),1)),p.value?I("",!0):(u(),L(f,{key:2,icon:v(le),onClick:a[1]||(a[1]=n=>p.value=!0),class:"editIcon",circle:""},null,8,["icon"])),p.value?(u(),L(f,{key:3,icon:v(ae),loading:m.value,onClick:P,class:"editIcon",circle:"",type:m.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),Ee,t(b,{class:"ml-2",type:"success"},{default:o(()=>[je]),_:1})]),t(k,null,{default:o(()=>[R(e("section",Ue,[ze,t(O,{style:{"margin-bottom":"8px",padding:"1em"}},{default:o(()=>[t(U,{span:12},{default:o(()=>{var n;return[De,e("span",null,A(((n=v(S))==null?void 0:n.entity.name)||"N/A"),1)]}),_:1}),t(U,{span:12},{default:o(()=>{var n;return[Oe,h(" "+A(((n=v(S))==null?void 0:n.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),e("div",Re,[e("div",Fe,A(`Total artworks: ${l.plaque.entity.token_meta_id_list.length}`),1),t(f,{onClick:a[2]||(a[2]=n=>d.value="detail")},{default:o(()=>[Me,t(s,{class:"el-icon--right"},{default:o(()=>[t(i)]),_:1})]),_:1})])],512),[[ie,d.value=="simple"]])]),_:1}),t(k,null,{default:o(()=>[d.value=="detail"?(u(),q("section",Je,[e("p",Ge,A(`Total artworks: ${l.plaque.entity.token_meta_id_list.length}`),1),e("div",He,[t(f,{onClick:a[3]||(a[3]=n=>d.value="settings")},{default:o(()=>[Qe]),_:1}),t(f,{type:"info",onClick:a[4]||(a[4]=n=>r.value=!0)},{default:o(()=>[Ke]),_:1})]),We,v($).length==0?(u(),q(B,{key:0},[Xe,Ye],64)):I("",!0),(u(!0),q(B,null,M(v($),n=>(u(),L(ve,{token_meta:n},null,8,["token_meta"]))),256)),e("div",Ze,[t(f,{onClick:g},{default:o(()=>[et]),_:1}),tt,t(f,{onClick:a[5]||(a[5]=n=>d.value="simple")},{default:o(()=>[ot,t(s,{class:"el-icon--right"},{default:o(()=>[t(w)]),_:1})]),_:1})])])):I("",!0)]),_:1}),t(k,null,{default:o(()=>[d.value=="settings"?(u(),q("section",st,[t(f,{type:"danger",plain:"",onClick:C},{default:o(()=>[nt]),_:1}),t(f,{onClick:a[6]||(a[6]=n=>d.value="detail")},{default:o(()=>[lt,t(s,{class:"el-icon--right"},{default:o(()=>[t(w)]),_:1})]),_:1})])):I("",!0)]),_:1}),t(Ie,{plaque_id:_.plaque.id,show_add_token_dialog:r.value,"onUpdate:show_add_token_dialog":a[7]||(a[7]=n=>r.value=n)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var it=F(at,[["__scopeId","data-v-2285ddc0"]]);const _t=l=>(J("data-v-4c8baa0e"),l=l(),G(),l),dt={class:"add-button-container"},rt={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},ut=_t(()=>e("div",{style:{"font-size":"17px"}},"Add plaque",-1)),ct={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},pt=h("Scan Plaque QR Code"),mt=h("Add test plaque "),ft=D({setup(l){const _=x(!1),{width:d,screen_type:r}=ee(),p=x(!1),m=_e(),P=Y(),T=X(),S=async()=>{_.value=!0,await de({name:"Test Plaque",wallet_address:P.get_account.entity.wallet_address,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch($=>j({message:`Error creating test plaque- ${$}`,type:"error",showClose:!0,duration:12e3})),_.value=!1,p.value=!1};return($,g)=>{const C=c("Plus"),y=c("el-icon"),a=c("el-button"),f=c("el-dialog");return u(),q(B,null,[(u(!0),q(B,null,M(v(T).plaques,b=>(u(),L(it,{plaque:b,key:b.id},null,8,["plaque"]))),128)),e("div",dt,[e("div",rt,[e("div",{class:"add-button",onClick:g[0]||(g[0]=b=>p.value=!0)},[t(y,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[t(C)]),_:1}),ut])])]),t(f,{modelValue:p.value,"onUpdate:modelValue":g[2]||(g[2]=b=>p.value=b),title:"Add plaque",width:v(r)=="xs"?"90%":"50%"},{default:o(()=>[e("div",ct,[t(a,{onClick:g[1]||(g[1]=b=>{v(m).push("qr-scan"),p.value=!1}),icon:"camera",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[pt]),_:1}),t(a,{icon:"plus",onClick:S,loading:_.value,style:{margin:"10px 0px 10px 0px"}},{default:o(()=>[mt]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var xt=F(ft,[["__scopeId","data-v-4c8baa0e"]]);export{xt as default};
