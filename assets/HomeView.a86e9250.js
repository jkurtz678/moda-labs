import{_ as F,a as j,b as W,c as J,d as K}from"./WelcomeDialog.70c89757.js";import{d as N,r as P,c as Q,a as q,w as d,n as X,u as o,b as H,e as I,f as p,o as r,g as A,h as C,i as s,j as V,F as D,k as R,l as M,t as Y,_ as B,p as Z,m as ee,q as te,E as L,s as ae,R as oe}from"./index.d5816c97.js";import{u as G}from"./account.05194ff4.js";import{u as se}from"./breakpoints.9f3ce775.js";import{s as ne,a as O,o as le}from"./firebaseConfig.4d01e9b5.js";import{s as l}from"./util.eb844669.js";import{u as re}from"./plaque.42944aac.js";import{u as ie}from"./token-meta.f854aefe.js";import{u as ce}from"./gallery.805bff33.js";import{a as ue}from"./add-plaque.9eec8580.js";import"./types.c2052207.js";import"./plaque.88741b72.js";import"./token-meta.e9d92a72.js";import"./gallery-token.628d8fa1.js";const U=h=>(Z("data-v-5c106a87"),h=h(),ee(),h),_e=U(()=>M("div",{style:{"flex-grow":"1"}},null,-1)),de=U(()=>M("div",{style:{"flex-grow":"1"}},null,-1)),pe={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},me=N({__name:"Header",setup(h){const i=H(),k=I(),n=G(),c=P(!1),{md_and_up:m,screen_type:w}=se(),g=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&i.push({name:e.paneName})},v=Q(()=>{const e=n.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),x=()=>{c.value=!0,ne(O).then(()=>{}).catch(e=>{l(e)}).finally(()=>{c.value=!1})},$=e=>new URL({"../assets/base.css":F,"../assets/logo.png":j,"../assets/logo.svg":W,"../assets/search-icon.svg":J}[`../assets/${e}`],self.location).href;return(e,t)=>{const f=p("el-image"),u=p("el-button"),y=p("el-tab-pane"),S=p("el-tabs"),b=p("el-header");return r(),q(b,{class:"header",style:X(o(w)=="xs"?"padding: 0px 8px;":"")},{default:d(()=>[o(m)?(r(),q(f,{key:0,src:$("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):A("",!0),o(i).currentRoute.value.name=="qr-scan"?(r(),C(D,{key:1},[_e,s(u,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=_=>o(i).push("plaque-list"))},{default:d(()=>[V(" Cancel ")]),_:1})],64)):(r(),C(D,{key:2},[s(S,{modelValue:o(k).name,"onUpdate:modelValue":t[1]||(t[1]=_=>o(k).name=_),onTabClick:g,class:R(o(m)?"":"small-tabs")},{default:d(()=>[s(y,{label:"Plaques",name:"plaque-list"}),s(y,{label:"Artwork",name:"artwork-tile-grid"}),s(y,{label:"Galleries",name:"gallery-list"}),s(y,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),de,o(m)?(r(),C("div",pe,[M("div",null,Y(v.value),1),o(n).is_user_admin?(r(),q(u,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:d(()=>[V("Admin")]),_:1})):A("",!0)])):A("",!0),s(u,{onClick:x,style:{"margin-left":"1em"},loading:c.value},{default:d(()=>[V("Logout")]),_:1},8,["loading"])],64))]),_:1},8,["style"])}}});var ge=B(me,[["__scopeId","data-v-5c106a87"]]);const fe=N({__name:"HomeView",setup(h){const i=G(),k=re(),n=ie(),c=ce(),m=H(),w=P(!1),g=P(),v=I();let x;te(async()=>{g.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),x=le(O,async e=>{if(console.log("onAuthStateChanged",e),e){g.value=L.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{await $(e.uid)}finally{g.value.close()}}e||(i.setAccount(null),g.value.close(),m.push({name:"login",query:{redir:window.location.href}}))})}),ae(()=>{console.log("unsubscribe onAuthStateChanged on unmount"),x()});async function $(e){console.log("LOAD APP DATA"),await i.loadAccount(e),await c.loadGalleryList(e).catch(a=>l(`Error loading galleries - ${a}`)),console.log("done loading galleries");const t=k.loadPlaques(e).catch(a=>l(`Error loading plaques - ${a}`)),f=k.loadGalleryPlaques(c.gallery_plaque_list).catch(a=>l(`Error loading gallery plaques - ${a}`)),u=n.loadArchiveTokenMetas(e).catch(a=>l(`Error loading archive token metas - ${a}`)),y=n.loadGalleryTokenMetas(c.gallery_token_meta_list).catch(a=>l(`Error loading token metas - ${a}`)),S=n.loadDemoTokenMetas().catch(a=>l(`Error loading demo token metas - ${a}`)),b=[t,f,u,f,y,S],_=i.get_account.entity.wallet_address;if(_){const a=n.loadOpenseaMintedTokenMetas(_).catch(T=>l(`Error loading opensea minted tokens - ${T}`)),z=n.loadOpenseaWalletTokenMetas(_).catch(T=>l(`Error loading opensea wallet tokens - ${T}`));b.push(a),b.push(z)}await Promise.all(b),_&&await n.loadOpenseaConvertedTokens();const E=v.query.plaque_id;E&&typeof E=="string"&&(await ue(e,E),m.replace({path:v.path,query:{}})),w.value=!0}return(e,t)=>{const f=p("el-main"),u=p("el-container");return r(),C(D,null,[s(u,{style:{height:"100%",position:"fixed",top:"0px",left:"0px",right:"0px",bottom:"0px"}},{default:d(()=>[s(ge),s(f,{style:{"background-color":"#DAD9D7"},class:R(o(v).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:d(()=>[w.value?(r(),q(o(oe),{key:0})):A("",!0)]),_:1},8,["class"])]),_:1}),s(K)],64)}}});var Ve=B(fe,[["__scopeId","data-v-0998a441"]]);export{Ve as default};
