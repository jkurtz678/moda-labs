import{_ as T,a as H,b as M,c as U}from"./search-icon.301e062d.js";import{d as E,u as N,a as S,r as k,c as F,b as i,o as c,e as f,f as s,g as b,h as w,F as V,i as l,w as u,j as $,t as G,k as L,_ as I,l as j,E as A,R as O}from"./index.db76b1c1.js";import{u as R}from"./account.46d5f1ac.js";import{u as z}from"./breakpoints.854ac71d.js";import{s as J,a as g,b as B,o as K}from"./util.25968482.js";import{u as Q,a as W}from"./plaque.34228345.js";import{u as X}from"./token-meta.1fc34ceb.js";import{u as Y}from"./plaque.5dbbef46.js";const Z={style:{display:"flex","align-items":"center"}},ee=L("div",{style:{"flex-grow":"1"}},null,-1),te=L("div",{style:{"flex-grow":"1"}},null,-1),ae={key:0,style:{"margin-right":"10px"}},oe=E({__name:"Header",setup(D){const r=N(),_=S(),h=R(),d=k(!1),{width:q,screen_type:m}=z(),p=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&r.push({name:e.paneName})},y=F(()=>{const e=h.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),v=()=>{d.value=!0,J(B).then(()=>{}).catch(e=>{g(e)}).finally(()=>{d.value=!1})},o=e=>new URL({"../assets/base.css":T,"../assets/logo.png":H,"../assets/logo.svg":M,"../assets/search-icon.svg":U}[`../assets/${e}`],self.location).href;return(e,t)=>{const n=i("el-image"),a=i("el-button"),x=i("el-tab-pane"),P=i("el-tabs");return c(),f("div",Z,[s(m)!="xs"?(c(),b(n,{key:0,src:o("logo.png"),style:{width:"43px",height:"43px","margin-right":"2em"}},null,8,["src"])):w("",!0),s(r).currentRoute.value.name=="qr-scan"?(c(),f(V,{key:1},[ee,l(a,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=C=>s(r).push("plaque-list"))},{default:u(()=>[$(" Cancel ")]),_:1})],64)):(c(),f(V,{key:2},[l(P,{modelValue:s(_).name,"onUpdate:modelValue":t[1]||(t[1]=C=>s(_).name=C),onTabClick:p},{default:u(()=>[l(x,{label:"Plaques",name:"plaque-list"}),l(x,{label:"Tokens",name:"token-list"})]),_:1},8,["modelValue"]),te,s(m)!="xs"?(c(),f("div",ae,G(s(y)),1)):w("",!0),l(a,{onClick:v,style:{"margin-left":"1em"},loading:d.value},{default:u(()=>[$("Logout")]),_:1},8,["loading"])],64))])}}});const ne=E({__name:"HomeView",setup(D){const r=R(),_=Q(),h=X(),d=W(),q=N(),m=k(!1),p=k(),y=S();j(async()=>{p.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),K(B,async o=>{console.log("onAuthStateChanged",o),o?(p.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await v(o.uid),p.value.close()):(r.setAccount(null),q.push({name:"login",query:{redir:window.location.href}}))})});async function v(o){await r.loadAccount(o),await d.loadGalleryList(o).catch(a=>g(`Error loading galleries - ${a}`));const e=_.loadPlaques(o).catch(a=>g(`Error loading plaques - ${a}`)),t=h.loadArchiveTokenMetas(o).catch(a=>g(`Error loading archive token metas - ${a}`));await Promise.all([e,t]);const n=y.query.plaque_id;n&&typeof n=="string"&&!_.plaque_map[n]&&await Y(n,{user_id:r.get_account.id,token_meta_id_list:[]}).catch(a=>{g(`Error adding plaque from query param = ${a}`)}),m.value=!0}return(o,e)=>{const t=i("el-header"),n=i("el-main"),a=i("el-container");return c(),b(a,{style:{height:"100%"}},{default:u(()=>[l(t,{class:"header"},{default:u(()=>[l(oe)]),_:1}),l(n,{style:{"background-color":"#DAD9D7"}},{default:u(()=>[m.value?(c(),b(s(O),{key:0})):w("",!0)]),_:1})]),_:1})}}});var me=I(ne,[["__scopeId","data-v-0dcc5782"]]);export{me as default};
