import{u as L}from"./gallery.2d1d6ce7.js";import{T as y}from"./types.c2052207.js";import{d as N,r as g,B as f,N as U,c as h,a as V,w as n,_ as q,f as p,o as k,i as a,j as O,h as T,J as D,u as E,F as M,p as P,m as j,l as b}from"./index.86d3d88b.js";const w=d=>(P("data-v-7d6ec23c"),d=d(),j(),d),z=w(()=>b("div",{class:"caption"},"Filter by gallery",-1)),G=w(()=>b("div",{class:"caption"},"Filter by aspect ratio",-1)),J=w(()=>b("div",{class:"caption"},"Filter by platform",-1)),$=w(()=>b("div",{class:"caption"},"Sort order",-1)),H=N({__name:"ArtworkFilters",props:{all_tokens:{},search_filter:{},use_local_storage:{type:Boolean}},emits:["update-filtered-tokens"],setup(d,{emit:A}){const o=d,S=L(),F=A,_=g("");f(_,t=>{o.use_local_storage&&localStorage.setItem("artwork_grid_aspect_ratio_filter",t)});const i=g("");f(i,t=>{o.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_gallery",t)});const c=g("");f(c,t=>{o.use_local_storage&&localStorage.setItem("artwork_grid_filter_by_platform",t)});const u=g("created_at");f(u,t=>{o.use_local_storage&&localStorage.setItem("artwork_grid_sort_order",t)}),U(()=>{o.use_local_storage&&(_.value=localStorage.getItem("artwork_grid_aspect_ratio_filter")||"",i.value=localStorage.getItem("artwork_grid_filter_by_gallery")||"",c.value=localStorage.getItem("artwork_grid_filter_by_platform")||"",u.value=localStorage.getItem("artwork_grid_sort_order")||"name")});const I=h(()=>_.value||i.value||c.value),C=h(()=>{const t=new Set;return i.value&&S.gallery_token_meta_list.forEach(e=>{e.entity.gallery_id==i.value&&t.add(e.entity.token_meta_id)}),console.log("ret set ",t),t}),x=h(()=>{if(!o.all_tokens)return[];let t=o.all_tokens.filter(e=>{var s,m;if(o.search_filter&&!((s=e.entity.artist)!=null&&s.toLowerCase().includes(o.search_filter.toLowerCase()))&&!((m=e.entity.name)!=null&&m.toLowerCase().includes(o.search_filter.toLowerCase()))||i.value&&!C.value.has(e.id))return!1;switch(c.value){case"moda_archive":if(e.entity.platform!=y.Archive)return!1;break;case"opensea":if(e.entity.platform!=y.Opensea&&e.entity.platform!=y.OpenseaArchive)return!1;break;case"archive_demo":if(e.entity.platform!=y.ArchiveDemo)return!1;break}switch(_.value){case"portrait":if(!e.entity.aspect_ratio||e.entity.aspect_ratio>.9)return!1;break;case"landscape":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<1.1)return!1;break;case"square":if(!e.entity.aspect_ratio||e.entity.aspect_ratio<.9||e.entity.aspect_ratio>1.1)return!1;break}return!0});return u.value==="name"?t=t.sort((e,s)=>e.entity.name.localeCompare(s.entity.name)):u.value==="created_at"&&(t=t.sort((e,s)=>e.entity.created_at==null&&s.entity.created_at==null?0:e.entity.created_at==null?1:s.entity.created_at==null?-1:s.entity.created_at.seconds-e.entity.created_at.seconds)),t});return f(x,t=>{F("update-filtered-tokens",t)},{immediate:!0}),(t,e)=>{const s=p("el-button"),m=p("el-badge"),l=p("el-option"),v=p("el-select"),B=p("el-popover");return k(),V(B,{placement:"bottom",title:"Artwork Filters",width:300,trigger:"click"},{reference:n(()=>[a(m,{"is-dot":"",hidden:!I.value},{default:n(()=>[a(s,{icon:"Filter",style:{"margin-left":"10px"},type:"info",size:"small"},{default:n(()=>[O("Filters")]),_:1})]),_:1},8,["hidden"])]),default:n(()=>[z,a(v,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=r=>i.value=r),placeholder:"Filter by gallery",class:"filter-select"},{default:n(()=>[a(l,{label:"All artwork",value:""}),(k(!0),T(M,null,D(E(S).gallery_list,r=>(k(),V(l,{key:r.id,label:`${r.entity.name}`,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),G,a(v,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=r=>_.value=r),class:"filter-select"},{default:n(()=>[a(l,{label:"All",value:""}),a(l,{label:"Landscape",value:"landscape"}),a(l,{label:"Portrait",value:"portrait"}),a(l,{label:"Square",value:"square"})]),_:1},8,["modelValue"]),J,a(v,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=r=>c.value=r),class:"filter-select"},{default:n(()=>[a(l,{label:"All",value:""}),a(l,{label:"Moda Archive",value:"moda_archive"}),a(l,{label:"Opensea",value:"opensea"}),a(l,{label:"Demo",value:"archive_demo"})]),_:1},8,["modelValue"]),$,a(v,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=r=>u.value=r),placeholder:"Sort by",class:"filter-select"},{default:n(()=>[a(l,{label:"Sort by name",value:"name"}),a(l,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"])]),_:1})}}});var W=q(H,[["__scopeId","data-v-7d6ec23c"]]);export{W as A};
