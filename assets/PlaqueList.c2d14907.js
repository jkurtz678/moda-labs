import{_ as J,d as U,r as P,c as D,v as ie,b as m,o as u,e as q,i as e,w as t,k as a,t as T,j as r,f as y,x as de,y as F,z as M,u as X,g as V,A as Q,B as ue,C as re,h as N,D as _e,G as ce,F as L,H as Y,I as O,q as I,J as pe}from"./index.9d329d0c.js";import{u as B,d as me,c as fe}from"./plaque.f70eeb36.js";import{c as ye}from"./token-meta.d8e9f0c8.js";import{u as R}from"./plaque.0a9a073f.js";import{u as Z}from"./account.459165b5.js";import{s as ee}from"./util.cfaff72b.js";import{T as K}from"./types.7dcec3bd.js";import{u as te}from"./breakpoints.30fe51f3.js";import{u as ae}from"./token-meta.be746496.js";import{_ as ve}from"./TokenSelectList.779fcbd1.js";import{_ as ge}from"./PlaqueTokenItem.4a4d62dc.js";import{n as W}from"./firebaseConfig.4bdd3a5f.js";import"./gallery.d03ce7cb.js";import"./thumbnail-image.d7bcef8b.js";const ke=o=>(F("data-v-cc2989e6"),o=o(),M(),o),qe={class:"dialog-container"},he={class:"dialog-footer"},we=ke(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),xe=U({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(o,{emit:n}){const h=o,v=P([]),_=P(!1),{screen_type:x}=te(),w=R(),g=ae(),E=Z(),C=D({get(){return h.show_add_token_dialog},set(f){n("update:show_add_token_dialog",f)}});ie(C,f=>{f&&(v.value=JSON.parse(JSON.stringify(b.value.entity.token_meta_id_list)))});const b=D(()=>w.plaque_map[h.plaque_id]),S=D(()=>g.sorted_all_token_metas),$=async()=>{_.value=!0;try{for(let[f,p]of v.value.entries()){const s=g.all_token_metas[p];if(!s)throw"Failed to find store token for token: "+p;if(s.entity.platform!=K.Opensea)continue;const l=JSON.parse(JSON.stringify(s));l.entity.user_id=E.get_account.id,l.entity.platform=K.OpenseaArchive;const i=await ye(l.entity);v.value[f]=i.id}await B(h.plaque_id,{token_meta_id_list:v.value}),w.plaque_map[h.plaque_id].entity.token_meta_id_list=v.value}catch(f){ee(`Error updating plaque tokens - ${f}`)}_.value=!1,C.value=!1},c=()=>{v.value=[]};return(f,p)=>{const s=m("el-button"),l=m("el-dialog");return u(),q("div",qe,[e(l,{center:"",modelValue:y(C),"onUpdate:modelValue":p[1]||(p[1]=i=>de(C)?C.value=i:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:y(x)=="xs",top:"2vh"},{footer:t(()=>[a("div",he,[a("div",null,T(`Artwork in playlist: ${v.value.length}`),1),we,e(s,{onClick:c},{default:t(()=>[r("Clear")]),_:1}),e(s,{type:"info",onClick:$,loading:_.value},{default:t(()=>[r("Save")]),_:1},8,["loading"])])]),default:t(()=>[e(ve,{selected_token_meta_id_list:v.value,"onUpdate:selected_token_meta_id_list":p[0]||(p[0]=i=>v.value=i),token_meta_list:y(S)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var Ce=J(xe,[["__scopeId","data-v-cc2989e6"]]);const A=o=>(F("data-v-0b88dd84"),o=o(),M(),o),$e={style:{display:"flex","align-items":"center",padding:"1em"}},Pe={key:0},Ae=A(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Se={class:"card-simple"},be=A(()=>a("hr",null,null,-1)),Ne=A(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Te=A(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ve={style:{padding:"0.3em 1em"}},Ie={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},De={key:0,class:"card-detail"},Ee={style:{padding:"0 1em"}},Be={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Le=A(()=>a("hr",null,null,-1)),je=A(()=>a("div",{style:{padding:"1em"}},"No artwork added",-1)),ze=A(()=>a("hr",null,null,-1)),Oe={style:{display:"flex",padding:"1em"}},Je=A(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Ue={key:0,style:{padding:"1em"}},Fe={style:{display:"flex","justify-content":"space-between"}},Me={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Re={key:0},Ge=A(()=>a("div",null,"Associated User ID:",-1)),He={key:1},Qe={style:{display:"flex","justify-content":"end"}},Ke=U({__name:"PlaqueCard",props:{plaque:null},setup(o){const n=o,h=R(),v=X(),_=P("simple"),x=P(!1),w=P(!1),g=P(!1),E=async()=>{g.value=!0,await B(n.plaque.id,{name:n.plaque.entity.name}).catch(s=>{ee(`Error updating plaque tokens - ${s}`)}),w.value=!1,g.value=!1},C=ae(),b=D(()=>S.value.length==0?null:S.value[0]),S=D(()=>{const s=C.archive_token_meta_map;return n.plaque.entity.token_meta_id_list.map(i=>s[i])}),$=()=>{O.confirm(`Are you sure you want to clear tokens for plaque '${n.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{B(n.plaque.id,{token_meta_id_list:[]}).then(()=>{h.plaque_map[n.plaque.id].entity.token_meta_id_list=[],I({type:"success",message:"Tokens cleared"})}).catch(s=>{I({message:`Error clearing tokens from plaque - ${s}`,type:"error",showClose:!0,duration:12e3})})})},c=()=>{O.confirm(`Are you sure you want to forget the plaque named '${n.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{B(n.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{h.plaque_map[n.plaque.id].entity.user_id="",h.plaque_map[n.plaque.id].entity.token_meta_id_list=[],I({type:"success",message:"Plaque forgotten"})}).catch(s=>{I({message:`Error forgetting plaque - ${s}`,type:"error",showClose:!0,duration:12e3})})})},f=()=>{const s=v.resolve({name:"preview-plaque",params:{plaque_id:n.plaque.id}});window.open(s.href)},p=()=>{O.confirm(`Are you sure you want to delete the plaque named '${n.plaque.entity.name}'?`,"Delete plaque",{type:"warning"}).then(()=>{me(n.plaque.id).then(()=>{delete h.plaque_map[n.plaque.id],I({type:"success",message:"Plaque deleted"})}).catch(s=>{I({message:`Error deleting empty plaque - ${s}`,type:"error",showClose:!0,duration:12e3})})})};return(s,l)=>{const i=m("el-button"),k=m("el-tag"),G=m("el-col"),oe=m("el-row"),ne=m("ArrowRight"),j=m("el-icon"),z=m("el-collapse-transition"),H=m("Close"),se=m("el-card");return u(),V(se,null,{default:t(()=>[a("div",$e,[w.value?Q((u(),q("input",{key:1,"onUpdate:modelValue":l[0]||(l[0]=d=>n.plaque.entity.name=d),class:"edit-name-input"},null,512)),[[ue,n.plaque.entity.name]]):(u(),q("h1",Pe,T(n.plaque.entity.name),1)),w.value?N("",!0):(u(),V(i,{key:2,icon:y(re),onClick:l[1]||(l[1]=d=>w.value=!0),class:"editIcon",circle:""},null,8,["icon"])),w.value?(u(),V(i,{key:3,icon:y(_e),loading:g.value,onClick:E,class:"editIcon",circle:"",type:g.value?"":"success",text:""},null,8,["icon","loading","type"])):N("",!0),Ae,e(k,{class:"ml-2",type:"success"},{default:t(()=>[r("online")]),_:1})]),e(z,null,{default:t(()=>[Q(a("section",Se,[be,e(oe,{style:{padding:"1em"}},{default:t(()=>[e(G,{span:12},{default:t(()=>{var d;return[Ne,a("span",null,T(((d=y(b))==null?void 0:d.entity.name)||"N/A"),1)]}),_:1}),e(G,{span:12},{default:t(()=>{var d;return[Te,r(" "+T(((d=y(b))==null?void 0:d.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),a("div",Ve,T(`Total artworks: ${o.plaque.entity.token_meta_id_list.length}`),1),a("div",Ie,[e(i,{type:"info",onClick:l[2]||(l[2]=d=>x.value=!0)},{default:t(()=>[r("Add Artwork")]),_:1}),e(i,{onClick:l[3]||(l[3]=d=>_.value="detail")},{default:t(()=>[r(" Details"),e(j,{class:"el-icon--right"},{default:t(()=>[e(ne)]),_:1})]),_:1})])],512),[[ce,_.value=="simple"]])]),_:1}),e(z,null,{default:t(()=>[_.value=="detail"?(u(),q("section",De,[a("p",Ee,T(`Total artworks: ${o.plaque.entity.token_meta_id_list.length}`),1),a("div",Be,[e(i,{onClick:l[4]||(l[4]=d=>_.value="settings")},{default:t(()=>[r("Settings")]),_:1}),e(i,{onClick:$},{default:t(()=>[r("Clear Artwork")]),_:1})]),Le,y(S).length==0?(u(),q(L,{key:0},[je,ze],64)):N("",!0),(u(!0),q(L,null,Y(y(S),d=>(u(),V(ge,{token_meta:d},null,8,["token_meta"]))),256)),a("div",Oe,[e(i,{type:"info",onClick:l[5]||(l[5]=d=>x.value=!0)},{default:t(()=>[r("Add Artwork")]),_:1}),Je,e(i,{onClick:l[6]||(l[6]=d=>_.value="simple")},{default:t(()=>[r("Close"),e(j,{class:"el-icon--right"},{default:t(()=>[e(H)]),_:1})]),_:1})])])):N("",!0)]),_:1}),e(z,null,{default:t(()=>[_.value=="settings"?(u(),q("section",Ue,[a("div",Fe,[e(i,null,{default:t(()=>[r("Preview Art")]),_:1}),e(i,{onClick:f},{default:t(()=>[r("Preview Plaque")]),_:1})]),a("div",Me,[o.plaque.entity.user_id?(u(),q("div",Re,[Ge,a("div",null,T(o.plaque.entity.user_id),1)])):(u(),q("div",He,"No associated user")),o.plaque.entity.user_id?(u(),V(i,{key:2,type:"danger",plain:"",onClick:c},{default:t(()=>[r("Forget Display")]),_:1})):N("",!0),!o.plaque.entity.user_id&&(!o.plaque.entity.token_meta_id_list||o.plaque.entity.token_meta_id_list.length===0)?(u(),V(i,{key:3,type:"danger",plain:"",onClick:p},{default:t(()=>[r("Delete Plaque")]),_:1})):N("",!0)]),a("div",Qe,[e(i,{onClick:l[7]||(l[7]=d=>_.value="detail")},{default:t(()=>[r("Close"),e(j,{class:"el-icon--right"},{default:t(()=>[e(H)]),_:1})]),_:1})])])):N("",!0)]),_:1}),e(Ce,{plaque_id:n.plaque.id,show_add_token_dialog:x.value,"onUpdate:show_add_token_dialog":l[8]||(l[8]=d=>x.value=d)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var We=J(Ke,[["__scopeId","data-v-0b88dd84"]]);const le=o=>(F("data-v-4a1aeca1"),o=o(),M(),o),Xe={class:"subheader",style:{display:"flex","align-items":"center"}},Ye=le(()=>a("div",{style:{"padding-bottom":"40px"}},null,-1)),Ze={class:"add-button-container"},et={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},tt=le(()=>a("div",{style:{"font-size":"17px"}},"Add plaque",-1)),at={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},lt=U({__name:"PlaqueList",setup(o){const n=P(!1),{width:h,screen_type:v}=te(),_=P(!1),x=X(),w=Z(),g=P(""),E=R(),C=async()=>{n.value=!0,await fe({name:"Test Plaque",user_id:w.get_account.id,token_meta_id_list:[],created_at:W.now(),updated_at:W.now()}).catch($=>I({message:`Error creating test plaque- ${$}`,type:"error",showClose:!0,duration:12e3})),n.value=!1,_.value=!1},b=D(()=>JSON.parse(JSON.stringify(E.all_plaque_list)).sort((c,f)=>{const p=c.entity.name.toLowerCase(),s=f.entity.name.toLowerCase();return p<s?-1:p>s?1:0})),S=D(()=>g?b.value.filter($=>$.entity.name.toLowerCase().includes(g.value.toLowerCase())):b.value);return($,c)=>{const f=m("el-input"),p=m("el-button"),s=m("Plus"),l=m("el-icon"),i=m("el-dialog");return u(),q(L,null,[a("div",Xe,[e(f,{modelValue:g.value,"onUpdate:modelValue":c[0]||(c[0]=k=>g.value=k),"prefix-icon":y(pe),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),e(p,{icon:"Camera",type:"info",onClick:c[1]||(c[1]=k=>y(x).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:t(()=>[r("Scan")]),_:1})]),Ye,(u(!0),q(L,null,Y(y(S),k=>(u(),V(We,{plaque:k,key:k.id},null,8,["plaque"]))),128)),a("div",Ze,[a("div",et,[a("div",{class:"add-button",onClick:c[2]||(c[2]=k=>_.value=!0)},[e(l,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:t(()=>[e(s)]),_:1}),tt])])]),e(i,{modelValue:_.value,"onUpdate:modelValue":c[4]||(c[4]=k=>_.value=k),title:"Add plaque",width:y(v)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:t(()=>[a("div",at,[e(p,{onClick:c[3]||(c[3]=k=>{y(x).push("qr-scan"),_.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:t(()=>[r("Scan Plaque QR Code")]),_:1}),e(p,{icon:"plus",onClick:C,loading:n.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:t(()=>[r("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var gt=J(lt,[["__scopeId","data-v-4a1aeca1"]]);export{gt as default};
