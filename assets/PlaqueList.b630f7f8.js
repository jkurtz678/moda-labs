import{_ as L,d as j,r as q,c as N,v as te,b as r,o as p,e as w,i as e,w as o,k as l,t as T,j as m,f as y,x as oe,y as J,z as F,g as V,A as R,B as ae,C as le,h as I,D as ne,G as se,F as D,H as Q,I as U,q as E,u as ie}from"./index.244824b9.js";import{u as B,c as de}from"./plaque.8894ab7b.js";import{u as K,c as _e}from"./token-meta.fb45fd24.js";import{u as W}from"./plaque.0d38a3f5.js";import{u as X}from"./account.2e0e4398.js";import{s as Y}from"./util.5f4e64ef.js";import{T as G}from"./types.01590581.js";import{u as Z}from"./breakpoints.33c67ca7.js";import{_ as ue}from"./TokenSelectList.ae9af0d8.js";import{_ as re}from"./PlaqueTokenItem.96d2e18f.js";import{h as H}from"./firebaseConfig.bef60b65.js";import"./gallery.cb8ed638.js";import"./thumbnail-image.91347be6.js";const ce=n=>(J("data-v-cc2989e6"),n=n(),F(),n),pe={class:"dialog-container"},me={class:"dialog-footer"},fe=ce(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),ve=j({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(n,{emit:i}){const f=n,d=q([]),u=q(!1),{screen_type:h}=Z(),S=W(),P=K(),b=X(),v=N({get(){return f.show_add_token_dialog},set(t){i("update:show_add_token_dialog",t)}});te(v,t=>{t&&(d.value=JSON.parse(JSON.stringify(C.value.entity.token_meta_id_list)))});const C=N(()=>S.plaque_map[f.plaque_id]),g=N(()=>P.sorted_all_token_metas),c=async()=>{u.value=!0;try{for(let[t,k]of d.value.entries()){const _=P.all_token_metas[k];if(!_)throw"Failed to find store token for token: "+k;if(_.entity.platform!=G.Opensea)continue;const $=JSON.parse(JSON.stringify(_));$.entity.user_id=b.get_account.id,$.entity.platform=G.OpenseaArchive;const A=await _e($.entity);d.value[t]=A.id}await B(f.plaque_id,{token_meta_id_list:d.value}),S.plaque_map[f.plaque_id].entity.token_meta_id_list=d.value}catch(t){Y(`Error updating plaque tokens - ${t}`)}u.value=!1,v.value=!1},a=()=>{d.value=[]};return(t,k)=>{const _=r("el-button"),$=r("el-dialog");return p(),w("div",pe,[e($,{center:"",modelValue:y(v),"onUpdate:modelValue":k[1]||(k[1]=A=>oe(v)?v.value=A:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:y(h)=="xs",top:"2vh"},{footer:o(()=>[l("div",me,[l("div",null,T(`Artwork in playlist: ${d.value.length}`),1),fe,e(_,{onClick:a},{default:o(()=>[m("Clear")]),_:1}),e(_,{type:"info",onClick:c,loading:u.value},{default:o(()=>[m("Save")]),_:1},8,["loading"])])]),default:o(()=>[e(ue,{selected_token_meta_id_list:d.value,"onUpdate:selected_token_meta_id_list":k[0]||(k[0]=A=>d.value=A),token_meta_list:y(g)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var ge=L(ve,[["__scopeId","data-v-cc2989e6"]]);const x=n=>(J("data-v-71baf983"),n=n(),F(),n),ye={style:{display:"flex","align-items":"center",padding:"1em"}},ke={key:0},qe=x(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),we={class:"card-simple"},he=x(()=>l("hr",null,null,-1)),xe=x(()=>l("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Ce=x(()=>l("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),$e={style:{padding:"0.3em 1em"}},Ae={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Se={key:0,class:"card-detail"},Pe={style:{padding:"0 1em"}},be={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Te=x(()=>l("hr",null,null,-1)),Ne=x(()=>l("div",{style:{padding:"1em"}},"No artwork added",-1)),Ie=x(()=>l("hr",null,null,-1)),Ve={style:{display:"flex",padding:"1em"}},Ee=x(()=>l("div",{style:{"flex-grow":"1"}},null,-1)),Be={key:0,style:{padding:"1em",display:"flex","justify-content":"space-between"}},De=j({__name:"PlaqueCard",props:{plaque:null},setup(n){const i=n,f=q("simple"),d=q(!1),u=q(!1),h=q(!1),S=async()=>{h.value=!0,await B(i.plaque.id,{name:i.plaque.entity.name}).catch(c=>{Y(`Error updating plaque tokens - ${c}`)}),u.value=!1,h.value=!1},P=K(),b=N(()=>v.value.length==0?null:v.value[0]),v=N(()=>{const c=P.archive_token_meta_map;return i.plaque.entity.token_meta_id_list.map(t=>c[t])});q("0"),q(!0);const C=()=>{U.confirm(`Are you sure you want to clear tokens for plaque '${i.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{B(i.plaque.id,{token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Tokens cleared"})}).catch(c=>{E({message:`Error clearing tokens from plaque - ${c}`,type:"error",showClose:!0,duration:12e3})})})},g=()=>{U.confirm(`Are you sure you want to forget the plaque named '${i.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{B(i.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{E({type:"success",message:"Plaque forgotten"})}).catch(c=>{E({message:`Error forgetting plaque - ${c}`,type:"error",showClose:!0,duration:12e3})})})};return(c,a)=>{const t=r("el-button"),k=r("el-tag"),_=r("el-col"),$=r("el-row"),A=r("ArrowRight"),O=r("el-icon"),z=r("el-collapse-transition"),M=r("Close"),ee=r("el-card");return p(),V(ee,null,{default:o(()=>[l("div",ye,[u.value?R((p(),w("input",{key:1,"onUpdate:modelValue":a[0]||(a[0]=s=>i.plaque.entity.name=s),class:"edit-name-input"},null,512)),[[ae,i.plaque.entity.name]]):(p(),w("h1",ke,T(i.plaque.entity.name),1)),u.value?I("",!0):(p(),V(t,{key:2,icon:y(le),onClick:a[1]||(a[1]=s=>u.value=!0),class:"editIcon",circle:""},null,8,["icon"])),u.value?(p(),V(t,{key:3,icon:y(ne),loading:h.value,onClick:S,class:"editIcon",circle:"",type:h.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),qe,e(k,{class:"ml-2",type:"success"},{default:o(()=>[m("online")]),_:1})]),e(z,null,{default:o(()=>[R(l("section",we,[he,e($,{style:{padding:"1em"}},{default:o(()=>[e(_,{span:12},{default:o(()=>{var s;return[xe,l("span",null,T(((s=y(b))==null?void 0:s.entity.name)||"N/A"),1)]}),_:1}),e(_,{span:12},{default:o(()=>{var s;return[Ce,m(" "+T(((s=y(b))==null?void 0:s.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),l("div",$e,T(`Total artworks: ${n.plaque.entity.token_meta_id_list.length}`),1),l("div",Ae,[e(t,{type:"info",onClick:a[2]||(a[2]=s=>d.value=!0)},{default:o(()=>[m("Add Artwork")]),_:1}),e(t,{onClick:a[3]||(a[3]=s=>f.value="detail")},{default:o(()=>[m(" Details"),e(O,{class:"el-icon--right"},{default:o(()=>[e(A)]),_:1})]),_:1})])],512),[[se,f.value=="simple"]])]),_:1}),e(z,null,{default:o(()=>[f.value=="detail"?(p(),w("section",Se,[l("p",Pe,T(`Total artworks: ${n.plaque.entity.token_meta_id_list.length}`),1),l("div",be,[e(t,{onClick:a[4]||(a[4]=s=>f.value="settings")},{default:o(()=>[m("Settings")]),_:1}),e(t,{onClick:C},{default:o(()=>[m("Clear Artwork")]),_:1})]),Te,y(v).length==0?(p(),w(D,{key:0},[Ne,Ie],64)):I("",!0),(p(!0),w(D,null,Q(y(v),s=>(p(),V(re,{token_meta:s},null,8,["token_meta"]))),256)),l("div",Ve,[e(t,{type:"info",onClick:a[5]||(a[5]=s=>d.value=!0)},{default:o(()=>[m("Add Artwork")]),_:1}),Ee,e(t,{onClick:a[6]||(a[6]=s=>f.value="simple")},{default:o(()=>[m("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(z,null,{default:o(()=>[f.value=="settings"?(p(),w("section",Be,[e(t,{type:"danger",plain:"",onClick:g},{default:o(()=>[m("Forget Display")]),_:1}),e(t,{onClick:a[7]||(a[7]=s=>f.value="detail")},{default:o(()=>[m("Close"),e(O,{class:"el-icon--right"},{default:o(()=>[e(M)]),_:1})]),_:1})])):I("",!0)]),_:1}),e(ge,{plaque_id:i.plaque.id,show_add_token_dialog:d.value,"onUpdate:show_add_token_dialog":a[8]||(a[8]=s=>d.value=s)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Oe=L(De,[["__scopeId","data-v-71baf983"]]);const ze=n=>(J("data-v-684951ec"),n=n(),F(),n),Le={class:"add-button-container"},je={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Je=ze(()=>l("div",{style:{"font-size":"17px"}},"Add plaque",-1)),Fe={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},Me=j({__name:"PlaqueList",setup(n){const i=q(!1),{width:f,screen_type:d}=Z(),u=q(!1),h=ie(),S=X(),P=W(),b=async()=>{i.value=!0,await de({name:"Test Plaque",user_id:S.get_account.id,token_meta_id_list:[],created_at:H.now(),updated_at:H.now()}).catch(C=>E({message:`Error creating test plaque- ${C}`,type:"error",showClose:!0,duration:12e3})),i.value=!1,u.value=!1},v=N(()=>JSON.parse(JSON.stringify(P.all_plaque_list)).sort((g,c)=>{const a=g.entity.name.toLowerCase(),t=c.entity.name.toLowerCase();return a<t?-1:a>t?1:0}));return(C,g)=>{const c=r("Plus"),a=r("el-icon"),t=r("el-button"),k=r("el-dialog");return p(),w(D,null,[(p(!0),w(D,null,Q(y(v),_=>(p(),V(Oe,{plaque:_,key:_.id},null,8,["plaque"]))),128)),l("div",Le,[l("div",je,[l("div",{class:"add-button",onClick:g[0]||(g[0]=_=>u.value=!0)},[e(a,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[e(c)]),_:1}),Je])])]),e(k,{modelValue:u.value,"onUpdate:modelValue":g[2]||(g[2]=_=>u.value=_),title:"Add plaque",width:y(d)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[l("div",Fe,[e(t,{onClick:g[1]||(g[1]=_=>{y(h).push("qr-scan"),u.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[m("Scan Plaque QR Code")]),_:1}),e(t,{icon:"plus",onClick:b,loading:i.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[m("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var at=L(Me,[["__scopeId","data-v-684951ec"]]);export{at as default};
