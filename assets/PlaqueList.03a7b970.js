import{_ as F,d as J,r as w,c as I,y as Z,b as r,o as _,h as C,i as t,w as a,k as o,t as N,j as c,f as y,z as ee,p as Q,l as K,v as z,u as te,e as T,A as W,B as se,C as ie,g as L,D as ue,G as re,F as O,H as G,I as X,J as de}from"./index.87996e27.js";import{u as D,c as _e}from"./plaque.093acf64.js";import{c as ce}from"./token-meta.2d60a689.js";import{u as M}from"./plaque.cf7ca4d9.js";import{u as le}from"./account.af1ee897.js";import{s as j}from"./util.3828be6b.js";import{T as Y}from"./types.6a5ef88e.js";import{u as ae}from"./breakpoints.a92a124c.js";import{u as oe}from"./token-meta.129fe567.js";import{_ as pe}from"./TokenSelectList.a13e7fb0.js";import{n as H}from"./firebaseConfig.d7a6b5a9.js";import{_ as me}from"./PlaqueTokenItem.61e7d979.js";import{u as fe}from"./gallery.ce385507.js";import"./thumbnail-image.ca1e6479.js";import"./gallery.82c2a091.js";const ve=i=>(Q("data-v-cc2989e6"),i=i(),K(),i),ye={class:"dialog-container"},ge={class:"dialog-footer"},ke=ve(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),qe=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(i,{emit:n}){const $=i,u=w([]),p=w(!1),{screen_type:k}=ae(),h=M(),P=oe(),x=le(),d=I({get(){return $.show_add_token_dialog},set(e){n("update:show_add_token_dialog",e)}});Z(d,e=>{e&&(u.value=JSON.parse(JSON.stringify(s.value.entity.token_meta_id_list)))});const s=I(()=>h.plaque_map[$.plaque_id]),b=I(()=>P.sorted_all_token_metas),S=async()=>{p.value=!0;try{for(let[e,l]of u.value.entries()){const g=P.all_token_metas[l];if(!g)throw"Failed to find store token for token: "+l;if(g.entity.platform!=Y.Opensea)continue;const v=JSON.parse(JSON.stringify(g));v.entity.user_id=x.get_account.id,v.entity.platform=Y.OpenseaArchive;const A=await ce(v.entity);u.value[e]=A.id}await D($.plaque_id,{token_meta_id_list:u.value}),h.plaque_map[$.plaque_id].entity.token_meta_id_list=u.value}catch(e){j(`Error updating plaque tokens - ${e}`)}p.value=!1,d.value=!1},q=()=>{u.value=[]};return(e,l)=>{const g=r("el-button"),v=r("el-dialog");return _(),C("div",ye,[t(v,{center:"",modelValue:y(d),"onUpdate:modelValue":l[1]||(l[1]=A=>ee(d)?d.value=A:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:y(k)=="xs",top:"2vh"},{footer:a(()=>[o("div",ge,[o("div",null,N(`Artwork in playlist: ${u.value.length}`),1),ke,t(g,{onClick:q},{default:a(()=>[c("Clear")]),_:1}),t(g,{type:"info",onClick:S,loading:p.value},{default:a(()=>[c("Save")]),_:1},8,["loading"])])]),default:a(()=>[t(pe,{selected_token_meta_id_list:u.value,"onUpdate:selected_token_meta_id_list":l[0]||(l[0]=A=>u.value=A),token_meta_list:y(b)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var we=F(qe,[["__scopeId","data-v-cc2989e6"]]);const he={class:"controller-buttons"},xe=J({__name:"PlaqueController",props:{plaque:null},setup(i){const n=i,$=M(),u=w(!1),p=w(!1),k=w(!1),h=w(!1),P=I({get:()=>n.plaque.entity.orientation||"landscape",set:d=>{D(n.plaque.id,{orientation:d}).then(()=>{$.plaque_map[n.plaque.id].entity.orientation=d,z({type:"success",message:"Plaque orientation updated"})}).catch(s=>{j(`Error updating plaque orientation - ${s}`)})}}),x=d=>{const s={type:d,time_sent:H.now()};D(n.plaque.id,{command:s}).then(()=>{$.plaque_map[n.plaque.id].entity.command=s,z({type:"success",message:"Command sent to plaque"})}).catch(b=>{j(`Error sending command to plaque - ${b}`)}).finally(()=>{u.value=!1,p.value=!1,k.value=!1,h.value=!1})};return(d,s)=>{const b=r("el-button"),S=r("el-radio"),q=r("el-radio-group");return _(),C("div",null,[o("div",he,[t(b,{circle:"",text:"",loading:u.value,icon:"DArrowLeft",onClick:s[0]||(s[0]=e=>{u.value=!0,x("playlist_previous")})},null,8,["loading"]),t(b,{circle:"",text:"",loading:p.value,icon:"VideoPlay",onClick:s[1]||(s[1]=e=>{p.value=!0,x("play")})},null,8,["loading"]),t(b,{circle:"",text:"",icon:"VideoPause",loading:k.value,onClick:s[2]||(s[2]=e=>{k.value=!0,x("pause")})},null,8,["loading"]),t(b,{circle:"",text:"",icon:"DArrowRight",loading:h.value,onClick:s[3]||(s[3]=e=>{h.value=!0,x("playlist_next")})},null,8,["loading"])]),t(q,{modelValue:y(P),"onUpdate:modelValue":s[4]||(s[4]=e=>ee(P)?P.value=e:null),style:{display:"flex","flex-direction":"column","align-items":"start","margin-top":"20px"}},{default:a(()=>[t(S,{label:"landscape",size:"small"},{default:a(()=>[c("Landscape")]),_:1}),t(S,{label:"portrait",size:"small"},{default:a(()=>[c("Portrait")]),_:1}),t(S,{label:"landscape_reversed",size:"small"},{default:a(()=>[c("Landscape Reversed")]),_:1}),t(S,{label:"portrait_reversed",size:"small"},{default:a(()=>[c("Portrait Reversed")]),_:1})]),_:1},8,["modelValue"])])}}});var Ce=F(xe,[["__scopeId","data-v-100e65c8"]]);const V=i=>(Q("data-v-6dc38957"),i=i(),K(),i),$e={style:{display:"flex","align-items":"center",padding:"1em"}},be={key:0},Ae=V(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),Pe={class:"card-simple"},Se=V(()=>o("hr",null,null,-1)),Ve=V(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Ie=V(()=>o("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ne={style:{padding:"0.3em 1em"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},ze={key:0,class:"card-detail"},Le={style:{padding:"0 1em"}},De={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ee=V(()=>o("hr",null,null,-1)),Ue=V(()=>o("div",{style:{padding:"1em"}},"No artwork added",-1)),Be=V(()=>o("hr",null,null,-1)),Oe={style:{display:"flex",padding:"1em"}},Re=V(()=>o("div",{style:{"flex-grow":"1"}},null,-1)),je={key:0,style:{padding:"1em"}},Fe={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},Je={key:0},Me=V(()=>o("div",null,"Associated User ID:",-1)),Ge={key:1},He={style:{display:"flex","justify-content":"end"}},Qe=J({__name:"PlaqueCard",props:{plaque:null},setup(i){const n=i,$=M();te();const u=w("simple"),p=w(!1),k=w(!1),h=w(!1),P=async()=>{h.value=!0,await D(n.plaque.id,{name:n.plaque.entity.name}).catch(q=>{j(`Error updating plaque tokens - ${q}`)}),k.value=!1,h.value=!1},x=oe(),d=I(()=>s.value.length==0?null:s.value[0]),s=I(()=>{const q=x.archive_token_meta_map;return n.plaque.entity.token_meta_id_list.map(l=>q[l])}),b=()=>{X.confirm(`Are you sure you want to clear tokens for plaque '${n.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{D(n.plaque.id,{token_meta_id_list:[]}).then(()=>{$.plaque_map[n.plaque.id].entity.token_meta_id_list=[],z({type:"success",message:"Tokens cleared"})}).catch(q=>{z({message:`Error clearing tokens from plaque - ${q}`,type:"error",showClose:!0,duration:12e3})})})},S=()=>{X.confirm(`Are you sure you want to forget the plaque named '${n.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{D(n.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{$.plaque_map[n.plaque.id].entity.user_id="",$.plaque_map[n.plaque.id].entity.token_meta_id_list=[],z({type:"success",message:"Plaque forgotten"})}).catch(q=>{z({message:`Error forgetting plaque - ${q}`,type:"error",showClose:!0,duration:12e3})})})};return(q,e)=>{const l=r("el-button"),g=r("el-tag"),v=r("el-col"),A=r("el-row"),E=r("ArrowRight"),U=r("el-icon"),B=r("el-collapse-transition"),R=r("Close"),f=r("el-card");return _(),T(f,null,{default:a(()=>[o("div",$e,[k.value?W((_(),C("input",{key:1,"onUpdate:modelValue":e[0]||(e[0]=m=>n.plaque.entity.name=m),class:"edit-name-input"},null,512)),[[se,n.plaque.entity.name]]):(_(),C("h1",be,N(n.plaque.entity.name),1)),k.value?L("",!0):(_(),T(l,{key:2,icon:y(ie),onClick:e[1]||(e[1]=m=>k.value=!0),class:"editIcon",circle:""},null,8,["icon"])),k.value?(_(),T(l,{key:3,icon:y(ue),loading:h.value,onClick:P,class:"editIcon",circle:"",type:h.value?"":"success",text:""},null,8,["icon","loading","type"])):L("",!0),Ae,t(g,{class:"ml-2",type:"success"},{default:a(()=>[c("online")]),_:1})]),t(B,null,{default:a(()=>[W(o("section",Pe,[Se,t(A,{style:{padding:"1em"}},{default:a(()=>[t(v,{span:12},{default:a(()=>{var m;return[Ve,o("span",null,N(((m=y(d))==null?void 0:m.entity.name)||"N/A"),1)]}),_:1}),t(v,{span:12},{default:a(()=>{var m;return[Ie,c(" "+N(((m=y(d))==null?void 0:m.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),o("div",Ne,N(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),o("div",Te,[t(l,{type:"info",onClick:e[2]||(e[2]=m=>p.value=!0)},{default:a(()=>[c("Add Artwork")]),_:1}),t(l,{onClick:e[3]||(e[3]=m=>u.value="detail")},{default:a(()=>[c(" Details"),t(U,{class:"el-icon--right"},{default:a(()=>[t(E)]),_:1})]),_:1})])],512),[[re,u.value=="simple"]])]),_:1}),t(B,null,{default:a(()=>[u.value=="detail"?(_(),C("section",ze,[o("p",Le,N(`Total artworks: ${i.plaque.entity.token_meta_id_list.length}`),1),o("div",De,[t(l,{onClick:e[4]||(e[4]=m=>u.value="settings")},{default:a(()=>[c("Settings")]),_:1}),t(l,{onClick:b},{default:a(()=>[c("Clear Artwork")]),_:1})]),Ee,y(s).length==0?(_(),C(O,{key:0},[Ue,Be],64)):L("",!0),(_(!0),C(O,null,G(y(s),m=>(_(),T(me,{token_meta:m},null,8,["token_meta"]))),256)),o("div",Oe,[t(l,{type:"info",onClick:e[5]||(e[5]=m=>p.value=!0)},{default:a(()=>[c("Add Artwork")]),_:1}),Re,t(l,{onClick:e[6]||(e[6]=m=>u.value="simple")},{default:a(()=>[c("Close"),t(U,{class:"el-icon--right"},{default:a(()=>[t(R)]),_:1})]),_:1})])])):L("",!0)]),_:1}),t(B,null,{default:a(()=>[u.value=="settings"?(_(),C("section",je,[o("div",Fe,[i.plaque.entity.user_id?(_(),C("div",Je,[Me,o("div",null,N(i.plaque.entity.user_id),1)])):(_(),C("div",Ge,"No associated user")),i.plaque.entity.user_id?(_(),T(l,{key:2,type:"danger",plain:"",onClick:S},{default:a(()=>[c("Forget Display")]),_:1})):L("",!0)]),t(Ce,{plaque:n.plaque},null,8,["plaque"]),o("div",He,[t(l,{onClick:e[7]||(e[7]=m=>u.value="detail")},{default:a(()=>[c("Close"),t(U,{class:"el-icon--right"},{default:a(()=>[t(R)]),_:1})]),_:1})])])):L("",!0)]),_:1}),t(we,{plaque_id:n.plaque.id,show_add_token_dialog:p.value,"onUpdate:show_add_token_dialog":e[8]||(e[8]=m=>p.value=m)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Ke=F(Qe,[["__scopeId","data-v-6dc38957"]]);const ne=i=>(Q("data-v-0ea15fab"),i=i(),K(),i),We={class:"subheader",style:{display:"flex","align-items":"center"}},Xe=ne(()=>o("div",{style:{"padding-bottom":"40px"}},null,-1)),Ye={class:"add-button-container"},Ze={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},et=ne(()=>o("div",{style:{"font-size":"17px"}},"Add plaque",-1)),tt={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},lt=J({__name:"PlaqueList",setup(i){const n=w(!1),{width:$,screen_type:u}=ae(),p=w(!1),k=te(),h=le(),P=fe(),x=w(""),d=w(localStorage.getItem("filter_by_gallery")||"");Z(d,e=>{localStorage.setItem("filter_by_gallery",e)});const s=M(),b=async()=>{n.value=!0,await _e({name:"Test Plaque",user_id:h.get_account.id,token_meta_id_list:[],created_at:H.now(),updated_at:H.now()}).catch(e=>z({message:`Error creating test plaque- ${e}`,type:"error",showClose:!0,duration:12e3})),n.value=!1,p.value=!1},S=I(()=>JSON.parse(JSON.stringify(s.all_plaque_list)).sort((l,g)=>{const v=l.entity.name.toLowerCase(),A=g.entity.name.toLowerCase();return v<A?-1:v>A?1:0})),q=I(()=>{let e=[...S.value];return e=e.filter(l=>l.entity.name||l.entity.user_id||l.entity.token_meta_id_list.length>0),d.value&&(e=e.filter(l=>{var g;return(g=P.gallery_list.find(v=>v.id==d.value))==null?void 0:g.entity.plaque_id_list.includes(l.id)})),x?e.filter(l=>l.entity.name.toLowerCase().includes(x.value.toLowerCase())):e});return(e,l)=>{const g=r("el-input"),v=r("el-option"),A=r("el-select"),E=r("el-button"),U=r("Plus"),B=r("el-icon"),R=r("el-dialog");return _(),C(O,null,[o("div",We,[t(g,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=f=>x.value=f),"prefix-icon":y(de),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),t(A,{modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=f=>d.value=f),placeholder:"Filter by gallery",style:{"margin-left":"10px",width:"260px"}},{default:a(()=>[t(v,{label:"All plaques",value:""}),(_(!0),C(O,null,G(y(P).gallery_list,f=>(_(),T(v,{key:f.id,label:`Filter by gallery - ${f.entity.name}`,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(E,{icon:"Camera",type:"info",onClick:l[2]||(l[2]=f=>y(k).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:a(()=>[c("Scan")]),_:1})]),Xe,(_(!0),C(O,null,G(y(q),f=>(_(),T(Ke,{plaque:f,key:f.id},null,8,["plaque"]))),128)),o("div",Ye,[o("div",Ze,[o("div",{class:"add-button",onClick:l[3]||(l[3]=f=>p.value=!0)},[t(B,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:a(()=>[t(U)]),_:1}),et])])]),t(R,{modelValue:p.value,"onUpdate:modelValue":l[5]||(l[5]=f=>p.value=f),title:"Add plaque",width:y(u)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:a(()=>[o("div",tt,[t(E,{onClick:l[4]||(l[4]=f=>{y(k).push("qr-scan"),p.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:a(()=>[c("Scan Plaque QR Code")]),_:1}),t(E,{icon:"plus",onClick:b,loading:n.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:a(()=>[c("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var gt=F(lt,[["__scopeId","data-v-0ea15fab"]]);export{gt as default};
