import{d as j,c as S,b as p,o as c,e as q,k as t,i as e,f as v,t as P,F as B,_ as F,r as C,v as ae,w as o,j as g,x as U,y as W,h as I,z as M,g as V,A as ne,B as R,C as G,D as le,G as se,H as ie,I as H,q as O,u as re}from"./index.824ac28a.js";import{u as z,c as ue}from"./plaque.8894ab7b.js";import{u as X,c as de}from"./token-meta.8a5be8d1.js";import{u as Y}from"./plaque.dafcc6a0.js";import{u as Z}from"./account.d272c1e7.js";import{c as _e,T as Q}from"./types.01590581.js";import{u as ce,_ as pe}from"./PlaqueTokenItem.f31d9339.js";import{s as ee}from"./util.2fec33bc.js";import{u as te}from"./breakpoints.5692341f.js";import{h as K}from"./firebaseConfig.bef60b65.js";import"./gallery.20e01a76.js";const me=t("hr",{class:"hr"},null,-1),fe={class:"card-flex-container"},ve={style:{display:"flex","align-items":"center",margin:"5px 25px 5px 0px"}},ye={style:{flex:"3 1 0%"}},ge={class:"bold"},ke={class:"bold"},he={style:{"margin-right":"35px",opacity:"0.5"}},we=j({__name:"AddTokenItem",props:{in_list:{type:Boolean},token_meta:null},emits:["update_token_list"],setup(s,{emit:d}){const _=s,r=ce(_.token_meta),m=S(()=>_e(_.token_meta.entity.platform));return(k,T)=>{const N=p("el-image"),b=p("el-button");return c(),q(B,null,[me,t("div",fe,[t("div",ve,[e(N,{src:v(r),style:{width:"50px",height:"50px"},fit:"contain"},null,8,["src"])]),t("div",ye,[t("p",ge,P(_.token_meta.entity.name),1),t("p",ke,P(_.token_meta.entity.artist),1)]),t("div",he,P(v(m)),1),e(b,{icon:s.in_list?"close":"plus",type:s.in_list?"danger":"success",plain:"",circle:"",onClick:T[0]||(T[0]=A=>d("update_token_list",_.token_meta.id))},null,8,["icon","type"])])],64)}}});const oe=s=>(R("data-v-2ca93fe7"),s=s(),G(),s),qe={class:"dialog-container"},xe={key:0},$e=oe(()=>t("hr",{class:"hr"},null,-1)),Ce={class:"dialog-footer"},be=oe(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Ae=j({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(s,{emit:d}){const _=s,r=C([]),m=C(!1),k=C(""),{screen_type:T}=te(),N=Y(),b=X(),A=Z(),x=S({get(){return _.show_add_token_dialog},set(i){d("update:show_add_token_dialog",i)}});ae(x,i=>{i&&(r.value=JSON.parse(JSON.stringify(a.value.entity.token_meta_id_list)))});const f=S(()=>b.sorted_all_token_metas),y=S(()=>{const i=[];if(f!=null&&f.value)for(let l of f==null?void 0:f.value)N.meta_in_playlist(_.plaque_id,l.id)?i.unshift(l):i.push(l);return k.value.trim()!==""?i.filter(l=>{var h,w;return((h=l.entity.artist)==null?void 0:h.toLowerCase().includes(k.value.toLowerCase()))||((w=l.entity.name)==null?void 0:w.toLowerCase().includes(k.value.toLowerCase()))}):i}),a=S(()=>N.plaque_map[_.plaque_id]),u=S(()=>{const i={};return r.value.forEach(l=>{i[l]=!0}),i}),E=i=>{r.value.some(l=>l===i)?r.value=r.value.filter(l=>l!=i):r.value.push(i)},$=async()=>{m.value=!0;try{for(let[i,l]of r.value.entries()){const h=b.all_token_metas[l];if(!h)throw"Failed to find store token for token: "+l;if(h.entity.platform!=Q.Opensea)continue;const w=JSON.parse(JSON.stringify(h));w.entity.user_id=A.get_account.id,w.entity.platform=Q.OpenseaArchive;const D=await de(w.entity);r.value[i]=D.id}await z(_.plaque_id,{token_meta_id_list:r.value})}catch(i){ee(`Error updating plaque tokens - ${i}`)}m.value=!1,x.value=!1},J=()=>{r.value=[]};return(i,l)=>{const h=p("el-card"),w=p("el-button"),D=p("el-dialog");return c(),q("div",qe,[e(D,{center:"",modelValue:v(x),"onUpdate:modelValue":l[1]||(l[1]=n=>ne(x)?x.value=n:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:v(T)=="xs",top:"2vh"},{footer:o(()=>[t("div",Ce,[t("div",null,P(`Artwork in playlist: ${r.value.length}`),1),be,e(w,{onClick:J},{default:o(()=>[g("Clear")]),_:1}),e(w,{type:"info",onClick:$,loading:m.value},{default:o(()=>[g("Save")]),_:1},8,["loading"])])]),default:o(()=>[U(t("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=n=>k.value=n),class:"search-bar",placeholder:"Search by artwork title or artist name"},null,512),[[W,k.value]]),e(h,{class:"box-card",shadow:"never"},{default:o(()=>[v(y).length==0?(c(),q("div",xe,"No artwork found")):I("",!0),(c(!0),q(B,null,M(v(y),n=>(c(),V(we,{token_meta:n,in_list:Boolean(v(u)[n.id]),onUpdate_token_list:E},null,8,["token_meta","in_list"]))),256)),$e]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});var Se=F(Ae,[["__scopeId","data-v-2ca93fe7"]]);const L=s=>(R("data-v-71baf983"),s=s(),G(),s),Pe={style:{display:"flex","align-items":"center",padding:"1em"}},Te={key:0},Ne=L(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Le={class:"card-simple"},Ie=L(()=>t("hr",null,null,-1)),Ve=L(()=>t("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Be=L(()=>t("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),Ee={style:{padding:"0.3em 1em"}},De={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Oe={key:0,class:"card-detail"},ze={style:{padding:"0 1em"}},je={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Je=L(()=>t("hr",null,null,-1)),Ue=L(()=>t("div",{style:{padding:"1em"}},"No artwork added",-1)),Fe=L(()=>t("hr",null,null,-1)),Me={style:{display:"flex",padding:"1em"}},Re=L(()=>t("div",{style:{"flex-grow":"1"}},null,-1)),Ge={key:0,style:{padding:"1em",display:"flex","justify-content":"space-between"}},He=j({__name:"PlaqueCard",props:{plaque:null},setup(s){const d=s,_=C("simple"),r=C(!1),m=C(!1),k=C(!1),T=async()=>{k.value=!0,await z(d.plaque.id,{name:d.plaque.entity.name}).catch(y=>{ee(`Error updating plaque tokens - ${y}`)}),m.value=!1,k.value=!1},N=X(),b=S(()=>A.value.length==0?null:A.value[0]),A=S(()=>{const y=N.archive_token_meta_map;return d.plaque.entity.token_meta_id_list.map(u=>y[u])});C("0"),C(!0);const x=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${d.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{z(d.plaque.id,{token_meta_id_list:[]}).then(()=>{O({type:"success",message:"Tokens cleared"})}).catch(y=>{O({message:`Error clearing tokens from plaque - ${y}`,type:"error",showClose:!0,duration:12e3})})})},f=()=>{H.confirm(`Are you sure you want to forget the plaque named '${d.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{z(d.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{O({type:"success",message:"Plaque forgotten"})}).catch(y=>{O({message:`Error forgetting plaque - ${y}`,type:"error",showClose:!0,duration:12e3})})})};return(y,a)=>{const u=p("el-button"),E=p("el-tag"),$=p("el-col"),J=p("el-row"),i=p("ArrowRight"),l=p("el-icon"),h=p("el-collapse-transition"),w=p("Close"),D=p("el-card");return c(),V(D,null,{default:o(()=>[t("div",Pe,[m.value?U((c(),q("input",{key:1,"onUpdate:modelValue":a[0]||(a[0]=n=>d.plaque.entity.name=n),class:"edit-name-input"},null,512)),[[W,d.plaque.entity.name]]):(c(),q("h1",Te,P(d.plaque.entity.name),1)),m.value?I("",!0):(c(),V(u,{key:2,icon:v(le),onClick:a[1]||(a[1]=n=>m.value=!0),class:"editIcon",circle:""},null,8,["icon"])),m.value?(c(),V(u,{key:3,icon:v(se),loading:k.value,onClick:T,class:"editIcon",circle:"",type:k.value?"":"success",text:""},null,8,["icon","loading","type"])):I("",!0),Ne,e(E,{class:"ml-2",type:"success"},{default:o(()=>[g("online")]),_:1})]),e(h,null,{default:o(()=>[U(t("section",Le,[Ie,e(J,{style:{padding:"1em"}},{default:o(()=>[e($,{span:12},{default:o(()=>{var n;return[Ve,t("span",null,P(((n=v(b))==null?void 0:n.entity.name)||"N/A"),1)]}),_:1}),e($,{span:12},{default:o(()=>{var n;return[Be,g(" "+P(((n=v(b))==null?void 0:n.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),t("div",Ee,P(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),t("div",De,[e(u,{type:"info",onClick:a[2]||(a[2]=n=>r.value=!0)},{default:o(()=>[g("Add Artwork")]),_:1}),e(u,{onClick:a[3]||(a[3]=n=>_.value="detail")},{default:o(()=>[g(" Details"),e(l,{class:"el-icon--right"},{default:o(()=>[e(i)]),_:1})]),_:1})])],512),[[ie,_.value=="simple"]])]),_:1}),e(h,null,{default:o(()=>[_.value=="detail"?(c(),q("section",Oe,[t("p",ze,P(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),t("div",je,[e(u,{onClick:a[4]||(a[4]=n=>_.value="settings")},{default:o(()=>[g("Settings")]),_:1}),e(u,{onClick:x},{default:o(()=>[g("Clear Artwork")]),_:1})]),Je,v(A).length==0?(c(),q(B,{key:0},[Ue,Fe],64)):I("",!0),(c(!0),q(B,null,M(v(A),n=>(c(),V(pe,{token_meta:n},null,8,["token_meta"]))),256)),t("div",Me,[e(u,{type:"info",onClick:a[5]||(a[5]=n=>r.value=!0)},{default:o(()=>[g("Add Artwork")]),_:1}),Re,e(u,{onClick:a[6]||(a[6]=n=>_.value="simple")},{default:o(()=>[g("Close"),e(l,{class:"el-icon--right"},{default:o(()=>[e(w)]),_:1})]),_:1})])])):I("",!0)]),_:1}),e(h,null,{default:o(()=>[_.value=="settings"?(c(),q("section",Ge,[e(u,{type:"danger",plain:"",onClick:f},{default:o(()=>[g("Forget Display")]),_:1}),e(u,{onClick:a[7]||(a[7]=n=>_.value="detail")},{default:o(()=>[g("Close"),e(l,{class:"el-icon--right"},{default:o(()=>[e(w)]),_:1})]),_:1})])):I("",!0)]),_:1}),e(Se,{plaque_id:d.plaque.id,show_add_token_dialog:r.value,"onUpdate:show_add_token_dialog":a[8]||(a[8]=n=>r.value=n)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Qe=F(He,[["__scopeId","data-v-71baf983"]]);const Ke=s=>(R("data-v-684951ec"),s=s(),G(),s),We={class:"add-button-container"},Xe={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},Ye=Ke(()=>t("div",{style:{"font-size":"17px"}},"Add plaque",-1)),Ze={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},et=j({__name:"PlaqueList",setup(s){const d=C(!1),{width:_,screen_type:r}=te(),m=C(!1),k=re(),T=Z(),N=Y(),b=async()=>{d.value=!0,await ue({name:"Test Plaque",user_id:T.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(x=>O({message:`Error creating test plaque- ${x}`,type:"error",showClose:!0,duration:12e3})),d.value=!1,m.value=!1},A=S(()=>JSON.parse(JSON.stringify(N.all_plaque_list)).sort((f,y)=>{const a=f.entity.name.toLowerCase(),u=y.entity.name.toLowerCase();return a<u?-1:a>u?1:0}));return(x,f)=>{const y=p("Plus"),a=p("el-icon"),u=p("el-button"),E=p("el-dialog");return c(),q(B,null,[(c(!0),q(B,null,M(v(A),$=>(c(),V(Qe,{plaque:$,key:$.id},null,8,["plaque"]))),128)),t("div",We,[t("div",Xe,[t("div",{class:"add-button",onClick:f[0]||(f[0]=$=>m.value=!0)},[e(a,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[e(y)]),_:1}),Ye])])]),e(E,{modelValue:m.value,"onUpdate:modelValue":f[2]||(f[2]=$=>m.value=$),title:"Add plaque",width:v(r)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[t("div",Ze,[e(u,{onClick:f[1]||(f[1]=$=>{v(k).push("qr-scan"),m.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[g("Scan Plaque QR Code")]),_:1}),e(u,{icon:"plus",onClick:b,loading:d.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[g("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var ct=F(et,[["__scopeId","data-v-684951ec"]]);export{ct as default};
