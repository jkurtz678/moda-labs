import{_ as j,d as J,r as A,c as N,v as oe,b as _,o as r,e as g,i as t,w as o,k as a,t as P,j as c,f as m,x as ne,y as U,z as F,u as W,g as V,A as G,B as se,C as ie,h as T,D as de,G as ue,F as z,H as X,I as H,q as E,J as re}from"./index.93e5d3c6.js";import{u as L,c as _e}from"./plaque.093acf64.js";import{c as ce}from"./token-meta.2d60a689.js";import{u as M}from"./plaque.9db14d6d.js";import{u as Y}from"./account.9f58ff80.js";import{s as Z}from"./util.e66ac7b7.js";import{T as Q}from"./types.6a5ef88e.js";import{u as ee}from"./breakpoints.8520c3fd.js";import{u as te}from"./token-meta.1e8667d0.js";import{_ as pe}from"./TokenSelectList.6a0d7103.js";import{_ as me}from"./PlaqueTokenItem.e076ac8e.js";import{n as K}from"./firebaseConfig.d7a6b5a9.js";import"./gallery.635bded1.js";import"./thumbnail-image.b7fb903a.js";const fe=s=>(U("data-v-cc2989e6"),s=s(),F(),s),ye={class:"dialog-container"},ve={class:"dialog-footer"},ge=fe(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),ke=J({__name:"AddTokenDialog",props:{show_add_token_dialog:{type:Boolean},plaque_id:null},emits:["update:show_add_token_dialog"],setup(s,{emit:i}){const w=s,d=A([]),p=A(!1),{screen_type:k}=ee(),x=M(),C=te(),I=Y(),q=N({get(){return w.show_add_token_dialog},set(e){i("update:show_add_token_dialog",e)}});oe(q,e=>{e&&(d.value=JSON.parse(JSON.stringify(b.value.entity.token_meta_id_list)))});const b=N(()=>x.plaque_map[w.plaque_id]),D=N(()=>C.sorted_all_token_metas),y=async()=>{p.value=!0;try{for(let[e,n]of d.value.entries()){const f=C.all_token_metas[n];if(!f)throw"Failed to find store token for token: "+n;if(f.entity.platform!=Q.Opensea)continue;const h=JSON.parse(JSON.stringify(f));h.entity.user_id=I.get_account.id,h.entity.platform=Q.OpenseaArchive;const $=await ce(h.entity);d.value[e]=$.id}await L(w.plaque_id,{token_meta_id_list:d.value}),x.plaque_map[w.plaque_id].entity.token_meta_id_list=d.value}catch(e){Z(`Error updating plaque tokens - ${e}`)}p.value=!1,q.value=!1},l=()=>{d.value=[]};return(e,n)=>{const f=_("el-button"),h=_("el-dialog");return r(),g("div",ye,[t(h,{center:"",modelValue:m(q),"onUpdate:modelValue":n[1]||(n[1]=$=>ne(q)?q.value=$:null),title:"Add artwork to plaque","close-on-click-modal":!1,fullscreen:m(k)=="xs",top:"2vh"},{footer:o(()=>[a("div",ve,[a("div",null,P(`Artwork in playlist: ${d.value.length}`),1),ge,t(f,{onClick:l},{default:o(()=>[c("Clear")]),_:1}),t(f,{type:"info",onClick:y,loading:p.value},{default:o(()=>[c("Save")]),_:1},8,["loading"])])]),default:o(()=>[t(pe,{selected_token_meta_id_list:d.value,"onUpdate:selected_token_meta_id_list":n[0]||(n[0]=$=>d.value=$),token_meta_list:m(D)},null,8,["selected_token_meta_id_list","token_meta_list"])]),_:1},8,["modelValue","fullscreen"])])}}});var qe=j(ke,[["__scopeId","data-v-cc2989e6"]]);const S=s=>(U("data-v-31a993d0"),s=s(),F(),s),he={style:{display:"flex","align-items":"center",padding:"1em"}},we={key:0},xe=S(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Ce={class:"card-simple"},$e=S(()=>a("hr",null,null,-1)),Ae=S(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"title",-1)),Se=S(()=>a("div",{style:{"font-size":"var(--el-font-size-extra-small)"}},"artist",-1)),be={style:{padding:"0.3em 1em"}},Pe={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-right":"1em",padding:"1em"}},Ne={key:0,class:"card-detail"},Te={style:{padding:"0 1em"}},Ve={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"0.5em 1em"}},Ie=S(()=>a("hr",null,null,-1)),De=S(()=>a("div",{style:{padding:"1em"}},"No artwork added",-1)),Ee=S(()=>a("hr",null,null,-1)),Le={style:{display:"flex",padding:"1em"}},ze=S(()=>a("div",{style:{"flex-grow":"1"}},null,-1)),Be={key:0,style:{padding:"1em"}},Oe={style:{padding:"1em 0em",display:"flex","justify-content":"space-between","align-items":"center"}},je={key:0},Je=S(()=>a("div",null,"Associated User ID:",-1)),Ue={key:1},Fe={style:{display:"flex","justify-content":"end"}},Me=J({__name:"PlaqueCard",props:{plaque:null},setup(s){const i=s,w=M();W();const d=A("simple"),p=A(!1),k=A(!1),x=A(!1),C=async()=>{x.value=!0,await L(i.plaque.id,{name:i.plaque.entity.name}).catch(l=>{Z(`Error updating plaque tokens - ${l}`)}),k.value=!1,x.value=!1},I=te(),q=N(()=>b.value.length==0?null:b.value[0]),b=N(()=>{const l=I.archive_token_meta_map;return i.plaque.entity.token_meta_id_list.map(n=>l[n])}),D=()=>{H.confirm(`Are you sure you want to clear tokens for plaque '${i.plaque.entity.name}'?`,"Clear tokens",{type:"warning"}).then(()=>{L(i.plaque.id,{token_meta_id_list:[]}).then(()=>{w.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Tokens cleared"})}).catch(l=>{E({message:`Error clearing tokens from plaque - ${l}`,type:"error",showClose:!0,duration:12e3})})})},y=()=>{H.confirm(`Are you sure you want to forget the plaque named '${i.plaque.entity.name}'?`,"Forget plaque",{type:"warning"}).then(()=>{L(i.plaque.id,{user_id:"",token_meta_id_list:[]}).then(()=>{w.plaque_map[i.plaque.id].entity.user_id="",w.plaque_map[i.plaque.id].entity.token_meta_id_list=[],E({type:"success",message:"Plaque forgotten"})}).catch(l=>{E({message:`Error forgetting plaque - ${l}`,type:"error",showClose:!0,duration:12e3})})})};return(l,e)=>{const n=_("el-button"),f=_("el-tag"),h=_("el-col"),$=_("el-row"),v=_("ArrowRight"),B=_("el-icon"),O=_("el-collapse-transition"),R=_("Close"),le=_("el-card");return r(),V(le,null,{default:o(()=>[a("div",he,[k.value?G((r(),g("input",{key:1,"onUpdate:modelValue":e[0]||(e[0]=u=>i.plaque.entity.name=u),class:"edit-name-input"},null,512)),[[se,i.plaque.entity.name]]):(r(),g("h1",we,P(i.plaque.entity.name),1)),k.value?T("",!0):(r(),V(n,{key:2,icon:m(ie),onClick:e[1]||(e[1]=u=>k.value=!0),class:"editIcon",circle:""},null,8,["icon"])),k.value?(r(),V(n,{key:3,icon:m(de),loading:x.value,onClick:C,class:"editIcon",circle:"",type:x.value?"":"success",text:""},null,8,["icon","loading","type"])):T("",!0),xe,t(f,{class:"ml-2",type:"success"},{default:o(()=>[c("online")]),_:1})]),t(O,null,{default:o(()=>[G(a("section",Ce,[$e,t($,{style:{padding:"1em"}},{default:o(()=>[t(h,{span:12},{default:o(()=>{var u;return[Ae,a("span",null,P(((u=m(q))==null?void 0:u.entity.name)||"N/A"),1)]}),_:1}),t(h,{span:12},{default:o(()=>{var u;return[Se,c(" "+P(((u=m(q))==null?void 0:u.entity.artist)||"N/A"),1)]}),_:1})]),_:1}),a("div",be,P(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),a("div",Pe,[t(n,{type:"info",onClick:e[2]||(e[2]=u=>p.value=!0)},{default:o(()=>[c("Add Artwork")]),_:1}),t(n,{onClick:e[3]||(e[3]=u=>d.value="detail")},{default:o(()=>[c(" Details"),t(B,{class:"el-icon--right"},{default:o(()=>[t(v)]),_:1})]),_:1})])],512),[[ue,d.value=="simple"]])]),_:1}),t(O,null,{default:o(()=>[d.value=="detail"?(r(),g("section",Ne,[a("p",Te,P(`Total artworks: ${s.plaque.entity.token_meta_id_list.length}`),1),a("div",Ve,[t(n,{onClick:e[4]||(e[4]=u=>d.value="settings")},{default:o(()=>[c("Settings")]),_:1}),t(n,{onClick:D},{default:o(()=>[c("Clear Artwork")]),_:1})]),Ie,m(b).length==0?(r(),g(z,{key:0},[De,Ee],64)):T("",!0),(r(!0),g(z,null,X(m(b),u=>(r(),V(me,{token_meta:u},null,8,["token_meta"]))),256)),a("div",Le,[t(n,{type:"info",onClick:e[5]||(e[5]=u=>p.value=!0)},{default:o(()=>[c("Add Artwork")]),_:1}),ze,t(n,{onClick:e[6]||(e[6]=u=>d.value="simple")},{default:o(()=>[c("Close"),t(B,{class:"el-icon--right"},{default:o(()=>[t(R)]),_:1})]),_:1})])])):T("",!0)]),_:1}),t(O,null,{default:o(()=>[d.value=="settings"?(r(),g("section",Be,[a("div",Oe,[s.plaque.entity.user_id?(r(),g("div",je,[Je,a("div",null,P(s.plaque.entity.user_id),1)])):(r(),g("div",Ue,"No associated user")),s.plaque.entity.user_id?(r(),V(n,{key:2,type:"danger",plain:"",onClick:y},{default:o(()=>[c("Forget Display")]),_:1})):T("",!0)]),a("div",Fe,[t(n,{onClick:e[7]||(e[7]=u=>d.value="detail")},{default:o(()=>[c("Close"),t(B,{class:"el-icon--right"},{default:o(()=>[t(R)]),_:1})]),_:1})])])):T("",!0)]),_:1}),t(qe,{plaque_id:i.plaque.id,show_add_token_dialog:p.value,"onUpdate:show_add_token_dialog":e[8]||(e[8]=u=>p.value=u)},null,8,["plaque_id","show_add_token_dialog"])]),_:1})}}});var Re=j(Me,[["__scopeId","data-v-31a993d0"]]);const ae=s=>(U("data-v-9fca0326"),s=s(),F(),s),Ge={class:"subheader",style:{display:"flex","align-items":"center"}},He=ae(()=>a("div",{style:{"padding-bottom":"40px"}},null,-1)),Qe={class:"add-button-container"},Ke={style:{display:"flex","align-items":"center","justify-content":"center",height:"100%"}},We=ae(()=>a("div",{style:{"font-size":"17px"}},"Add plaque",-1)),Xe={style:{display:"flex","justify-content":"space-between","flex-wrap":"wrap"}},Ye=J({__name:"PlaqueList",setup(s){const i=A(!1),{width:w,screen_type:d}=ee(),p=A(!1),k=W(),x=Y(),C=A(""),I=M(),q=async()=>{i.value=!0,await _e({name:"Test Plaque",user_id:x.get_account.id,token_meta_id_list:[],created_at:K.now(),updated_at:K.now()}).catch(y=>E({message:`Error creating test plaque- ${y}`,type:"error",showClose:!0,duration:12e3})),i.value=!1,p.value=!1},b=N(()=>JSON.parse(JSON.stringify(I.all_plaque_list)).sort((l,e)=>{const n=l.entity.name.toLowerCase(),f=e.entity.name.toLowerCase();return n<f?-1:n>f?1:0})),D=N(()=>{let y=[...b.value];return y=y.filter(l=>l.entity.name||l.entity.user_id||l.entity.token_meta_id_list.length>0),C?y.filter(l=>l.entity.name.toLowerCase().includes(C.value.toLowerCase())):y});return(y,l)=>{const e=_("el-input"),n=_("el-button"),f=_("Plus"),h=_("el-icon"),$=_("el-dialog");return r(),g(z,null,[a("div",Ge,[t(e,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=v=>C.value=v),"prefix-icon":m(re),placeholder:"Search plaques",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),t(n,{icon:"Camera",type:"info",onClick:l[1]||(l[1]=v=>m(k).push("qr-scan")),style:{"margin-left":"10px"},size:"small"},{default:o(()=>[c("Scan")]),_:1})]),He,(r(!0),g(z,null,X(m(D),v=>(r(),V(Re,{plaque:v,key:v.id},null,8,["plaque"]))),128)),a("div",Qe,[a("div",Ke,[a("div",{class:"add-button",onClick:l[2]||(l[2]=v=>p.value=!0)},[t(h,{style:{"font-size":"26px","margin-bottom":"6px"}},{default:o(()=>[t(f)]),_:1}),We])])]),t($,{modelValue:p.value,"onUpdate:modelValue":l[4]||(l[4]=v=>p.value=v),title:"Add plaque",width:m(d)=="xs"?"90%":"50%",style:{"max-width":"500px"}},{default:o(()=>[a("div",Xe,[t(n,{onClick:l[3]||(l[3]=v=>{m(k).push("qr-scan"),p.value=!1}),icon:"camera",color:"#000000",style:{margin:"10px 12px 10px 0px"}},{default:o(()=>[c("Scan Plaque QR Code")]),_:1}),t(n,{icon:"plus",onClick:q,loading:i.value,style:{margin:"10px 0px 10px 0px"},color:"#000000"},{default:o(()=>[c("Add test plaque ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","width"])],64)}}});var pt=j(Ye,[["__scopeId","data-v-9fca0326"]]);export{pt as default};
