import{_ as G,a as T,b as H,c as M}from"./search-icon.301e062d.js";import{d as N,u as S,a as L,r as q,c as U,b as _,o as u,e as k,f as l,g as w,h as x,F as $,i as s,w as g,j as E,t as F,k as P,_ as I,l as j,E as A,R as O}from"./index.461c042d.js";import{u as R}from"./account.aff1b444.js";import{u as z}from"./breakpoints.ceab6239.js";import{s as J,a as B,o as K}from"./firebaseConfig.bef60b65.js";import{s as i}from"./util.30eae98f.js";import{u as Q}from"./plaque.189476ca.js";import{u as W}from"./token-meta.f53c37f3.js";import{u as X}from"./plaque.8894ab7b.js";import{u as Y}from"./gallery.e4e4b95b.js";import"./types.01590581.js";const Z={style:{display:"flex","align-items":"center"}},ee=P("div",{style:{"flex-grow":"1"}},null,-1),te=P("div",{style:{"flex-grow":"1"}},null,-1),ae={key:0,style:{"margin-right":"10px"}},oe=N({__name:"Header",setup(D){const r=S(),m=L(),h=R(),c=q(!1),{width:C,screen_type:f}=z(),d=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&r.push({name:e.paneName})},v=U(()=>{const e=h.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),b=()=>{c.value=!0,J(B).then(()=>{}).catch(e=>{i(e)}).finally(()=>{c.value=!1})},o=e=>new URL({"../assets/base.css":G,"../assets/logo.png":T,"../assets/logo.svg":H,"../assets/search-icon.svg":M}[`../assets/${e}`],self.location).href;return(e,t)=>{const y=_("el-image"),p=_("el-button"),n=_("el-tab-pane"),a=_("el-tabs");return u(),k("div",Z,[l(f)!="xs"?(u(),w(y,{key:0,src:o("logo.png"),style:{width:"43px",height:"43px","margin-right":"2em"}},null,8,["src"])):x("",!0),l(r).currentRoute.value.name=="qr-scan"?(u(),k($,{key:1},[ee,s(p,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=V=>l(r).push("plaque-list"))},{default:g(()=>[E(" Cancel ")]),_:1})],64)):(u(),k($,{key:2},[s(a,{modelValue:l(m).name,"onUpdate:modelValue":t[1]||(t[1]=V=>l(m).name=V),onTabClick:d},{default:g(()=>[s(n,{label:"Plaques",name:"plaque-list"}),s(n,{label:"Artwork",name:"token-list"}),s(n,{label:"Galleries",name:"gallery-list"})]),_:1},8,["modelValue"]),te,l(f)!="xs"?(u(),k("div",ae,F(l(v)),1)):x("",!0),s(p,{onClick:b,style:{"margin-left":"1em"},loading:c.value},{default:g(()=>[E("Logout")]),_:1},8,["loading"])],64))])}}});const se=N({__name:"HomeView",setup(D){const r=R(),m=Q(),h=W(),c=Y(),C=S(),f=q(!1),d=q(),v=L();j(async()=>{d.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),K(B,async o=>{console.log("onAuthStateChanged",o),o?(d.value=A.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await b(o.uid),d.value.close()):(r.setAccount(null),d.value.close(),C.push({name:"login",query:{redir:window.location.href}}))})});async function b(o){await r.loadAccount(o),await c.loadGalleryList(o).catch(a=>i(`Error loading galleries - ${a}`));const e=m.loadPlaques(o).catch(a=>i(`Error loading plaques - ${a}`)),t=m.loadGalleryPlaques(c.gallery_list).catch(a=>i(`Error loading gallery plaques - ${a}`)),y=h.loadArchiveTokenMetas(o).catch(a=>i(`Error loading archive token metas - ${a}`)),p=h.loadGalleryTokenMetas(c.gallery_list).catch(a=>i(`Error loading token metas - ${a}`));await Promise.all([e,t,y,p]);const n=v.query.plaque_id;n&&typeof n=="string"&&!m.plaque_map[n]&&await X(n,{user_id:r.get_account.id,token_meta_id_list:[]}).catch(a=>{i(`Error adding plaque from query param = ${a}`)}),f.value=!0}return(o,e)=>{const t=_("el-header"),y=_("el-main"),p=_("el-container");return u(),w(p,{style:{height:"100%"}},{default:g(()=>[s(t,{class:"header"},{default:g(()=>[s(oe)]),_:1}),s(y,{style:{"background-color":"#DAD9D7"}},{default:g(()=>[f.value?(u(),w(l(O),{key:0})):x("",!0)]),_:1})]),_:1})}}});var fe=I(se,[["__scopeId","data-v-43f4e3de"]]);export{fe as default};
