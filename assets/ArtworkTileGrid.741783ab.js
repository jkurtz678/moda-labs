import{d as P,P as Q,Q as Y,r as B,o as x,h as C,F as L,I as G,M as N,f as m,S as J,j,t as $,T as X,U as Z,m as O,z as ee,_ as H,u as K,L as te,c as D,b as S,k as f,n as U,i as c,w as A,g as ne,K as oe,p as ae,l as le}from"./index.37f2166b.js";import{u as re}from"./thumbnail-image.b8fd0853.js";import{c as se,d as ie}from"./types.6a5ef88e.js";import{s as ue}from"./util.03d7fda0.js";import{u as ce}from"./token-meta.558841a7.js";import"./firebaseConfig.d7a6b5a9.js";import"./token-meta.2d60a689.js";import"./account.a4ac883d.js";const me={columnWidth:400,gap:0,keyMapper:(n,s,y,i)=>i,minColumns:1,maxColumns:void 0,rtl:!1,scrollContainer:null,ssrColumns:0};function de({columns:n,columnWidth:s,emit:y,gap:i,items:l,maxColumns:u,minColumns:k,nextTick:b,onBeforeUnmount:d,onMounted:w,rtl:r,scrollContainer:e,ssrColumns:a,vue:_,wall:h,watch:V}){function M(o,t,v,R){const z=p(v);return R+t+z<=o?M(o,t,v+1,R+t+z):v}function p(o){const t=Array.isArray(s.value)?s.value:[s.value];return t[o%t.length]}function g(){const o=M(h.value.getBoundingClientRect().width,i.value,0,-i.value),t=W(T(o));return t>0?t:1}function T(o){const t=u==null?void 0:u.value;return t&&o>t?t:o}function W(o){const t=k==null?void 0:k.value;return t&&o<t?t:o}function q(o){return[...new Array(o)].map(()=>[])}if(a.value>0){const o=q(a.value);l.value.forEach((t,v)=>o[v%a.value].push(v)),n.value=o}async function F(o){if(o>=l.value.length)return;await b();const t=[...h.value.children];r.value&&t.reverse();const v=t.reduce((R,z)=>z.getBoundingClientRect().height<R.getBoundingClientRect().height?z:R);n.value[+v.dataset.index].push(o),await F(o+1)}async function E(o=!1){if(n.value.length===g()&&!o){y(_===2?"redraw-skip":"redrawSkip");return}n.value=q(g());const t=e==null?void 0:e.value,v=t?t.scrollTop:window.scrollY;await F(0),t?t.scrollBy({top:v-t.scrollTop}):window.scrollTo({top:v}),y("redraw")}const I=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>E());return w(()=>{E(),I==null||I.observe(h.value)}),d(()=>I==null?void 0:I.unobserve(h.value)),V([l,r],()=>E(!0)),V([s,i,k,u],()=>E()),{getColumnWidthTarget:p}}const _e=["data-index"],pe=P({__name:"masonry-wall",props:Q({columnWidth:{},items:{},gap:{},rtl:{type:Boolean},ssrColumns:{},scrollContainer:{},minColumns:{},maxColumns:{},keyMapper:{type:Function}},me),emits:["redraw","redrawSkip"],setup(n,{emit:s}){const y=n,{columnWidth:i,items:l,gap:u,rtl:k,ssrColumns:b,scrollContainer:d,minColumns:w,maxColumns:r,keyMapper:e}=Y(y),a=B([]),_=B(),{getColumnWidthTarget:h}=de({columns:a,columnWidth:i,emit:s,gap:u,items:l,keyMapper:e,maxColumns:r,minColumns:w,nextTick:X,onBeforeUnmount:Z,onMounted:O,rtl:k,scrollContainer:d,ssrColumns:b,vue:3,wall:_,watch:ee});return(V,M)=>(x(),C("div",{ref_key:"wall",ref:_,class:"masonry-wall",style:N({display:"flex",gap:`${m(u)}px`})},[(x(!0),C(L,null,G(a.value,(p,g)=>(x(),C("div",{key:g,class:"masonry-column","data-index":g,style:N({display:"flex","flex-basis":`${m(h)(g)}px`,"flex-direction":"column","flex-grow":1,gap:`${m(u)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(x(!0),C(L,null,G(p,(T,W)=>(x(),C("div",{key:m(e)(m(l)[T],g,W,T),class:"masonry-item"},[J(V.$slots,"default",{item:m(l)[T],column:g,row:W,index:T},()=>[j($(m(l)[T]),1)])]))),128))],12,_e))),128))],4))}}),ve=(()=>{const n=pe;return n.install=s=>{s.component("MasonryWall",n)},n})();const fe=["src"],ye={class:"header"},we={class:"platform"},ke={style:{"font-size":"1.6em","font-weight":"bold"}},he={style:{"font-weight":"bold"}},ge={style:{"font-size":"0.9em","line-height":"1.3em"}},xe=P({__name:"ArtworkTile",props:{token_meta:null},setup(n){const s=n,y=K(),i=re(te(s,"token_meta")),l=B(!1),u=D(()=>se(s.token_meta.entity.platform)),k=async()=>{const d=await ie(s.token_meta);if(!d){ue("Error getting source file");return}window.open(d,"_blank")},b=()=>{const d=y.resolve({name:"preview-plaque",params:{token_meta_id:s.token_meta.id}});window.open(d.href)};return(d,w)=>{const r=S("el-button"),e=S("el-tooltip");return x(),C("div",{class:"custom-card",onClick:w[1]||(w[1]=a=>l.value=!l.value)},[f("img",{class:U(l.value?"absolute":""),src:m(i)},null,10,fe),f("div",{class:U(["transition absolute",l.value?"hide-blur":"show-blur"])},[f("div",ye,$(`${n.token_meta.entity.name} | ${n.token_meta.entity.artist}`),1),f("div",we,$(m(u)),1)],2),f("div",{class:U(["detail-container transition",l.value?"show-blur":"hide-blur absolute"])},[f("div",ke,$(n.token_meta.entity.name),1),f("div",he,$(n.token_meta.entity.artist),1),l.value?(x(),C(L,{key:0},[c(e,{class:"box-item",effect:"dark",content:"Download art",placement:"top"},{default:A(()=>[c(r,{icon:"Download",text:"",circle:"",onClick:k})]),_:1}),c(e,{class:"box-item",effect:"dark",content:"Preview plaque",placement:"top"},{default:A(()=>[c(r,{icon:"Tickets",text:"",circle:"",onClick:b})]),_:1}),c(e,{class:"box-item",effect:"dark",content:"Edit art data",placement:"top"},{default:A(()=>[c(r,{icon:"Edit",text:"",circle:"",onClick:w[0]||(w[0]=a=>m(y).push({name:"edit-artwork",params:{token_meta_id:s.token_meta.id}}))})]),_:1})],64)):ne("",!0),f("div",ge,$(n.token_meta.entity.description),1)],2)])}}});var Ce=H(xe,[["__scopeId","data-v-a9ad496a"]]);const be=n=>(ae("data-v-33742f3e"),n=n(),le(),n),Te={class:"subheader",style:{display:"flex","align-items":"center"}},Se=be(()=>f("div",{style:{"padding-bottom":"40px"}},null,-1)),Be=P({__name:"ArtworkTileGrid",setup(n){const s=K(),y=ce(),i=B(""),l=B(null),u=B(localStorage.getItem("token_list_sort_order")||"name"),k=B(1e3),b=D(()=>y.sorted_all_token_metas),d=D(()=>{let r=b.value.filter(e=>{var a,_;return((a=e.entity.artist)==null?void 0:a.toLowerCase().includes(i.value.toLowerCase()))||((_=e.entity.name)==null?void 0:_.toLowerCase().includes(i.value.toLowerCase()))});return u.value==="name"?r=r.sort((e,a)=>e.entity.name.localeCompare(a.entity.name)):u.value==="created_at"&&(r=r.sort((e,a)=>e.entity.created_at==null&&a.entity.created_at==null?0:e.entity.created_at==null?1:a.entity.created_at==null?-1:a.entity.created_at.seconds-e.entity.created_at.seconds)),r}),w=D(()=>{const r=d.value,e=0,a=e+k.value;return r.slice(e,a)});return O(()=>{if(!document.getElementById("masonry-container")){console.log("ArtworkTileGrid error, masonary_wall element not found");return}}),(r,e)=>{const a=S("el-input"),_=S("el-option"),h=S("el-select"),V=S("el-button"),M=S("RouterView");return x(),C(L,null,[f("div",Te,[c(a,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=p=>i.value=p),"prefix-icon":m(oe),placeholder:"Search artwork or artist",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),c(h,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=p=>u.value=p),placeholder:"Sort by",style:{"margin-left":"10px"}},{default:A(()=>[c(_,{label:"Sort by name",value:"name"}),c(_,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"]),c(V,{icon:"Plus",onClick:e[2]||(e[2]=p=>m(s).push({name:"new-artwork"})),color:"#000000",style:{"margin-left":"10px"},size:"small"},{default:A(()=>[j("Artwork")]),_:1})]),Se,f("div",{id:"masonry-container",ref_key:"masonryContainer",ref:l,style:{"overflow-y":"auto",height:"100%",padding:"10px",margin:"-10px"}},[c(m(ve),{id:"masonary-wall","scroll-container":l.value,items:m(w),"column-width":250,gap:14},{default:A(({item:p})=>[c(Ce,{token_meta:p},null,8,["token_meta"])]),_:1},8,["scroll-container","items"])],512),c(M)],64)}}});var Ie=H(Be,[["__scopeId","data-v-33742f3e"]]);export{Ie as default};
