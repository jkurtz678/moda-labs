import{_ as O,a as U,b as z,c as F}from"./search-icon.822e7617.js";import{_ as P,d as T,u as H,a as I,r as V,c as j,b as d,o as c,e as b,w as m,f as o,g as x,h as E,F as M,i as n,j as A,n as L,k as S,t as W,p as J,l as K,m as Q,E as N,R as X}from"./index.6336a010.js";import{u as R}from"./account.8e1308bd.js";import{u as Y}from"./breakpoints.4cb106e8.js";import{s as Z,a as B,o as ee}from"./firebaseConfig.d7a6b5a9.js";import{s}from"./util.0288e7af.js";import{u as ae}from"./plaque.cbc44d56.js";import{u as te}from"./token-meta.95bc866f.js";import{u as oe}from"./plaque.093acf64.js";import{u as se}from"./gallery.95d8bbbc.js";import"./types.6a5ef88e.js";import"./token-meta.ee0ff4d3.js";import"./gallery.82c2a091.js";const D=h=>(J("data-v-162afaf1"),h=h(),K(),h),ne=D(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),le=D(()=>S("div",{style:{"flex-grow":"1"}},null,-1)),re={key:0,style:{"margin-right":"10px",display:"flex","align-items":"center"}},ce=T({__name:"Header",setup(h){const l=H(),p=I(),i=R(),u=V(!1),{md_and_up:k}=Y(),w=(e,t)=>{e.paneName&&typeof e.paneName=="string"&&l.push({name:e.paneName})},g=j(()=>{const e=i.account;if(!e)return"";if(e.entity.ens_name)return e.entity.ens_name;if(e.entity.email)return e.entity.email;const t=e.entity.wallet_address;return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:""}),q=()=>{u.value=!0,Z(B).then(()=>{}).catch(e=>{s(e)}).finally(()=>{u.value=!1})},$=e=>new URL({"../assets/base.css":O,"../assets/logo.png":U,"../assets/logo.svg":z,"../assets/search-icon.svg":F}[`../assets/${e}`],self.location).href;return(e,t)=>{const f=d("el-image"),_=d("el-button"),r=d("el-tab-pane"),v=d("el-tabs"),y=d("el-header");return c(),b(y,{class:"header"},{default:m(()=>[o(k)?(c(),b(f,{key:0,src:$("logo.png"),style:{width:"40px",height:"40px","margin-right":"2em"}},null,8,["src"])):x("",!0),o(l).currentRoute.value.name=="qr-scan"?(c(),E(M,{key:1},[ne,n(_,{icon:"close",color:"#000000",onClick:t[0]||(t[0]=a=>o(l).push("plaque-list"))},{default:m(()=>[A(" Cancel ")]),_:1})],64)):(c(),E(M,{key:2},[n(v,{modelValue:o(p).name,"onUpdate:modelValue":t[1]||(t[1]=a=>o(p).name=a),onTabClick:w,class:L(o(k)?"":"small-tabs")},{default:m(()=>[n(r,{label:"Plaques",name:"plaque-list"}),n(r,{label:"Artwork",name:"artwork-tile-grid"}),n(r,{label:"Galleries",name:"gallery-list"}),n(r,{label:"Account",name:"account-settings"})]),_:1},8,["modelValue","class"]),le,o(k)?(c(),E("div",re,[S("div",null,W(o(g)),1),o(i).is_user_admin?(c(),b(_,{key:0,type:"info",round:"",size:"small",style:{"margin-left":"8px"}},{default:m(()=>[A("Admin")]),_:1})):x("",!0)])):x("",!0),n(_,{onClick:q,style:{"margin-left":"1em"},loading:u.value},{default:m(()=>[A("Logout")]),_:1},8,["loading"])],64))]),_:1})}}});var ie=P(ce,[["__scopeId","data-v-162afaf1"]]);const ue=T({__name:"HomeView",setup(h){const l=R(),p=ae(),i=te(),u=se(),k=H(),w=V(!1),g=V(),q=I();Q(async()=>{g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),ee(B,async e=>{console.log("onAuthStateChanged",e),e?(g.value=N.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"}),await $(e.uid),g.value.close()):(l.setAccount(null),g.value.close(),k.push({name:"login",query:{redir:window.location.href}}))})});async function $(e){await l.loadAccount(e),await u.loadGalleryList(e).catch(a=>s(`Error loading galleries - ${a}`));const t=p.loadPlaques(e).catch(a=>s(`Error loading plaques - ${a}`)),f=p.loadGalleryPlaques(u.gallery_list).catch(a=>s(`Error loading gallery plaques - ${a}`)),_=i.loadArchiveTokenMetas(e).catch(a=>s(`Error loading archive token metas - ${a}`));i.loadGalleryTokenMetas(u.gallery_list).catch(a=>s(`Error loading token metas - ${a}`));const r=[t,f,_,f],v=l.get_account.entity.wallet_address;if(v){const a=i.loadOpenseaMintedTokenMetas(v).catch(C=>s(`Error loading opensea minted tokens - ${C}`)),G=i.loadOpenseaWalletTokenMetas(v).catch(C=>s(`Error loading opensea wallet tokens - ${C}`));r.push(a),r.push(G)}await Promise.all(r);const y=q.query.plaque_id;y&&typeof y=="string"&&!p.plaque_map[y]&&await oe(y,{user_id:l.get_account.id,token_meta_id_list:[]}).catch(a=>{s(`Error adding plaque from query param = ${a}`)}),w.value=!0}return(e,t)=>{const f=d("el-main"),_=d("el-container");return c(),b(_,{style:{height:"100%","flex-direction":"column"}},{default:m(()=>[n(ie),n(f,{style:{"background-color":"#DAD9D7"},class:L(o(q).fullPath.includes("artwork-tile-grid")?"remove-padding":"")},{default:m(()=>[w.value?(c(),b(o(X),{key:0})):x("",!0)]),_:1},8,["class"])]),_:1})}}});var xe=P(ue,[["__scopeId","data-v-c24dabbc"]]);export{xe as default};
