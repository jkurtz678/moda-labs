import{d as q,P as Y,Q as J,r as V,o as v,h as w,F as D,I as N,M as j,f as d,S as X,j as P,t as B,T as Z,U as ee,m as Q,z as te,_ as H,u as K,L as ne,c as I,b as A,k as y,n as U,i as c,w as g,e as oe,g as O,K as ae,p as le,l as se}from"./index.bf1a3698.js";import{u as re}from"./thumbnail-image.edadac29.js";import{c as ie,d as ce}from"./types.6a5ef88e.js";import{s as ue}from"./util.22180a7f.js";import{u as me}from"./token-meta.9239bf71.js";import"./firebaseConfig.d7a6b5a9.js";import"./token-meta.2d60a689.js";import"./account.38d4a516.js";const de={columnWidth:400,gap:0,keyMapper:(n,s,f,u)=>u,minColumns:1,maxColumns:void 0,rtl:!1,scrollContainer:null,ssrColumns:0};function _e({columns:n,columnWidth:s,emit:f,gap:u,items:r,maxColumns:m,minColumns:h,nextTick:C,onBeforeUnmount:b,onMounted:T,rtl:l,scrollContainer:e,ssrColumns:o,vue:i,wall:k,watch:$}){function M(a,t,p,R){const z=_(p);return R+t+z<=a?M(a,t,p+1,R+t+z):p}function _(a){const t=Array.isArray(s.value)?s.value:[s.value];return t[a%t.length]}function x(){const a=M(k.value.getBoundingClientRect().width,u.value,0,-u.value),t=L(S(a));return t>0?t:1}function S(a){const t=m==null?void 0:m.value;return t&&a>t?t:a}function L(a){const t=h==null?void 0:h.value;return t&&a<t?t:a}function F(a){return[...new Array(a)].map(()=>[])}if(o.value>0){const a=F(o.value);r.value.forEach((t,p)=>a[p%o.value].push(p)),n.value=a}async function G(a){if(a>=r.value.length)return;await C();const t=[...k.value.children];l.value&&t.reverse();const p=t.reduce((R,z)=>z.getBoundingClientRect().height<R.getBoundingClientRect().height?z:R);n.value[+p.dataset.index].push(a),await G(a+1)}async function W(a=!1){if(n.value.length===x()&&!a){f(i===2?"redraw-skip":"redrawSkip");return}n.value=F(x());const t=e==null?void 0:e.value,p=t?t.scrollTop:window.scrollY;await G(0),t?t.scrollBy({top:p-t.scrollTop}):window.scrollTo({top:p}),f("redraw")}const E=typeof ResizeObserver>"u"?void 0:new ResizeObserver(()=>W());return T(()=>{W(),E==null||E.observe(k.value)}),b(()=>E==null?void 0:E.unobserve(k.value)),$([r,l],()=>W(!0)),$([s,u,h,m],()=>W()),{getColumnWidthTarget:_}}const pe=["data-index"],ve=q({__name:"masonry-wall",props:Y({columnWidth:{},items:{},gap:{},rtl:{type:Boolean},ssrColumns:{},scrollContainer:{},minColumns:{},maxColumns:{},keyMapper:{type:Function}},de),emits:["redraw","redrawSkip"],setup(n,{emit:s}){const f=n,{columnWidth:u,items:r,gap:m,rtl:h,ssrColumns:C,scrollContainer:b,minColumns:T,maxColumns:l,keyMapper:e}=J(f),o=V([]),i=V(),{getColumnWidthTarget:k}=_e({columns:o,columnWidth:u,emit:s,gap:m,items:r,keyMapper:e,maxColumns:l,minColumns:T,nextTick:Z,onBeforeUnmount:ee,onMounted:Q,rtl:h,scrollContainer:b,ssrColumns:C,vue:3,wall:i,watch:te});return($,M)=>(v(),w("div",{ref_key:"wall",ref:i,class:"masonry-wall",style:j({display:"flex",gap:`${d(m)}px`})},[(v(!0),w(D,null,N(o.value,(_,x)=>(v(),w("div",{key:x,class:"masonry-column","data-index":x,style:j({display:"flex","flex-basis":`${d(k)(x)}px`,"flex-direction":"column","flex-grow":1,gap:`${d(m)}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(v(!0),w(D,null,N(_,(S,L)=>(v(),w("div",{key:d(e)(d(r)[S],x,L,S),class:"masonry-item"},[X($.$slots,"default",{item:d(r)[S],column:x,row:L,index:S},()=>[P(B(d(r)[S]),1)])]))),128))],12,pe))),128))],4))}}),fe=(()=>{const n=ve;return n.install=s=>{s.component("MasonryWall",n)},n})();const ke=["src"],ye={class:"header"},we={class:"platform"},he={style:{"font-size":"1.6em","font-weight":"bold"}},xe={key:0},ge={key:1,style:{"font-weight":"bold"}},Ce={style:{"font-size":"0.9em","line-height":"1.3em"}},be=q({__name:"ArtworkTile",props:{token_meta:null},setup(n){const s=n,f=K(),u=re(ne(s,"token_meta")),r=V(!1),m=I(()=>ie(s.token_meta.entity.platform)),h=async()=>{const l=await ce(s.token_meta);if(!l){ue("Error getting source file");return}window.open(l,"_blank")},C=()=>{const l=f.resolve({name:"preview-plaque",params:{token_meta_id:s.token_meta.id}});window.open(l.href)},b=()=>{window.open(s.token_meta.entity.public_link,"_blank")},T=()=>{window.open(s.token_meta.entity.artist_social_link,"_blank")};return(l,e)=>{const o=A("el-button"),i=A("el-tooltip");return v(),w("div",{class:"custom-card",onClick:e[1]||(e[1]=k=>r.value=!r.value)},[y("img",{class:U(r.value?"absolute":""),src:d(u)},null,10,ke),y("div",{class:U(["transition absolute",r.value?"hide-blur":"show-blur"])},[y("div",ye,B(`${n.token_meta.entity.name} | ${n.token_meta.entity.artist}`),1),y("div",we,B(d(m)),1)],2),y("div",{class:U(["detail-container transition",r.value?"show-blur":"hide-blur absolute"])},[y("div",he,B(n.token_meta.entity.name),1),n.token_meta.entity.artist_social_link?(v(),w("div",xe,[c(o,{link:"",style:{"font-weight":"bold",display:"block"},onClick:T},{default:g(()=>[P(B(n.token_meta.entity.artist),1)]),_:1})])):(v(),w("div",ge,B(n.token_meta.entity.artist),1)),r.value?(v(),w(D,{key:2},[c(i,{class:"box-item",effect:"dark",content:"Download art",placement:"top"},{default:g(()=>[c(o,{icon:"Download",text:"",circle:"",onClick:h})]),_:1}),c(i,{class:"box-item",effect:"dark",content:"Preview plaque",placement:"top"},{default:g(()=>[c(o,{icon:"Tickets",text:"",circle:"",onClick:C})]),_:1}),n.token_meta.entity.public_link?(v(),oe(i,{key:0,class:"box-item",effect:"dark",content:"QR Code Link",placement:"top"},{default:g(()=>[c(o,{icon:"Link",text:"",circle:"",onClick:b})]),_:1})):O("",!0),c(i,{class:"box-item",effect:"dark",content:"Edit art data",placement:"top"},{default:g(()=>[c(o,{icon:"Edit",text:"",circle:"",onClick:e[0]||(e[0]=k=>d(f).push({name:"edit-artwork",params:{token_meta_id:s.token_meta.id}}))})]),_:1})],64)):O("",!0),y("div",Ce,B(n.token_meta.entity.description),1)],2)])}}});var Te=H(be,[["__scopeId","data-v-15a79c96"]]);const Se=n=>(le("data-v-33742f3e"),n=n(),se(),n),Be={class:"subheader",style:{display:"flex","align-items":"center"}},Ae=Se(()=>y("div",{style:{"padding-bottom":"40px"}},null,-1)),Ve=q({__name:"ArtworkTileGrid",setup(n){const s=K(),f=me(),u=V(""),r=V(null),m=V(localStorage.getItem("token_list_sort_order")||"name"),h=V(1e3),C=I(()=>f.sorted_all_token_metas),b=I(()=>{let l=C.value.filter(e=>{var o,i;return((o=e.entity.artist)==null?void 0:o.toLowerCase().includes(u.value.toLowerCase()))||((i=e.entity.name)==null?void 0:i.toLowerCase().includes(u.value.toLowerCase()))});return m.value==="name"?l=l.sort((e,o)=>e.entity.name.localeCompare(o.entity.name)):m.value==="created_at"&&(l=l.sort((e,o)=>e.entity.created_at==null&&o.entity.created_at==null?0:e.entity.created_at==null?1:o.entity.created_at==null?-1:o.entity.created_at.seconds-e.entity.created_at.seconds)),l}),T=I(()=>{const l=b.value,e=0,o=e+h.value;return l.slice(e,o)});return Q(()=>{if(!document.getElementById("masonry-container")){console.log("ArtworkTileGrid error, masonary_wall element not found");return}}),(l,e)=>{const o=A("el-input"),i=A("el-option"),k=A("el-select"),$=A("el-button"),M=A("RouterView");return v(),w(D,null,[y("div",Be,[c(o,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=_=>u.value=_),"prefix-icon":d(ae),placeholder:"Search artwork or artist",style:{"max-width":"350px"},clearable:""},null,8,["modelValue","prefix-icon"]),c(k,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=_=>m.value=_),placeholder:"Sort by",style:{"margin-left":"10px"}},{default:g(()=>[c(i,{label:"Sort by name",value:"name"}),c(i,{label:"Sort by newest",value:"created_at"})]),_:1},8,["modelValue"]),c($,{icon:"Plus",onClick:e[2]||(e[2]=_=>d(s).push({name:"new-artwork"})),color:"#000000",style:{"margin-left":"10px"},size:"small"},{default:g(()=>[P("Artwork")]),_:1})]),Ae,y("div",{id:"masonry-container",ref_key:"masonryContainer",ref:r,style:{"overflow-y":"auto",height:"100%",padding:"10px",margin:"-10px"}},[c(d(fe),{id:"masonary-wall","scroll-container":r.value,items:d(T),"column-width":250,gap:14},{default:g(({item:_})=>[c(Te,{token_meta:_},null,8,["token_meta"])]),_:1},8,["scroll-container","items"])],512),c(M)],64)}}});var De=H(Ve,[["__scopeId","data-v-33742f3e"]]);export{De as default};
